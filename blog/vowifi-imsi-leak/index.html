<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Working Group Two RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Working Group Two Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-114662288-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">VoWifi leaking IMSI | Working Group Two</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://www.wgtwo.com//img/preview.png"><meta data-react-helmet="true" name="twitter:image" content="https://www.wgtwo.com//img/preview.png"><meta data-react-helmet="true" property="og:url" content="https://www.wgtwo.com//blog/vowifi-imsi-leak/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" name="og:description" content="No more boxes, no more end of life, no large upfront investments. With the wgtwo cloud native mobile core we offer continuous innovation, continuous development, scalability and flexibility. And to make it really simple for operators ‚Äì delivered as a managed SaaS telecommunication network."><meta data-react-helmet="true" property="og:title" content="VoWifi leaking IMSI | Working Group Two"><meta data-react-helmet="true" name="description" content="4G offers more services than the earlier generation such as 3G and 2G. One of"><meta data-react-helmet="true" property="og:description" content="4G offers more services than the earlier generation such as 3G and 2G. One of"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2020-03-30T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://www.linkedin.com/in/rskjetlein/"><meta data-react-helmet="true" property="article:tag" content="telco,4G,ePDG,VoWifi,networking,security"><link data-react-helmet="true" rel="icon" href="/img/favicons/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.wgtwo.com//blog/vowifi-imsi-leak/"><link data-react-helmet="true" rel="alternate" href="https://www.wgtwo.com//blog/vowifi-imsi-leak/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.wgtwo.com//blog/vowifi-imsi-leak/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.9a17149c.css">
<link rel="preload" href="/assets/js/runtime~main.52e90bb9.js" as="script">
<link rel="preload" href="/assets/js/main.a924383d.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="wgtwo Logo" class="themedImage_W2Cr themedImage--light_TfLj" height="32px" width="191px"><img src="/img/logo_white.svg" alt="wgtwo Logo" class="themedImage_W2Cr themedImage--dark_oUvU" height="32px" width="191px"></div></a><a class="navbar__item navbar__link" target="_self" href="/technology/">Technology</a><a class="navbar__item navbar__link" target="_self" href="/product-ecosystem/">Product Ecosystem</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/team/">Join the Team üéâ</a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link sign-up" href="/request-demo/">Talk to an Expert</a><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/manual-on-me-matt-long/">Manual on Me: Matt Long</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/please-dont-leave-a-message-after-the-beep/">Don&#x27;t leave a message after the beep</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/the-specs-behind-the-specs-part-1/">The specs behind the specs part 1</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/log4j-security-vulnerability/">Zero-day vulnerabilities - Log4j</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/ckh-iod-wg2-public-cloud/">CKH IOD selects Working Group Two for public cloud core network</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/mitsui-knowledge-industry-mki-private-networks-business/">Mitsui Knowledge Industry (MKI) to develop private networks business</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/kafka-timers/">Kafka timers</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/mqtt-event-bridge/">Changing the color of your bulbs: The fancy way</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/forbidden-lore-hacking-dns-routing-for-k8s/">Forbidden lore: hacking DNS routing for k8s</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/were-all-grownups-here/">We&#x27;re all grownups here</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/hackdays-october-2020/">October Virtual Hackdays</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/what-is-a-short-message/">What the heck is a short message?</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/a-new-hope-for-products-in-telecom/">A new hope for products in telecom</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/building-software-for-a-telecom-core-network/">Building software for a telecom core network</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/choosing-erlang-formatter/">Choosing an Erlang formatter</a></li><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/blog/vowifi-imsi-leak/">VoWifi leaking IMSI</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/extending-k8s/">Extending Kubernetes for our needs</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/metrics-unlimited-thanos/">Towards observability nirvana: infinite metric retention with Thanos</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/replacing-jenkins-with-concourse/">We killed the butler: Replacing Jenkins with Concourse</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/hacking-dark-themes-with-css-blend-modes/">Hacking dark themes with CSS blend modes</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">VoWifi leaking IMSI</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2020-03-30T00:00:00.000Z" itemprop="datePublished">March 30, 2020</time> ¬∑ <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm imageOnlyAuthorRow_trpF"><div class="imageOnlyAuthorCol_S2np"><div class="avatar margin-bottom--sm"><a href="https://www.linkedin.com/in/rskjetlein/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_o0gy" src="https://media-exp1.licdn.com/dms/image/C4E03AQH5jRmUxivpng/profile-displayphoto-shrink_400_400/0/1516289349229?e=1648684800&amp;v=beta&amp;t=5lPorNrvLAyqoZ1Tx0wCjosDkNqaTGXykCKeQXO4seY"></a></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>4G offers more services than the earlier generation such as 3G and 2G. One of
the services has really have gained traction later years is VoLTE (Voice
over LTE) and VoWifi (Voice over Wifi) that we will go more in dept regarding security.</p><p>VoWifi is beneficial in terms being able to use any Wifi connection offering public
internet access thus extending and improving the coverage and connectivity.
Think of it as building our own cellular network, but
using commodity wifi components instead and avoiding the strict regulation and
licensing of spectrum.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-is-imsi">What is IMSI<a class="hash-link" href="#what-is-imsi" title="Direct link to heading">‚Äã</a></h2><p><em>The international mobile subscriber identity (IMSI) is a number that uniquely
identifies every user of a cellular network. It is stored as a 64-bit field
and is sent by the mobile device to the network. It is also used for acquiring
other details of the mobile in the home location register (HLR) or as locally
copied in the visitor location register. To prevent eavesdroppers from
identifying and tracking the subscriber on the radio interface, the IMSI is sent
as rarely as possible and a randomly-generated TMSI is sent instead.</em></p><ul><li><a href="https://en.wikipedia.org/wiki/International_mobile_subscriber_identity" target="_blank" rel="noopener noreferrer">IMSI article</a></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="security-implications">Security implications<a class="hash-link" href="#security-implications" title="Direct link to heading">‚Äã</a></h3><p>The IMSI is a secret identifier stored on the sim and can be exploited in many
ways once known. It is bound to the sim, so changing UE will not help.</p><p>Examples:</p><ul><li>Locating user (UE)</li><li>Intercepting calls</li><li>Intercepting SMS (stealing two factor pin eg.)</li><li>..and more</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-vowifi-works">How VoWifi works<a class="hash-link" href="#how-vowifi-works" title="Direct link to heading">‚Äã</a></h2><p>When your phone is connected to datanetwork and with volte and vowifi enabled
the device (UE) establish sip session directly to packetgateway via 4g, and via
public internet to epdg (evolved packet data gateway) which is in essence a
ipsec (ikev2) termination using SIM-AKA to authenticate UE. The ipsec comes into
play since epdg is exposed publicly.</p><p>We won&#x27;t go further in depth for volte and vowifi since there are already
excellent articles about the matter:</p><ul><li><a href="https://en.wikipedia.org/wiki/Voice_over_WLAN" target="_blank" rel="noopener noreferrer">Voice over WLAN</a></li><li><a href="https://en.wikipedia.org/wiki/Voice_over_LTE" target="_blank" rel="noopener noreferrer">Voice over LTE</a></li></ul><p><img alt="VoWifi topology" src="/assets/images/vowifi-ed900be33ec8a7b58034fb2e5a8a8dca.jpg" width="672" height="280"></p><p>To enable VoWifi on your device, please refer to your device manufacturer website:</p><ul><li><a href="https://support.google.com/phoneapp/answer/2811843?hl=en" target="_blank" rel="noopener noreferrer">Android</a></li><li><a href="https://support.apple.com/en-in/HT203032" target="_blank" rel="noopener noreferrer">Apple</a></li></ul><p>Also check on your operator website if VoWifi is supported in your region. Please note that VoWifi is usually blocked when roaming.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="epdg-exposed-on-the-public-internet">EPDG exposed on the public internet<a class="hash-link" href="#epdg-exposed-on-the-public-internet" title="Direct link to heading">‚Äã</a></h2><p>The Evolved Packet Data Gateway needs to be publicly available on the internet
since UE needs to access it from an arbitrary no-trusted connection. The ipsec
will secure and encrypt both the data and maintain the integrity of the
connection throughout the session.</p><p>The UE finds the epdg termination point by looking dns records partly following
a convention decided by 3gpp and typically looks like this in DNS:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">epdg.epc.mnc999.mcc999.pub.3gppnetwork.org. 3488 IN A 1.2.3.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">epdg.epc.mnc999.mcc999.pub.3gppnetwork.org. 3488 IN A 5.6.7.8</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>From the DNS records we recognize the network operator (MNC) and the
country code (MCC).</p><p>The DNS records are registered under a delegated domain owned by GSMA and
usually are redelegated to operator under their own umbrella, like the example
mnc999.mcc999.pub.3gppnetwork.org.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-problem">The problem<a class="hash-link" href="#the-problem" title="Direct link to heading">‚Äã</a></h2><p>When UE establish session to epdg it uses a vpn, a ipsec relationship using
IKEv2 for authentication, encryption and integrity.</p><p>So far the implementation works as intended and provides good security through
encryption and security.</p><p>The problem is not the VoWifi per see, by rather how ipsec establish the
session. When UE connects to the epdg, it acts as a initiator and the epdg is
inherently passive since it cannot know where from (ip) the UE will come from.</p><p><img alt="sim-aka flow" src="/assets/images/sim-aka-a216f5fd634021b704462a689f2df6ae.png" width="464" height="450"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="eap-aka-exposes-identity">EAP-AKA exposes identity<a class="hash-link" href="#eap-aka-exposes-identity" title="Direct link to heading">‚Äã</a></h3><p>Vowifi as mentioned earlier utilises an encryption protocol based on the widely
adopted Extensible Authentication Protocol. EAP itself is just a protocol and
does not define the contents of the data or how exact the data exchanges look
like. EAP-AKA unfortunately exposes the unencrypted user identity during
the authentication session and in this case the user identity is equal to the
imsi.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="solution">Solution<a class="hash-link" href="#solution" title="Direct link to heading">‚Äã</a></h4><p>This is the hardest problem to solve since it needs a security layer or settings
that comes before ipsec starts to connect.</p><p>The proposed solutions</p><ul><li>Force the use of conservative peer for eap-aka/sim
and use pseudonym identity (tmsi) to avoid exposing imsi.</li><li>Enable EAP-TTLS in addition to EAP-AKA/SIM</li><li>Only connect trusted/encrypted AP&#x27;s</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="fake-ipsec-termination-exposes-identity">Fake Ipsec termination exposes identity<a class="hash-link" href="#fake-ipsec-termination-exposes-identity" title="Direct link to heading">‚Äã</a></h3><p>By impersonating a epdg by redirecting all dns requests for any
<code>pub.3gppnetwork.org.</code> to our own fake ipsec termination providing just enough
to catch the imsi.</p><p>A raspberry pie can easily be setup to constantly scan for open wifi networks,
then impersonating the ssid in hope of lure ue&#x27;s to connect. Any UE set to use
VoWiFi connecting to the fake access point will give away their imsi.</p><p>A wifi ssid scan example of what we can automate. In this case the Isfjell-Guest
would have been picked to catch imsi since its open and unencrypted:</p><p><img alt="wifi-ssid" src="/assets/images/wlan-ssid-8239810014d356e06b17543cf45951d2.png" width="474" height="109"></p><p>Snippet from the ipsec termination, UE (iPhone 8) exposes imsi several times:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[ENC] parsed IKE_AUTH request 2 [ EAP/RES/AKA ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] &#x27;09999994511******@wlan.mnc999.mcc999.3gppnetwork.org&#x27; is not a reauth identity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] &#x27;09999994511******@wlan.mnc999.mcc999.3gppnetwork.org&#x27; is not a pseudonym</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] received identity &#x27;09999994511******@wlan.mnc999.mcc999.3gppnetwork.org&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] no EAP key found for 09999994511******@wlan.mnc999.mcc999.3gppnetwork.org to authenticate with AKA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[LIB] tried 0 SIM providers, but none had a quintuplet for &#x27;09999994511******@wlan.mnc999.mcc999.3gppnetwork.org&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] failed to map pseudonym/reauth identity &#x27;09999994511******@wlan.mnc999.mcc999.3gppnetwork.org&#x27;, fallback to permanent identity request</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[ENC] generating IKE_AUTH response 2 [ EAP/REQ/AKA ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[NET] sending packet: from 192.168.17.1[500] to 192.168.17.24[500] (92 bytes)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[NET] received packet: from 192.168.17.24[500] to 192.168.17.1[500] (140 bytes)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[ENC] parsed IKE_AUTH request 3 [ EAP/RES/AKA ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[IKE] received identity &#x27;09999994511******@wlan.mnc999.mcc999.3gppnetwork.org&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[IKE] no EAP key found for 09999994511******@wlan.mnc999.mcc999.3gppnetwork.org to authenticate with AKA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[LIB] tried 0 SIM providers, but none had a quintuplet for &#x27;09999994511******@wlan.mnc999.mcc999.3gppnetwork.org&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[IKE] EAP method EAP_AKA failed for peer 09999994511******@nai.epc.mnc999.mcc999.3gppnetwork.org</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[ENC] generating IKE_AUTH response 3 [ EAP/FAIL ]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="solution-1">Solution<a class="hash-link" href="#solution-1" title="Direct link to heading">‚Äã</a></h4><p>Ipsec clients (UE) are able to verify the identity of the epdg by requesting
and validating a machine certificate proving it is the actual service belonging
to the requested dns address. This means when the client connects, the server
has to provide a valid certificate containing the dns names and signed by a
trusted CA.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="raspberry-pi-4">Raspberry PI 4<a class="hash-link" href="#raspberry-pi-4" title="Direct link to heading">‚Äã</a></h2><p>The specific physical setup used for testing. Older PI&#x27;s should work just fine and also
other platforms that can run dnsmasq, tshark and strongswan for ipsec with
support for eap-aka/sim.</p><p><img alt="rpi4 and battery" src="/assets/images/rpi4-batt-331b622857ead4ba1f8081397efe866f.jpg" width="640" height="480"></p><p><em>white box is the rpi4 in a original casing and gray box is a battery bank</em></p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/telco/">telco</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/4-g/">4G</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/e-pdg/">ePDG</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/vo-wifi/">VoWifi</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/networking/">networking</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/security/">security</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/working-group-two/wgtwo.com/edit/main/blog/../blog/2020-03-30-catch-imsi-from-vowifi-session.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/choosing-erlang-formatter/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Choosing an Erlang formatter</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/extending-k8s/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Extending Kubernetes for our needs</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-imsi" class="table-of-contents__link toc-highlight">What is IMSI</a><ul><li><a href="#security-implications" class="table-of-contents__link toc-highlight">Security implications</a></li></ul></li><li><a href="#how-vowifi-works" class="table-of-contents__link toc-highlight">How VoWifi works</a></li><li><a href="#epdg-exposed-on-the-public-internet" class="table-of-contents__link toc-highlight">EPDG exposed on the public internet</a></li><li><a href="#the-problem" class="table-of-contents__link toc-highlight">The problem</a><ul><li><a href="#eap-aka-exposes-identity" class="table-of-contents__link toc-highlight">EAP-AKA exposes identity</a></li><li><a href="#fake-ipsec-termination-exposes-identity" class="table-of-contents__link toc-highlight">Fake Ipsec termination exposes identity</a></li></ul></li><li><a href="#raspberry-pi-4" class="table-of-contents__link toc-highlight">Raspberry PI 4</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items"><li class="footer__item"><a href="/"><img alt="wgtwo Logo" src="/img/logo_white.svg" width="281px" height="32px" class="footer-logo"></a></li></ul></div><div class="col footer__col"><div class="footer__title">Product</div><ul class="footer__items"><li class="footer__item"><a href="https://docs.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://console.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Console Login<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://support.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Customer Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/about/introduction/">About</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/case-studies/mvnx/">Case Studies</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/team/">Team</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/careers/">Careers</a></li><li class="footer__item"><a href="https://gk.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>gk.wgtwo.com ÂêàÂêå‰ºöÁ§æ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Security</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/security/">Security Overview</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/technology/security-whitepaper/">Security Whitepaper</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/privacy/">Privacy Policy</a></li></ul></div><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/about/media-and-analysts/">Media &amp; Analysts</a></li><li class="footer__item"><a href="https://twitter.com/workinggrouptwo" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/working-group-two" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="http://linkedin.com/company/wgtwo" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/contact/">Contact Us</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">¬© 2022 Working Group Two AS</div></div></div></footer></div>
<script src="/assets/js/runtime~main.52e90bb9.js"></script>
<script src="/assets/js/main.a924383d.js"></script>
</body>
</html>