<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Unboxing the AWS Snowcone and using it as a local UPF | Working Group Two</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.wgtwo.com/img/wgtwo-logo.png"><meta data-rh="true" name="twitter:image" content="https://www.wgtwo.com/img/wgtwo-logo.png"><meta data-rh="true" property="og:url" content="https://www.wgtwo.com/blog/exploring-aws-snowcone/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="og:description" content="We help mobile operators innovate at scale, reduce cost and dive into new revenue streams - by building a mobile core network from the ground up and delivering it as-a-service."><meta data-rh="true" name="og:image" content="/img/wgtwo-logo.png"><meta data-rh="true" name="keywords" content="mvne, private network, epc, 5G core, mvno, IMS core, mobile core, evolved packet core epc, mvno core, core as a service&#x27;"><meta data-rh="true" property="og:title" content="Unboxing the AWS Snowcone and using it as a local UPF | Working Group Two"><meta data-rh="true" name="description" content="The AWS Snowcone is a small form factor server that was originally meant for data transport to AWS data centers."><meta data-rh="true" property="og:description" content="The AWS Snowcone is a small form factor server that was originally meant for data transport to AWS data centers."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-11-21T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://www.linkedin.com/in/hihrig/"><meta data-rh="true" property="article:tag" content="5G,aws,snowcone"><link data-rh="true" rel="icon" href="/img/favicons/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.wgtwo.com/blog/exploring-aws-snowcone/"><link data-rh="true" rel="alternate" href="https://www.wgtwo.com/blog/exploring-aws-snowcone/" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.wgtwo.com/jp/blog/exploring-aws-snowcone/" hreflang="jp"><link data-rh="true" rel="alternate" href="https://www.wgtwo.com/blog/exploring-aws-snowcone/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Working Group Two RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Working Group Two Atom Feed">



<!-- Google Tag Manager -->
    <script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-N4969FH",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>
    <!-- End Google Tag Manager --><link rel="stylesheet" href="/assets/css/styles.559cfa0f.css">
<link rel="preload" href="/assets/js/runtime~main.04a2862b.js" as="script">
<link rel="preload" href="/assets/js/main.f273e218.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#000000;color:#b8b8b8" role="banner"><div class="content_knG7 announcementBarContent_xLdY"><a class="announcementBarLinkContainer" target="_blank" href="https://blogs.cisco.com/news/cisco-announces-intent-to-acquire-working-group-two"><img src="/img/cisco.png"><b>Working Group Two is now part of Cisco</b><span class="separator"> | </span><span>Learn more →</span></a></div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="wgtwo Logo" class="themedImage_ToTc themedImage--light_HNdA" height="32px" width="191px"><img src="/img/logo_white.svg" alt="wgtwo Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="32px" width="191px"></div></a><a class="navbar__item navbar__link" target="_self" href="/technology/">Technology</a><a class="navbar__item navbar__link" target="_self" href="/product-ecosystem/">Product Ecosystem</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Showcase</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/showcase/mobi/">Mobi (MVNO/MNO)</a></li><li><a class="dropdown__link" href="/showcase/ckh-iod/">CKH IOD (MVNE)</a></li><li><a class="dropdown__link" href="/showcase/telenorconnexion/">Telenor Connexion (IoT)</a></li><li><a class="dropdown__link" href="/showcase/mki/">MKI (Private Networks)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link sign-up" href="/contact/">Talk to us</a><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link localeDropdown"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/blog/exploring-aws-snowcone/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/jp/blog/exploring-aws-snowcone/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="jp">日本語</a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 blogBackground_WB8r"><div class="container margin-vert--lg"><div class="row"><main class="col col8_DrcQ colOffset1_fYNX singleBlogPageView_LeVK" itemscope="" itemtype="http://schema.org/Blog"><div style="position:fixed;height:4px;background-color:#edf6fa;z-index:999;width:100%;top:0;left:0"><div style="background-color:#93ddff;transition:all 0.5s ease-out;width:0%;height:100%"></div></div><article class="articleContainer_Rf03" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header class="articleCardHeader_doJu"><h1 class="title_xvU1" itemprop="headline">Unboxing the AWS Snowcone and using it as a local UPF</h1><div class="container_iJTo margin-vert--md"><div class="dateContainer_S5xq"><time datetime="2022-11-21T00:00:00.000Z" itemprop="datePublished">November 21, 2022</time> · <!-- -->8 min read</div><div class="iconsContainer_WcqX"><button class="button_jnFd"><svg height="500" width="500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500" class="icon_K6Vf"><path d="M50 0C22.3 0 0 22.3 0 50v400c0 27.7 22.3 50 50 50h400c27.7 0 50-22.3 50-50V50c0-27.7-22.3-50-50-50H50zm89.906 105.781c19.182 0 34.719 15.537 34.719 34.719 0 19.182-15.537 34.75-34.719 34.75-19.182 0-34.719-15.568-34.719-34.75 0-19.182 15.537-34.719 34.72-34.719zm181.875 90.438c3.922.014 7.925.199 13.313.531 26.184 1.615 55.36 22.08 56.219 70.031.706 39.493.5 102.081.5 125.125H332.28c0-23.574.25-72.274.25-106.719 0-15.672-7.035-36.75-32.094-36.75-27.597 0-34.312 25.645-34.312 36.75 0 33.074-.281 85.752-.281 106.72h-59.188c0-35.345.375-156.654.375-190.907 30.568 0 45.191-.063 56.375-.063 0 11.218-.094 18.722-.094 26.907 9.337-18.852 34.832-30.655 45.75-31.219 4.98-.257 8.797-.42 12.72-.406zm-211.594 5.531h59.344v190.063h-59.344V201.75z" style="fill-opacity:1;fill-rule:nonzero"></path></svg></button><button class="button_jnFd"><svg xmlns="http://www.w3.org/2000/svg" height="56.693" width="56.693" viewBox="0 0 56.693 56.693" xml:space="preserve" class="icon_K6Vf"><rect width="100%" height="100%" fill="none"></rect><g class="currentLayer"><title>Layer 1</title><path d="M56.237 11.546a22.859 22.859 0 0 1-6.598 1.809 11.509 11.509 0 0 0 5.051-6.357 22.997 22.997 0 0 1-7.295 2.79 11.473 11.473 0 0 0-8.385-3.629c-6.344 0-11.488 5.144-11.488 11.489 0 .899.101 1.775.298 2.618-9.548-.48-18.014-5.053-23.68-12.004a11.43 11.43 0 0 0-1.555 5.777c0 3.985 2.027 7.502 5.11 9.562a11.456 11.456 0 0 1-5.204-1.438v.145c0 5.565 3.96 10.208 9.215 11.265a11.55 11.55 0 0 1-5.189.195c1.463 4.564 5.705 7.887 10.732 7.979A23.047 23.047 0 0 1 2.98 46.665c-.926 0-1.841-.055-2.74-.161a32.51 32.51 0 0 0 17.61 5.161c21.132 0 32.687-17.505 32.687-32.686 0-.498-.01-.995-.032-1.488a23.268 23.268 0 0 0 5.731-5.945z" class="selected"></path></g></svg></button><button class="button_jnFd"><svg xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 256 256" class="icon_K6Vf"><rect width="100%" height="100%" fill="none"></rect><g class="currentLayer"><title>Layer 1</title><path fill="none" d="M0 0h256v256H0z"></path><path d="M255.429 115.27a33.99 33.99 0 0 0-56.19-25.705c-17.844-9.453-39.088-15.189-61.287-16.464l5.523-33.14 23.156 3.612a25.705 25.705 0 1 0 2.655-16.783l-31.547-4.886a8.497 8.497 0 0 0-9.666 7.01l-7.329 44.081c-23.155.956-45.46 6.692-64.049 16.57a33.99 33.99 0 0 0-45.249 50.666 65.218 65.218 0 0 0-2.443 17.526c0 23.262 12.746 45.037 36.008 61.076s51.728 23.899 82.956 23.899 60.65-8.498 82.957-23.9 36.007-37.813 36.007-61.075a63.837 63.837 0 0 0-2.443-17.42 34.415 34.415 0 0 0 10.94-25.067zM68.485 145.011a16.995 16.995 0 1 1 16.995 16.995 16.995 16.995 0 0 1-16.995-16.995zm98.464 54.277a85.08 85.08 0 0 1-77.964 0 8.497 8.497 0 0 1 7.754-15.082 68.192 68.192 0 0 0 62.456 0 8.497 8.497 0 0 1 7.754 15.082zm3.505-37.282a16.995 16.995 0 1 1 16.995-16.995 16.995 16.995 0 0 1-16.995 16.995z"></path></g></svg></button><span class="spacer_N6vp">|</span><button class="button_jnFd"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="icon_K6Vf iconLink_fFIC"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"></path></svg></button></div></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_q4o9"><div class="avatar margin-bottom--sm"><a href="https://www.linkedin.com/in/hihrig/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="/img/author-photos/hi.jpg" alt="Holger Ihrig"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/hihrig/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Holger Ihrig</span></a></div><small class="avatar__subtitle" itemprop="description" title="Software Engineer for Session Management &amp; Protocol Termination">Software Engineer for Session Management &amp; Protocol Termination</small></div></div></div></div></header><div id="__blog-post-container" class="markdown articleContent_wrOu" itemprop="articleBody"><p>The AWS Snowcone is a small form factor server that was originally meant for data transport to AWS data centers.
However it can also be used as a small device running compute workloads. We wanted to evaluate the performance of the
Snowcone as it is a quite intriguing piece of technology which we might want to use as a an on-premise UPF (User Plane
Function) in low-throughput 5G networks (think IoT or Proof of Concept deployments).</p><p>Specs:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dimensions: 227 mm x 148.6 mm x 82.65 mm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Weight: 2,1 kg</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vCPU(usable): 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Memory(usable): 4GB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Storage(SSD): 14TB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Network: 2x10GB RJ45</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Display: e-Ink for displaying shipping label or status</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Power: 65W USB-C (not included)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="initial-setup">Initial Setup<a href="#initial-setup" class="hash-link" aria-label="Direct link to Initial Setup" title="Direct link to Initial Setup">​</a></h2><p>Once receiving the Snowcone it still displays the shipping label on the top of the unit. The IO Ports are hidden behind
a flap at the back of the unit and the power switch including two LEDs are at the front of the unit.</p><p>Upon powering it on, the Display will show the IP address of the Snowcone along with a message that the device is Locked
and needs to be unlocked using the AWS OpsHub Software which is available for Windows, OSx and Linux (AppImage).</p><img loading="lazy" width="100%" align="middle" style="display:block;margin:auto 10px" src="/0ad3488d3abe1a33f2f0946076588d34.png" class="img_ev3q"><p>In our case we wanted to use a local device, so we selected this option</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/34f26115c5b9238bd3a8f82c55e12e15.png" class="img_ev3q"><p>Next up was selecting a Snowcone Device followed by the following login screen</p><img loading="lazy" width="60%" align="middle" style="display:block;margin:auto 10px" src="/26a61d82feca52e29871f4ec05007217.png" class="img_ev3q"><p>At this point you have to login to your AWS Console and navigate to the “Snow Family” Service where you should see
a so-called JobID for a Snowcone. The Snowcone Job Details will let you get your Unlock Code and the Manifest File,
which are both needed to sign into the Snowcone device.</p><img loading="lazy" width="100%" align="middle" style="display:block;margin:auto 10px" src="/f1587c7f6ca4901b5f1a95b76a98e7ca.png" class="img_ev3q"><p>From that point on the Snowcone is usable. It did take a few more minutes though until it downloaded the AMI images
that will run on the Snowcone.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="compute">Compute<a href="#compute" class="hash-link" aria-label="Direct link to Compute" title="Direct link to Compute">​</a></h2><p>Since the Snowcone is very limited in resources, there are special Instance types for it:</p><ul><li>snc1.micro (1 vCPU, 1 GB RAM)</li><li>snc1.small (1 vCPU, 2 GB RAM)</li><li>snc1.medium (2 vCPU, 4GB RAM)</li></ul><p>Also there are only two AMIs available for it now. However it is possible to import EBS Snapshots onto the Snowcone,
which we have not done as the procedure was too long and we could do with the AMIs provided.</p><img loading="lazy" width="60%" align="middle" style="display:block;margin:auto 10px" src="/fd89d16106a3f2ba8e73127c313c4dd6.png" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="instance">Instance<a href="#instance" class="hash-link" aria-label="Direct link to Instance" title="Direct link to Instance">​</a></h2><p>Since our use case was to run a UPF on it, we started the largest instance type the Snowcone would allow us and
started exploring.</p><p>Since the available AMI is an Amazon Linux 2 AMI we were not super familiar with it. However, since it is Red Hat-based
we kind of knew what to expect.</p><p>The kernel coming with that AMI was a 4.14 kernel, which was too old for us, so the first thing was updating to
a 5.15 kernel. We followed this <a href="https://aws.amazon.com/premiumsupport/knowledge-center/amazon-linux-2-kernel-upgrade/" target="_blank" rel="noopener noreferrer">guide</a>
first kind of sluggish and noticed that it&#x27;s not a good idea to skip instructions, thereby bricking our instance.
Which made us find out that there are no logs of the boot process or a webshell, like we are used to from EC2.</p><p>Second time&#x27;s the charm though and we did have a working instance with a 5.15 kernel. Interestingly enough the
device key for SSH changed when upgrading from 4.14 to 5.4, but that was only a minor nuisance.
So we thought let&#x27;s do some exploring what we actually have here.</p><img loading="lazy" width="60%" align="middle" style="display:block;margin:auto 10px" src="/9821a6bddaf75c2cdd9a4d9f114343d0.png" class="img_ev3q"><p>There was not too much information here. So let&#x27;s have a look at the CPU Information.</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/ef9e87547e91bfd94ab2a93e7eed2414.png" class="img_ev3q"><p>So a CPU from the Xeon E3-12xx v2 line. Even though this might be the virtualization engine telling us that this is
the CPU, we are assuming that it will be something from the Ivy Bridge line. Furthermore we are assuming that it will
be a low-powered 4 Core CPU working there, where only 2 CPUs are available for the consumer.</p><p>After digging a bit through dmidecode (we are engineers right?) we also found this additional piece of information</p><img loading="lazy" width="70%" align="middle" style="display:block;margin:auto 10px" src="/eb881c8f4425f7e31f227546e6763274.png" class="img_ev3q"><p>The interesting part here is that the Manufacturer is designated as Bochs, which is a x86 and AMD64 emulator.
So maybe it&#x27;s not a virtualization engine driving the Instance, but an emulator?</p><p>But now back to our original plan to run a UPF (User Plane Function for 5G) on the Snowcone. For this to work we
needed 2 network interfaces as our original plan was to use DPDK to run it. This is where we quickly found out that
an Instance on Snowcone can only have 1 Virtual Network Interface (VNI).</p><p>After scouring through the documentation about Snowcone, we however found out that first of all there is another way
to configure the Snowcone. You can also configure the Snowcone with a CLI, the <a href="https://aws.amazon.com/snowball/resources/" target="_blank" rel="noopener noreferrer">SnowballEdgeClient</a>.</p><p>In there we found a different type of network Interface, the so called Direct Network Interface (DNI), and according
to documentation, the Snowcone supports up to 63 DNIs attached to it.
So we created a DNI and attached it to our instance.
To our surprise it showed up as an Intel X553 Virtual Network Function(VNF), so this is basically
Single-Root IO-Virtualization (SRIOV) at work here. Which also makes sense because the X500 series supports up
to 64 VNFs (minus the one used by the snowcone itself).</p><p>So we started deploying our DPDK-based UPF on the snowcone. Creating a DNI and attaching it to an instance was fairly
easy with the SnowballEdgeClient. However, when restarting the instance, it would not come back.
After talking to AWS we were informed that this is a bug that is related with the interface naming and
should be fixed in a future release.</p><p>For the meantime it can be circumvented by switching to <a href="https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames/" target="_blank" rel="noopener noreferrer">Predictable Network Interface Names</a>.</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/69fce8ddf8fe909599ae567925f1b4a9.png" class="img_ev3q"><p>Once the DNI is attached to the instance, one has to do some additional configuration on the instance for both
the VNI and DNI to get IP addresses. We found the relevant <a href="https://docs.aws.amazon.com/snowball/latest/developer-guide/network-config-ec2.html" target="_blank" rel="noopener noreferrer">guide</a>
in the AWS Documentation and our DNI got an IP Address.</p><p>With those parts out of the way, we could deploy our DPDK-based UPF on the Snowcone and could use it as a UPF.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance">Performance<a href="#performance" class="hash-link" aria-label="Direct link to Performance" title="Direct link to Performance">​</a></h2><p>Evaluating the performance of the Snowcone device was actually what triggered this whole exploration. So let&#x27;s look mainly at the networking performance and also slightly at the cpu performance.</p><p>For this we are mainly using iperf3 to evaluate the throughput. The Snowcone as well as our test machine here in the lab have a Intel X55x 10Gbit NIC.</p><p>When the Snowcone snc1.medium instance is the iperf Server:</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/494c7b1581c6b71594c5104a274b5911.png" class="img_ev3q"><p>When the Snowcone snc1.medium instance is the iperf Client:</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/93d63f2c994532e36653bf5d8010cb69.png" class="img_ev3q"><p>From these very simple benchmarks we can already see that the EC2 instance is struggling with pushing out anywhere
near line speed. In other words it seems like it is CPU bottlenecked. When running a htop while running this speedtest
does confirm that one of the CPUs hits 100% utilization every now and then. This makes sense because iperf3 is
single-threaded by design.</p><p>We then did run a speedtest to a local speedtest server using our userland UPF from a UE and this is basically
the result.</p><img loading="lazy" width="50%" align="middle" style="display:block;margin:auto 10px" src="/8d2e41892f7155a1057ff23255d18748.png" class="img_ev3q"><p>Looking at htop again, we can see that now both CPU cores are pegged at 100% since the UPF is actually multithreaded.
So even if the EC2 instance in Snowcone can push about 6 Gbit/s on iperf3, with the additional overhead of
GTP encapsulation and de-encapsulation, it can only do about 180 Mbit/s.</p><p>We know that our userland UPF will be able to push around 500 Mbit/s on other machines, so this is a clear limitation
of the Snowcone.</p><p>With the DPDK based UPF however we are able to have higher throughput. DPDK will take control over the DNI and use
a poll-mode driver for packet processing. So one CPU core will always be pinned at 100% and the NIC will
disappear from the instance.</p><img loading="lazy" width="50%" align="middle" style="display:block;margin:auto 10px" src="/5fad862c769c4ccdb51a613a4fca714d.png" class="img_ev3q"><p>This is actually the maximum speed we can get out of our gNodeB. So we are pretty happy with the result.</p><p>We hope you liked this short look at the AWS Snowcone, and we will for sure explore the Snowcone further. It&#x27;s a
nice little device that will be especially useful for smaller deployments or PoCs of our Packet Core as it can be easily
remote-managed and transported everywhere.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="update">Update<a href="#update" class="hash-link" aria-label="Direct link to Update" title="Direct link to Update">​</a></h2><p>Since the original Blog Post about Snowcone we were able to debug the problem with the DNI detach process further
and with help from AWS were able to resolve it. The fix for this should be released with an updated version of
Amazon Linux in the future according to AWS.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/5-g/">5G</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/aws/">aws</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/snowcone/">snowcone</a></li></ul></div><div class="col sharingSection_o4gn col--3"><button aria-haspopup="true" aria-expanded="false" type="button" class="szh-menu-button sharingButton__GCX"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sharingIcon_aNi7"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line></svg></button></div><div class="col margin-top--sm"><a href="https://github.com/working-group-two/wgtwo.com/edit/main/blog/../blog/2022-11-21-snowcone/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/joining-cca/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Working Group Two steps up to support regional carriers in the United States</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/first-voice-calls-on-5g/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">We have just completed our first VoNR (5G) calls in a multi-handset environment</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#initial-setup" class="table-of-contents__link toc-highlight">Initial Setup</a></li><li><a href="#compute" class="table-of-contents__link toc-highlight">Compute</a></li><li><a href="#instance" class="table-of-contents__link toc-highlight">Instance</a></li><li><a href="#performance" class="table-of-contents__link toc-highlight">Performance</a></li><li><a href="#update" class="table-of-contents__link toc-highlight">Update</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Product</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://console.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Console Login<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/implementation/">Implementation</a></li><li class="footer__item"><a href="https://support.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Customer Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/privacy/">Privacy Notice</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/about/introduction/">About</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/case-studies/mvnx/">Case Studies</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/team/">Team</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/terms-of-use/">Terms of Use</a></li><li class="footer__item"><a href="https://jobs.cisco.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.wgtwo.com/jp" target="_blank" rel="noopener noreferrer" class="footer__link-item">wgtwo.com/jp 合同会社<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Security</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/security/">Security Overview</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/technology/security-whitepaper/">Security Whitepaper</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/security/responsible-disclosure/">Responsible Disclosure</a></li><li class="footer__item"><a href="https://trust.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trust Report<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/about/media-and-analysts/">Media &amp; Analysts</a></li><li class="footer__item"><a href="https://www.youtube.com/@workinggrouptwo2286" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/workinggrouptwo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/working-group-two" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://linkedin.com/company/wgtwo" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/contact/">Contact Us</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/logo_white.svg" alt="wgtwo Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="191px" height="32px"><img src="/img/logo_white.svg" alt="wgtwo Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="191px" height="32px"></a></div><div class="footer__copyright">© 2023 Working Group Two AS</div></div></div></footer></div>
<script src="/assets/js/runtime~main.04a2862b.js"></script>
<script src="/assets/js/main.f273e218.js"></script>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N4969FH" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) --></body>
</html>