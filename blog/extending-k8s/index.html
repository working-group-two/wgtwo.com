<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Extending Kubernetes for our needs | Working Group Two</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.wgtwo.com/img/wgtwo-logo.png"><meta data-rh="true" name="twitter:image" content="https://www.wgtwo.com/img/wgtwo-logo.png"><meta data-rh="true" property="og:url" content="https://www.wgtwo.com/blog/extending-k8s/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="og:description" content="We help mobile operators innovate at scale, reduce cost and dive into new revenue streams - by building a mobile core network from the ground up and delivering it as-a-service."><meta data-rh="true" name="og:image" content="/img/wgtwo-logo.png"><meta data-rh="true" name="keywords" content="mvne, private network, epc, 5G core, mvno, IMS core, mobile core, evolved packet core epc, mvno core, core as a service&#x27;"><meta data-rh="true" property="og:title" content="Extending Kubernetes for our needs | Working Group Two"><meta data-rh="true" name="description" content="We are using Kubernetes as our cluster scheduler and this serves us well. However we have a"><meta data-rh="true" property="og:description" content="We are using Kubernetes as our cluster scheduler and this serves us well. However we have a"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-02-21T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://www.linkedin.com/in/hihrig/"><meta data-rh="true" property="article:tag" content="infrastructure,kubernetes,networking,AWS"><link data-rh="true" rel="icon" href="/img/favicons/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.wgtwo.com/blog/extending-k8s/"><link data-rh="true" rel="alternate" href="https://www.wgtwo.com/blog/extending-k8s/" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.wgtwo.com/jp/blog/extending-k8s/" hreflang="jp"><link data-rh="true" rel="alternate" href="https://www.wgtwo.com/blog/extending-k8s/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Working Group Two RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Working Group Two Atom Feed">



<!-- Google Tag Manager -->
    <script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-N4969FH",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>
    <!-- End Google Tag Manager --><link rel="stylesheet" href="/assets/css/styles.f01c840a.css">
<link rel="preload" href="/assets/js/runtime~main.dd87ff37.js" as="script">
<link rel="preload" href="/assets/js/main.4d4561dd.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="wgtwo Logo" class="themedImage_ToTc themedImage--light_HNdA" height="32px" width="191px"><img src="/img/logo_white.svg" alt="wgtwo Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="32px" width="191px"></div></a><a class="navbar__item navbar__link" target="_self" href="/technology/">Technology</a><a class="navbar__item navbar__link" target="_self" href="/product-ecosystem/">Product Ecosystem</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/careers/">Join the Team üéâ</a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link sign-up" href="/contact/">Talk to us</a><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 blogBackground_WB8r"><div class="container margin-vert--lg"><div class="row"><main class="col col--8 col--offset-1 singleBlogPageView_LeVK" itemscope="" itemtype="http://schema.org/Blog"><article class="articleContainer_Rf03" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header class="articleCardHeader_doJu"><h1 class="title_xvU1" itemprop="headline">Extending Kubernetes for our needs</h1><div class="container_iJTo margin-vert--md"><div class="dateContainer_S5xq"><time datetime="2020-02-21T00:00:00.000Z" itemprop="datePublished">February 21, 2020</time> ¬∑ <!-- -->12 min read</div><div class="iconsContainer_WcqX"><button class="button_jnFd"><svg height="500" width="500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500" class="icon_K6Vf"><path d="M50 0C22.3 0 0 22.3 0 50v400c0 27.7 22.3 50 50 50h400c27.7 0 50-22.3 50-50V50c0-27.7-22.3-50-50-50H50zm89.906 105.781c19.182 0 34.719 15.537 34.719 34.719 0 19.182-15.537 34.75-34.719 34.75-19.182 0-34.719-15.568-34.719-34.75 0-19.182 15.537-34.719 34.72-34.719zm181.875 90.438c3.922.014 7.925.199 13.313.531 26.184 1.615 55.36 22.08 56.219 70.031.706 39.493.5 102.081.5 125.125H332.28c0-23.574.25-72.274.25-106.719 0-15.672-7.035-36.75-32.094-36.75-27.597 0-34.312 25.645-34.312 36.75 0 33.074-.281 85.752-.281 106.72h-59.188c0-35.345.375-156.654.375-190.907 30.568 0 45.191-.063 56.375-.063 0 11.218-.094 18.722-.094 26.907 9.337-18.852 34.832-30.655 45.75-31.219 4.98-.257 8.797-.42 12.72-.406zm-211.594 5.531h59.344v190.063h-59.344V201.75z" style="fill-opacity:1;fill-rule:nonzero"></path></svg></button><button class="button_jnFd"><svg xmlns="http://www.w3.org/2000/svg" height="56.693" width="56.693" viewBox="0 0 56.693 56.693" xml:space="preserve" class="icon_K6Vf"><rect width="100%" height="100%" fill="none"></rect><g class="currentLayer"><title>Layer 1</title><path d="M56.237 11.546a22.859 22.859 0 0 1-6.598 1.809 11.509 11.509 0 0 0 5.051-6.357 22.997 22.997 0 0 1-7.295 2.79 11.473 11.473 0 0 0-8.385-3.629c-6.344 0-11.488 5.144-11.488 11.489 0 .899.101 1.775.298 2.618-9.548-.48-18.014-5.053-23.68-12.004a11.43 11.43 0 0 0-1.555 5.777c0 3.985 2.027 7.502 5.11 9.562a11.456 11.456 0 0 1-5.204-1.438v.145c0 5.565 3.96 10.208 9.215 11.265a11.55 11.55 0 0 1-5.189.195c1.463 4.564 5.705 7.887 10.732 7.979A23.047 23.047 0 0 1 2.98 46.665c-.926 0-1.841-.055-2.74-.161a32.51 32.51 0 0 0 17.61 5.161c21.132 0 32.687-17.505 32.687-32.686 0-.498-.01-.995-.032-1.488a23.268 23.268 0 0 0 5.731-5.945z" class="selected"></path></g></svg></button><button class="button_jnFd"><svg xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 256 256" class="icon_K6Vf"><rect width="100%" height="100%" fill="none"></rect><g class="currentLayer"><title>Layer 1</title><path fill="none" d="M0 0h256v256H0z"></path><path d="M255.429 115.27a33.99 33.99 0 0 0-56.19-25.705c-17.844-9.453-39.088-15.189-61.287-16.464l5.523-33.14 23.156 3.612a25.705 25.705 0 1 0 2.655-16.783l-31.547-4.886a8.497 8.497 0 0 0-9.666 7.01l-7.329 44.081c-23.155.956-45.46 6.692-64.049 16.57a33.99 33.99 0 0 0-45.249 50.666 65.218 65.218 0 0 0-2.443 17.526c0 23.262 12.746 45.037 36.008 61.076s51.728 23.899 82.956 23.899 60.65-8.498 82.957-23.9 36.007-37.813 36.007-61.075a63.837 63.837 0 0 0-2.443-17.42 34.415 34.415 0 0 0 10.94-25.067zM68.485 145.011a16.995 16.995 0 1 1 16.995 16.995 16.995 16.995 0 0 1-16.995-16.995zm98.464 54.277a85.08 85.08 0 0 1-77.964 0 8.497 8.497 0 0 1 7.754-15.082 68.192 68.192 0 0 0 62.456 0 8.497 8.497 0 0 1 7.754 15.082zm3.505-37.282a16.995 16.995 0 1 1 16.995-16.995 16.995 16.995 0 0 1-16.995 16.995z"></path></g></svg></button><span class="spacer_N6vp">|</span><button class="button_jnFd"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="icon_K6Vf iconLink_fFIC"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"></path></svg></button></div></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_q4o9"><div class="avatar margin-bottom--sm"><a href="https://www.linkedin.com/in/hihrig/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="/img/author-photos/hi.jpg" alt="Holger Ihrig"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/hihrig/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Holger Ihrig</span></a></div><small class="avatar__subtitle" itemprop="description" title="Software Engineer for Session Management &amp; Protocol Termination">Software Engineer for Session Management &amp; Protocol Termination</small></div></div></div></div></header><div id="post-content" class="markdown articleContent_wrOu" itemprop="articleBody"><p>We are using Kubernetes as our cluster scheduler and this serves us well. However we have a
few cases where we need to do some additional work.</p><p>One case for example is that we have to use static IPs for some of our services to connect to
Telecom companies as they expect a single IP address to bind to. This address needs to be fixed and
DNS records are not accepted either. We are running in AWS as well, so the reader might ask why are we not
using Elastic IPs and adding them to the services? Good idea, but Telecom operators will not whitelist
an Elastic IP for you as there are no guarantees that it will belong to your company infrastructure forever. There
are also additional challenges when it comes to using Elastic IP in private subnet over VPN or direct connect.</p><p>We are a member of RIPE and do have a small subnet block for our own use, so we thought we could make use of
that. As we own the block and AWS supports BYOIP (Bring your own IP-range), we created a special subnet with
some Kubernetes nodes in it. This was not enough to make this work since we depended on a service always having
the same IP attached to it, as well as the node running a pod having some very specific Routes set.</p><p>With this scenario in mind we set out to find solutions and all solutions we could think of required haggling
with Kubernetes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="extending-kubernetes">Extending Kubernetes<a class="hash-link" href="#extending-kubernetes" title="Direct link to heading">‚Äã</a></h2><p>There are several ways to extend Kubernetes. All functionality in Kubernetes is build upon very nice and clean
public APIs, or to say it with other words: There is no private API magic hidden somewhere. So lets look at
two ways on how to extend Kubernetes.</p><p>Possible ways to go forward:</p><ul><li>Adding a scheduler extender</li><li>Creating an operator/controller</li></ul><p>There are more ways to extend Kubernetes, but these two ways will be the one we shall look at. Just for completeness
you can as well also add another scheduler or change Kubernetes itself. However these possibilities have some serious
downsides.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-a-scheduler-extender">Adding a scheduler extender<a class="hash-link" href="#adding-a-scheduler-extender" title="Direct link to heading">‚Äã</a></h3><p>The Kubernetes scheduler checks for certain requirements before it schedules a pod onto a node. Some of these requirements
are hard requirements, like cpu, memory and number of pods. Other requirements are more soft, like if the pods are allowed to
be packed together or in which AZ they are going to run. All of those requirements are collected and points given to each
node on how well they meet the requirements. The node that fits best, gets chosen.</p><p>All of these are things the scheduler will do for you automatically, however it is also possible to give the cluster a
<code>KubeSchedulerConfiguration</code> object that will tell the scheduler to also reach out to a service for additional point scoring.
The SchedulerConfiguration is a JSON file and for further explanations, please have a look at this
excellent <a href="https://developer.ibm.com/articles/creating-a-custom-kube-scheduler/" target="_blank" rel="noopener noreferrer">blog post</a>.</p><p>In our case, we could have written a service that checks which IP Addresses are assigned to the Nodes and moved the Pods
onto those nodes. This would have required us to make sure that those nodes had all needed IP-Addresses all the time.
That sounded not very enticing when doing cluster upgrades as it would have needed to be at least a semi-manual process.
So we decided against this approach.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-operator">Creating an operator<a class="hash-link" href="#creating-an-operator" title="Direct link to heading">‚Äã</a></h3><p>An Operator/Controller on the other hand is a component observing resources and then try to create the declared resources.
The difference between a controller and an operator is basically that an operator is handling the lifecycle of an
application, whereas a controller may control specific resources that are not associated with a specific application.
They both use the controller pattern though and both can be implemented with the same toolset, so for simplicity sake in the
context of this article, we will consider them to be equal.</p><p>Operators usually consists at least out of a <strong><a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank" rel="noopener noreferrer">CRD(CustomResourceDefinition)</a></strong>, an <strong>event listener</strong> and a <strong>reconciliation loop</strong>.
The <em>CRD</em> basically creates a new type of resource and effectively implements a domain specific language for the operator. The whole description on what this deployment
needs to look like and all its abilities need to be defined in the <em>CRD</em>. The operator will create an <em>event listener</em> for that
<em>CRD</em> as the primary resource and additional <em>event listeners</em> for the secondary resource (most likely pods in this example).
The <em>event listener</em> will let the <em>reconciliation loop</em> know once a <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete" target="_blank" rel="noopener noreferrer">CRUD</a> operation has been requested on either the primary or
secondary resource. The <em>loop</em> will then try to bring the <em>CRD</em> into the desired state, depending on what operation has been
requested. So in the Redis example it will either create the pods, update the pods, in the case of an upgrade it might blue/green
deploy the pods or delete the pods. Basically things a human operator would do in this case, just in programmatic form, taking it
from a declarative form into existing resources.</p><p>As our initial problem was making services available on static IP addresses, we chose to explore this approach further,
basically attaching additional IP addresses to the nodes running specific pods.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-an-operatorcontroller">Building an Operator/Controller<a class="hash-link" href="#building-an-operatorcontroller" title="Direct link to heading">‚Äã</a></h2><p>For building an operator, there are several frameworks out there, but we will only look at the <a href="https://github.com/operator-framework/operator-sdk" target="_blank" rel="noopener noreferrer">operator-framework</a> in
this article.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="operator-sdk">Operator-SDK<a class="hash-link" href="#operator-sdk" title="Direct link to heading">‚Äã</a></h3><p>The Operator framework is a project that is designed to help you get started on creating an operator. To achieve that,
it will generate quite a bit of boilerplate.</p><p>The Operator-SDK supports three different models of creating an operator:</p><ul><li>Helm</li><li>Ansible</li><li>Golang</li></ul><p>Depending on your choice of tool, you will be able to integrate deeper into Kubernetes or not.</p><p><img loading="lazy" alt="operator-sdk-capabilites" src="/assets/images/operator-capability-level-f511b5d60b3e9160a4582577204888cd.png" title="Operator sdk capabilities (Taken from the operator-sdk repo)" width="2440" height="1200" class="img_ev3q">
<em><a href="https://github.com/operator-framework/operator-sdk/blob/master/README.md" target="_blank" rel="noopener noreferrer">Operator sdk capabilities</a></em></p><p>As we didn&#x27;t want to be limited by our choice later on and wanted to expose metrics from our operator, we chose to
implement our operator in golang. We will be using the operator-sdk version 0.12 for this.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-we-want-to-do">What we want to do<a class="hash-link" href="#what-we-want-to-do" title="Direct link to heading">‚Äã</a></h3><p>Looking at the problem again, we need some way to make sure that a node that runs a specific pod, needs to
have an IP address attached to it. This IP address will be given to connecting parties as a entry point to our
system and thus cannot change.</p><p>Features it needs to support</p><ul><li>Reserve IP address from range</li><li>Attach IP address to node running pod</li><li>Detach IP address from node that is not running pod</li><li>Move IP addresses around in case of node failure</li></ul><p>This feature list already shows some things we will not and most likely cannot support. For example autoscaling of
replica sets will not work as an IP address is bound to a node with an assigned pod. There is
a 1-1 association here. However it is still possible to use the self-healing properties of Deployments
in this case.</p><p>When thinking about modelling this behaviour, we basically decided on the following approach:</p><ul><li>Create a IP kind (for reserving the IP Address in the Range)</li><li>Use annotations to attach the IP Address to a pod</li></ul><p>We also thought about creating a StaticIPDeployment kind, but at the end decided against it, as
we feared that the lifecycle management would be way more complicated if we needed to manage a deployment
instead of just controlling the assignment of an IP Address.</p><p>After all this is the first Operator we are going to write and didn&#x27;t want to drown in complexity from day one.
We would rather iterate and scrap everything after we tried it, then going too complex from the start.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation">Implementation<a class="hash-link" href="#implementation" title="Direct link to heading">‚Äã</a></h3><p>The first thing you do when starting off a new operator, is that you initialize the directory of your
operator with the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk new app-operator --repo &lt;YOURREPO&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will create some boilerplate folders and files for you and will look roughly like this:</p><p><img loading="lazy" alt="operator-fs-structure" src="/assets/images/operator-structure-1a847ce462732788fdab91235ce1a528.png" title="Operator Folder Structure" width="351" height="169" class="img_ev3q"></p><p>The next thing you might want to do is then add the boilerplate for a CRD and a Controller:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk add api --api-version=ip.wgtwo.com/v1alpha1 --kind=IP</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk add controller --api-version=ip.wgtwo.com/v1alpha1 --kind=IP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After creating the boilerplate, your folder structure will look a lot like this:</p><p><img loading="lazy" alt="operator-fs-structure-expanded" src="/assets/images/operator-structure-expanded-5901aa50d6e40055e6140151f960b40f.png" title="Operator Folder Structure Expanded" width="335" height="536" class="img_ev3q"></p><p>The most important files right now are in:</p><ul><li>cmd/manager/main.go (the main program that will run in the cluster)</li><li>pkg/apis/ip/v1alpha1/ip_types.go (definition of the CRD)</li><li>pkg/controller/ip_controller.go (event listener and reconciliation loop)</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-crd">Creating the CRD<a class="hash-link" href="#creating-the-crd" title="Direct link to heading">‚Äã</a></h4><p>To start off, we define how our CRD should look like to be able to manage our IP Address. We do this,
by creating structs in go that have all the fields our CRD shall have. This includes metadata, &quot;spec&quot; and
&quot;status&quot; fields.</p><p>There is also a bit of operator-sdk specific code we need to add. This is so that the sdk can generate the
openapi spec and other auto-generated code.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +k8s:openapi-gen=true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +kubebuilder:subresource:status</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +kubebuilder:resource:path=ips,scope=Cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type IP struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    metav1.TypeMeta   `json:&quot;,inline&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    metav1.ObjectMeta `json:&quot;metadata,omitempty&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Spec   IPSpec   `json:&quot;spec,omitempty&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Status IPStatus `json:&quot;status,omitempty&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The &quot;spec&quot; needs to contain all information the controller needs to create the resource.
The &quot;status&quot; part needs to contain all the bookkeeping information the controller needs to work. In a way the
&quot;status&quot; fields are used as a database for operating Kubernetes (yes, this is oversimplified).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +k8s:openapi-gen=true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type IPSpec struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Address string `json:&quot;address&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Reassign bool `json:&quot;reassign,omitempty&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// IPStatus defines the observed state of IP</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +k8s:openapi-gen=true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type IPStatus struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Assigned bool   `json:&quot;assigned&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Claimed  bool   `json:&quot;claimed&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Node     string `json:&quot;node,omitempty&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Pod      string `json:&quot;pod,omitempty&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Original IPSpec `json:&quot;original,omitempty&quot;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see our new IP Resource type, as defined by the CRD that we are gonna create from these structs, is
going to have two fields: &quot;Address&quot; and &quot;Reassign&quot;.
The corresponding &quot;status&quot; part of the resource, has a lot more fields, which we are using for bookkeeping.</p><p>After we have created those structs and know how the CRD needs to look like, we actually auto-generate the CRD yaml:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk generate k8s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk generate openapi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>NB: This changed since operator-sdk 0.15</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-controller">Creating the controller<a class="hash-link" href="#creating-the-controller" title="Direct link to heading">‚Äã</a></h4><p>There are two main parts to the controller. One part that creates a watcher on resources and one part
that reconciles your resource (in our case the IP and Pods).</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="watching-for-resource-changes">Watching for resource changes<a class="hash-link" href="#watching-for-resource-changes" title="Direct link to heading">‚Äã</a></h5><p>The watch code is in our case in the <code>add</code> function of ip_controller.go:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Watch for changes to primary resource IP, as this always requires an action</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    err = c.Watch(&amp;source.Kind{Type: &amp;ipv1alpha1.IP{}}, &amp;handler.EnqueueRequestForObject{})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return err</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Create Filter list triggering on ip.wgtwo.com/ip as annotation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pred := predicate.Funcs{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // Ignore the pod if it does not contain annotation ip.wgtwo.com/ip</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        CreateFunc: func(e event.CreateEvent) bool {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return hasAnnotation(e.Meta)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        UpdateFunc: func(e event.UpdateEvent) bool {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if hasAnnotation(e.MetaOld) || hasAnnotation(e.MetaNew){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            } else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        DeleteFunc: func(e event.DeleteEvent) bool {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // Evaluates to false if the object has been confirmed deleted.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return !e.DeleteStateUnknown</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Watch for all pods having the right annotation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    err = c.Watch(&amp;source.Kind{Type: &amp;corev1.Pod{}}, &amp;handler.EnqueueRequestForObject{}, pred)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we are creating watchers for all changes to the <code>IP</code> resource and watchers for all create/update/delete operations on
pods, if they have a specific annotation set.</p><p>If any of these conditions are met, the reconciliation loop will be triggered.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="reconciliation">Reconciliation<a class="hash-link" href="#reconciliation" title="Direct link to heading">‚Äã</a></h5><p>This is where the business logic of your operator/controller is sitting. The <code>Reconcile</code> function in <code>ip_controller.go</code> will
be triggered whenever one of the watch conditions fits.
We do not know which type of resource triggered the loop, so that is the first thing we need to figure out:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">oip := &amp;ipv1alpha1.IP{}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">err := r.client.Get(context.TODO(), request.NamespacedName, oip)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if err == nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ... yes it is a resource of kind IP ... go and do business</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">op := &amp;corev1.Pod{}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">err = r.client.Get(context.TODO(), request.NamespacedName, op)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if err == nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ... yes it is a resource of kind Pod ... go and do business</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In these two code blocks, we are handling all the interactions for the primary resource of kind IP and the secondary
resource of type pod. Depending on what has happened last we have different scenarios.</p><p>Cases for the IP resource to consider:</p><ul><li>IP is new</li><li>IP has been modified</li><li>IP has been deleted</li></ul><p>Cases for the Pod resource to consider:</p><ul><li>Annotation sticking the IP to the pod has been deleted</li><li>IP needs to be assigned to a pod</li><li>Pod has moved to another node</li><li>Pod has been deleted</li></ul><p>We will not go any further into the detail on what these parts are actually doing, as this is enough
to actually give you an idea on how this can be accomplished.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">‚Äã</a></h2><p>We have been looking at how to expand Kubernetes to suit our needs better. Creating the Operator/Controller
has taught us quite a bit about how Kubernetes works and has already saved us work in the past
few months, especially on node failures.</p><p>The operator-sdk has been a great tool for us to solve this problem and we see that there is a lot of work
going into it, making it simpler to create operators. It might look intimidating at first, but is worth the effort and
we think in the future Kubernetes operators will be the way how stateful components will be managed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources--further-reading">Resources / Further Reading<a class="hash-link" href="#resources--further-reading" title="Direct link to heading">‚Äã</a></h2><ul><li>Programming Kubernetes by Stefan Schimanski and Michael Hausenblas</li><li><a href="https://developer.ibm.com/articles/creating-a-custom-kube-scheduler/" target="_blank" rel="noopener noreferrer">Creating a custom kube-scheduler</a></li><li><a href="https://github.com/operator-framework/operator-sdk" target="_blank" rel="noopener noreferrer">Operator SDK</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/infrastructure/">infrastructure</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/kubernetes/">kubernetes</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/networking/">networking</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/aws/">AWS</a></li></ul></div><div class="col sharingSection_o4gn col--3"><button aria-haspopup="true" aria-expanded="false" type="button" class="szh-menu-button sharingButton__GCX"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sharingIcon_aNi7"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line></svg></button><div class="szh-menu-container szh-menu-container--itemTransition menuContainer_Dr6x" style="position:relative"></div></div><div class="col margin-top--sm"><a href="https://github.com/working-group-two/wgtwo.com/edit/main/blog/../blog/2020-02-21-Extending-Kubernetes-Static-IP-Routing.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/vowifi-imsi-leak/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">VoWifi leaking IMSI</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/metrics-unlimited-thanos/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Towards observability nirvana: infinite metric retention with Thanos</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#extending-kubernetes" class="table-of-contents__link toc-highlight">Extending Kubernetes</a><ul><li><a href="#adding-a-scheduler-extender" class="table-of-contents__link toc-highlight">Adding a scheduler extender</a></li><li><a href="#creating-an-operator" class="table-of-contents__link toc-highlight">Creating an operator</a></li></ul></li><li><a href="#building-an-operatorcontroller" class="table-of-contents__link toc-highlight">Building an Operator/Controller</a><ul><li><a href="#operator-sdk" class="table-of-contents__link toc-highlight">Operator-SDK</a></li><li><a href="#what-we-want-to-do" class="table-of-contents__link toc-highlight">What we want to do</a></li><li><a href="#implementation" class="table-of-contents__link toc-highlight">Implementation</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li><li><a href="#resources--further-reading" class="table-of-contents__link toc-highlight">Resources / Further Reading</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Product</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://console.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Console Login<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://support.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Customer Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/privacy/">Privacy Notice</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/about/introduction/">About</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/case-studies/mvnx/">Case Studies</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/team/">Team</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/careers/">Careers</a></li><li class="footer__item"><a href="https://www.wgtwo.com/jp" target="_blank" rel="noopener noreferrer" class="footer__link-item">wgtwo.com/jp ÂêàÂêå‰ºöÁ§æ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Security</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/security/">Security Overview</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/technology/security-whitepaper/">Security Whitepaper</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/security/responsible-disclosure/">Responsible Disclosure</a></li><li class="footer__item"><a href="https://trust.wgtwo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trust Report<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/about/media-and-analysts/">Media &amp; Analysts</a></li><li class="footer__item"><a href="https://twitter.com/workinggrouptwo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/working-group-two" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://linkedin.com/company/wgtwo" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/contact/">Contact Us</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/logo_white.svg" alt="wgtwo Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="191px" height="32px"><img src="/img/logo_white.svg" alt="wgtwo Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="191px" height="32px"></a></div><div class="footer__copyright">¬© 2023 Working Group Two AS</div></div></div></footer></div>
<script src="/assets/js/runtime~main.dd87ff37.js"></script>
<script src="/assets/js/main.4d4561dd.js"></script>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N4969FH" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) --></body>
</html>